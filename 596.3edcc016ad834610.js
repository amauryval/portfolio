"use strict";(self.webpackChunkportfolio=self.webpackChunkportfolio||[]).push([[596],{9596:(ci,Te,C)=>{C.r(Te),C.d(Te,{MapSandboxModule:()=>li});var W=C(9808),be=C(9444),p=C(5e3);class V{constructor(n,e,t,i){this.r=n,this.g=e,this.b=t,this.a=i}}class ue{constructor(n,e,t,i){this.h=n,this.s=e,this.v=t,this.a=i}}class Z{constructor(n,e,t,i){this.h=n,this.s=e,this.l=t,this.a=i}}class ee{constructor(n,e,t,i,r=1){this.c=n,this.m=e,this.y=t,this.k=i,this.a=r}}let ct=(()=>{class s{constructor(){this.active=null}setActive(e){this.active&&this.active!==e&&"inline"!==this.active.cpDialogDisplay&&this.active.closeDialog(),this.active=e}hsva2hsla(e){const t=e.h,i=e.s,r=e.v,o=e.a;if(0===r)return new Z(t,0,0,o);if(0===i&&1===r)return new Z(t,1,1,o);{const a=r*(2-i)/2;return new Z(t,r*i/(1-Math.abs(2*a-1)),a,o)}}hsla2hsva(e){const t=Math.min(e.h,1),i=Math.min(e.s,1),r=Math.min(e.l,1),o=Math.min(e.a,1);if(0===r)return new ue(t,0,0,o);{const a=r+i*(1-Math.abs(2*r-1))/2;return new ue(t,2*(a-r)/a,a,o)}}hsvaToRgba(e){let t,i,r;const o=e.h,a=e.s,l=e.v,c=e.a,h=Math.floor(6*o),u=6*o-h,d=l*(1-a),f=l*(1-u*a),v=l*(1-(1-u)*a);switch(h%6){case 0:t=l,i=v,r=d;break;case 1:t=f,i=l,r=d;break;case 2:t=d,i=l,r=v;break;case 3:t=d,i=f,r=l;break;case 4:t=v,i=d,r=l;break;case 5:t=l,i=d,r=f;break;default:t=0,i=0,r=0}return new V(t,i,r,c)}cmykToRgb(e){return new V((1-e.c)*(1-e.k),(1-e.m)*(1-e.k),(1-e.y)*(1-e.k),e.a)}rgbaToCmyk(e){const t=1-Math.max(e.r,e.g,e.b);return 1===t?new ee(0,0,0,1,e.a):new ee((1-e.r-t)/(1-t),(1-e.g-t)/(1-t),(1-e.b-t)/(1-t),t,e.a)}rgbaToHsva(e){let t,i;const r=Math.min(e.r,1),o=Math.min(e.g,1),a=Math.min(e.b,1),l=Math.min(e.a,1),c=Math.max(r,o,a),h=Math.min(r,o,a),u=c,d=c-h;if(i=0===c?0:d/c,c===h)t=0;else{switch(c){case r:t=(o-a)/d+(o<a?6:0);break;case o:t=(a-r)/d+2;break;case a:t=(r-o)/d+4;break;default:t=0}t/=6}return new ue(t,i,u,l)}rgbaToHex(e,t){let i="#"+(16777216|e.r<<16|e.g<<8|e.b).toString(16).substr(1);return t&&(i+=(256|Math.round(255*e.a)).toString(16).substr(1)),i}normalizeCMYK(e){return new ee(e.c/100,e.m/100,e.y/100,e.k/100,e.a)}denormalizeCMYK(e){return new ee(Math.floor(100*e.c),Math.floor(100*e.m),Math.floor(100*e.y),Math.floor(100*e.k),e.a)}denormalizeRGBA(e){return new V(Math.round(255*e.r),Math.round(255*e.g),Math.round(255*e.b),e.a)}stringToHsva(e="",t=!1){let i=null;e=(e||"").toLowerCase();const r=[{re:/(rgb)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(o){return new V(parseInt(o[2],10)/255,parseInt(o[3],10)/255,parseInt(o[4],10)/255,isNaN(parseFloat(o[5]))?1:parseFloat(o[5]))}},{re:/(hsl)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(o){return new Z(parseInt(o[2],10)/360,parseInt(o[3],10)/100,parseInt(o[4],10)/100,isNaN(parseFloat(o[5]))?1:parseFloat(o[5]))}}];r.push(t?{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})?$/,parse:function(o){return new V(parseInt(o[1],16)/255,parseInt(o[2],16)/255,parseInt(o[3],16)/255,parseInt(o[4]||"FF",16)/255)}}:{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,parse:function(o){return new V(parseInt(o[1],16)/255,parseInt(o[2],16)/255,parseInt(o[3],16)/255,1)}}),r.push({re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,parse:function(o){return new V(parseInt(o[1]+o[1],16)/255,parseInt(o[2]+o[2],16)/255,parseInt(o[3]+o[3],16)/255,1)}});for(const o in r)if(r.hasOwnProperty(o)){const a=r[o],l=a.re.exec(e),c=l&&a.parse(l);if(c)return c instanceof V?i=this.rgbaToHsva(c):c instanceof Z&&(i=this.hsla2hsva(c)),i}return i}outputFormat(e,t,i){switch("auto"===t&&(t=e.a<1?"rgba":"hex"),t){case"hsla":const r=this.hsva2hsla(e),o=new Z(Math.round(360*r.h),Math.round(100*r.s),Math.round(100*r.l),Math.round(100*r.a)/100);return e.a<1||"always"===i?"hsla("+o.h+","+o.s+"%,"+o.l+"%,"+o.a+")":"hsl("+o.h+","+o.s+"%,"+o.l+"%)";case"rgba":const a=this.denormalizeRGBA(this.hsvaToRgba(e));return e.a<1||"always"===i?"rgba("+a.r+","+a.g+","+a.b+","+Math.round(100*a.a)/100+")":"rgb("+a.r+","+a.g+","+a.b+")";default:const l="always"===i||"forced"===i;return this.rgbaToHex(this.denormalizeRGBA(this.hsvaToRgba(e)),l)}}}return s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=p.Yz7({token:s,factory:s.\u0275fac}),s})();"undefined"!=typeof window&&window;let ht=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=p.oAB({type:s}),s.\u0275inj=p.cJS({providers:[ct],imports:[[W.ez]]}),s})();var s,de=C(9560),Se=C(2815),te=C(9889),Ie=C(8214),ie=C(9972),G=C(3171),m=C(4410),b=C(4624),Y=C(187),fe=C(5002),Fe=C(2909),re=C(4412),ve=C(7053),ge=C(8894),D=C(8313),w=C(760),A=C(3481),Ce=C(109),M=C(2456),K=C(4173),y=C(1274),I=C(119),Ve=(s=function(n,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])})(n,e)},function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}s(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}),Re=[0,0,0,0],H=[],_e=function(s){function n(e,t,i){var r=s.call(this,e)||this;return r.features=t,r.mapBrowserEvent=i,r}return Ve(n,s),n}(Ie.ZP),pt=function(s){function n(e){var i,t=s.call(this,e)||this;if(t.boundHandleFeatureChange_=t.handleFeatureChange_.bind(t),t.condition_=e.condition?e.condition:D.Xp,t.defaultDeleteCondition_=function(r){return(0,D.Ko)(r)&&(0,D.Kf)(r)},t.deleteCondition_=e.deleteCondition?e.deleteCondition:t.defaultDeleteCondition_,t.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:D.Bx,t.vertexFeature_=null,t.vertexSegments_=null,t.lastPixel_=[0,0],t.ignoreNextSingleClick_=!1,t.featuresBeingModified_=null,t.rBush_=new Fe.Z,t.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,t.snappedToVertex_=!1,t.changingFeature_=!1,t.dragSegments_=[],t.overlay_=new ve.Z({source:new ge.Z({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:dt(),updateWhileAnimating:!0,updateWhileInteracting:!0}),t.SEGMENT_WRITERS_={Point:t.writePointGeometry_.bind(t),LineString:t.writeLineStringGeometry_.bind(t),LinearRing:t.writeLineStringGeometry_.bind(t),Polygon:t.writePolygonGeometry_.bind(t),MultiPoint:t.writeMultiPointGeometry_.bind(t),MultiLineString:t.writeMultiLineStringGeometry_.bind(t),MultiPolygon:t.writeMultiPolygonGeometry_.bind(t),Circle:t.writeCircleGeometry_.bind(t),GeometryCollection:t.writeGeometryCollectionGeometry_.bind(t)},t.source_=null,t.hitDetection_=null,e.features?i=e.features:e.source&&(t.source_=e.source,i=new Se.Z(t.source_.getFeatures()),t.source_.addEventListener(re.Z.ADDFEATURE,t.handleSourceAdd_.bind(t)),t.source_.addEventListener(re.Z.REMOVEFEATURE,t.handleSourceRemove_.bind(t))),!i)throw new Error("The modify interaction requires features, a source or a layer");return e.hitDetection&&(t.hitDetection_=e.hitDetection),t.features_=i,t.features_.forEach(t.addFeature_.bind(t)),t.features_.addEventListener(te.Z.ADD,t.handleFeatureAdd_.bind(t)),t.features_.addEventListener(te.Z.REMOVE,t.handleFeatureRemove_.bind(t)),t.lastPointerEvent_=null,t.delta_=[0,0],t.snapToPointer_=void 0===e.snapToPointer?!t.hitDetection_:e.snapToPointer,t}return Ve(n,s),n.prototype.addFeature_=function(e){var t=e.getGeometry();if(t){var i=this.SEGMENT_WRITERS_[t.getType()];i&&i(e,t)}var r=this.getMap();r&&r.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,r),e.addEventListener(ie.Z.CHANGE,this.boundHandleFeatureChange_)},n.prototype.willModifyFeatures_=function(e,t){if(!this.featuresBeingModified_){this.featuresBeingModified_=new Se.Z;for(var i=this.featuresBeingModified_.getArray(),r=0,o=t.length;r<o;++r)for(var a=t[r],l=0,c=a.length;l<c;++l){var h=a[l].feature;h&&-1===i.indexOf(h)&&this.featuresBeingModified_.push(h)}0===this.featuresBeingModified_.getLength()?this.featuresBeingModified_=null:this.dispatchEvent(new _e("modifystart",this.featuresBeingModified_,e))}},n.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(ie.Z.CHANGE,this.boundHandleFeatureChange_)},n.prototype.removeFeatureSegmentData_=function(e){var t=this.rBush_,i=[];t.forEach(function(l){e===l.feature&&i.push(l)});for(var r=i.length-1;r>=0;--r){for(var o=i[r],a=this.dragSegments_.length-1;a>=0;--a)this.dragSegments_[a][0]===o&&this.dragSegments_.splice(a,1);t.remove(o)}},n.prototype.setActive=function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),s.prototype.setActive.call(this,e)},n.prototype.setMap=function(e){this.overlay_.setMap(e),s.prototype.setMap.call(this,e)},n.prototype.getOverlay=function(){return this.overlay_},n.prototype.handleSourceAdd_=function(e){e.feature&&this.features_.push(e.feature)},n.prototype.handleSourceRemove_=function(e){e.feature&&this.features_.remove(e.feature)},n.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)},n.prototype.handleFeatureChange_=function(e){if(!this.changingFeature_){var t=e.target;this.removeFeature_(t),this.addFeature_(t)}},n.prototype.handleFeatureRemove_=function(e){this.removeFeature_(e.element)},n.prototype.writePointGeometry_=function(e,t){var i=t.getCoordinates(),r={feature:e,geometry:t,segment:[i,i]};this.rBush_.insert(t.getExtent(),r)},n.prototype.writeMultiPointGeometry_=function(e,t){for(var i=t.getCoordinates(),r=0,o=i.length;r<o;++r){var a=i[r],l={feature:e,geometry:t,depth:[r],index:r,segment:[a,a]};this.rBush_.insert(t.getExtent(),l)}},n.prototype.writeLineStringGeometry_=function(e,t){for(var i=t.getCoordinates(),r=0,o=i.length-1;r<o;++r){var a=i.slice(r,r+2),l={feature:e,geometry:t,index:r,segment:a};this.rBush_.insert((0,w.hI)(a),l)}},n.prototype.writeMultiLineStringGeometry_=function(e,t){for(var i=t.getCoordinates(),r=0,o=i.length;r<o;++r)for(var a=i[r],l=0,c=a.length-1;l<c;++l){var h=a.slice(l,l+2),u={feature:e,geometry:t,depth:[r],index:l,segment:h};this.rBush_.insert((0,w.hI)(h),u)}},n.prototype.writePolygonGeometry_=function(e,t){for(var i=t.getCoordinates(),r=0,o=i.length;r<o;++r)for(var a=i[r],l=0,c=a.length-1;l<c;++l){var h=a.slice(l,l+2),u={feature:e,geometry:t,depth:[r],index:l,segment:h};this.rBush_.insert((0,w.hI)(h),u)}},n.prototype.writeMultiPolygonGeometry_=function(e,t){for(var i=t.getCoordinates(),r=0,o=i.length;r<o;++r)for(var a=i[r],l=0,c=a.length;l<c;++l)for(var h=a[l],u=0,d=h.length-1;u<d;++u){var f=h.slice(u,u+2),v={feature:e,geometry:t,depth:[l,r],index:u,segment:f};this.rBush_.insert((0,w.hI)(f),v)}},n.prototype.writeCircleGeometry_=function(e,t){var i=t.getCenter(),r={feature:e,geometry:t,index:0,segment:[i,i]},o={feature:e,geometry:t,index:1,segment:[i,i]},a=[r,o];r.featureSegments=a,o.featureSegments=a,this.rBush_.insert((0,w.HK)(i),r);var l=t,c=(0,y.Cs)();if(c&&this.getMap()){var h=this.getMap().getView().getProjection();l=l.clone().transform(c,h),l=(0,K.Bb)(l).transform(h,c)}this.rBush_.insert(l.getExtent(),o)},n.prototype.writeGeometryCollectionGeometry_=function(e,t){for(var i=t.getGeometriesArray(),r=0;r<i.length;++r){var o=i[r];(0,this.SEGMENT_WRITERS_[o.getType()])(e,o)}},n.prototype.createOrUpdateVertexFeature_=function(e,t,i){var r=this.vertexFeature_;return r?r.getGeometry().setCoordinates(e):(r=new G.Z(new Y.Z(e)),this.vertexFeature_=r,this.overlay_.getSource().addFeature(r)),r.set("features",t),r.set("geometries",i),r},n.prototype.handleEvent=function(e){return!e.originalEvent||(this.lastPointerEvent_=e,!e.map.getView().getInteracting()&&e.type==b.Z.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(t=!(e.type!=b.Z.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==b.Z.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),s.prototype.handleEvent.call(this,e)&&!t);var t},n.prototype.handleDragEvent=function(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_);for(var t=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],i=[],r=[],o=0,a=this.dragSegments_.length;o<a;++o){var l=this.dragSegments_[o],c=l[0],h=c.feature;-1===i.indexOf(h)&&i.push(h);var u=c.geometry;-1===r.indexOf(u)&&r.push(u);for(var d=c.depth,f=void 0,v=c.segment,g=l[1];t.length<u.getStride();)t.push(v[g][t.length]);switch(u.getType()){case m.Z.POINT:f=t,v[0]=t,v[1]=t;break;case m.Z.MULTI_POINT:(f=u.getCoordinates())[c.index]=t,v[0]=t,v[1]=t;break;case m.Z.LINE_STRING:(f=u.getCoordinates())[c.index+g]=t,v[g]=t;break;case m.Z.MULTI_LINE_STRING:case m.Z.POLYGON:(f=u.getCoordinates())[d[0]][c.index+g]=t,v[g]=t;break;case m.Z.MULTI_POLYGON:(f=u.getCoordinates())[d[1]][d[0]][c.index+g]=t,v[g]=t;break;case m.Z.CIRCLE:if(v[0]=t,v[1]=t,0===c.index)this.changingFeature_=!0,u.setCenter(t),this.changingFeature_=!1;else{this.changingFeature_=!0;var _=e.map.getView().getProjection(),k=(0,A.TE)((0,y.Vs)(u.getCenter(),_),(0,y.Vs)(t,_)),P=(0,y.Cs)();if(P){var T=u.clone().transform(P,_);T.setRadius(k),k=T.transform(_,P).getRadius()}u.setRadius(k),this.changingFeature_=!1}}f&&this.setGeometryCoordinates_(u,f)}this.createOrUpdateVertexFeature_(t,i,r)},n.prototype.handleDownEvent=function(e){if(!this.condition_(e))return!1;var t=e.coordinate;this.handlePointerAtPixel_(e.pixel,e.map,t),this.dragSegments_.length=0,this.featuresBeingModified_=null;var i=this.vertexFeature_;if(i){var r=e.map.getView().getProjection(),o=[],a=i.getGeometry().getCoordinates(),l=(0,w.hI)([a]),c=this.rBush_.getInExtent(l),h={};c.sort(ut);for(var u=0,d=c.length;u<d;++u){var f=c[u],v=f.segment,g=(0,I.sq)(f.geometry),_=f.depth;if(_&&(g+="-"+_.join("-")),h[g]||(h[g]=new Array(2)),f.geometry.getType()!==m.Z.CIRCLE||1!==f.index)if(!(0,A.fS)(v[0],a)||h[g][0])if(!(0,A.fS)(v[1],a)||h[g][1])(0,I.sq)(v)in this.vertexSegments_&&!h[g][0]&&!h[g][1]&&this.insertVertexCondition_(e)&&o.push(f);else{if((f.geometry.getType()===m.Z.LINE_STRING||f.geometry.getType()===m.Z.MULTI_LINE_STRING)&&h[g][0]&&0===h[g][0].index)continue;this.dragSegments_.push([f,1]),h[g][1]=f}else this.dragSegments_.push([f,0]),h[g][0]=f;else{var k=De(t,f,r);(0,A.fS)(k,a)&&!h[g][0]&&(this.dragSegments_.push([f,0]),h[g][0]=f)}}o.length&&this.willModifyFeatures_(e,[o]);for(var P=o.length-1;P>=0;--P)this.insertVertex_(o[P],a)}return!!this.vertexFeature_},n.prototype.handleUpEvent=function(e){for(var t=this.dragSegments_.length-1;t>=0;--t){var i=this.dragSegments_[t][0],r=i.geometry;if(r.getType()===m.Z.CIRCLE){var o=r.getCenter(),a=i.featureSegments[0],l=i.featureSegments[1];a.segment[0]=o,a.segment[1]=o,l.segment[0]=o,l.segment[1]=o,this.rBush_.update((0,w.HK)(o),a);var c=r,h=(0,y.Cs)();if(h){var u=e.map.getView().getProjection();c=c.clone().transform(h,u),c=(0,K.Bb)(c).transform(u,h)}this.rBush_.update(c.getExtent(),l)}else this.rBush_.update((0,w.hI)(i.segment),i)}return this.featuresBeingModified_&&(this.dispatchEvent(new _e("modifyend",this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1},n.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map,e.coordinate)},n.prototype.handlePointerAtPixel_=function(e,t,i){var c,h,r=this,o=i||t.getCoordinateFromPixel(e),a=t.getView().getProjection();if(this.hitDetection_&&t.forEachFeatureAtPixel(e,function(O,Pe,N){if((N=N||O.getGeometry()).getType()===m.Z.POINT&&(0,M.q9)(r.features_.getArray(),O)){h=N;var Ee=N.getFlatCoordinates().slice(0,2);c=[{feature:O,geometry:N,segment:[Ee,Ee]}]}return!0},{layerFilter:"object"==typeof this.hitDetection_?function(O){return O===r.hitDetection_}:void 0}),!c){var d=(0,y.dY)((0,w.HK)(o,Re),a),f=t.getView().getResolution()*this.pixelTolerance_,v=(0,y.Fj)((0,w.f3)(d,f,Re),a);c=this.rBush_.getInExtent(v)}if(c&&c.length>0){var g=c.sort(function(O,Pe){return Oe(o,O,a)-Oe(o,Pe,a)})[0],_=g.segment,k=De(o,g,a),P=t.getPixelFromCoordinate(k),T=(0,A.TE)(e,P);if(h||T<=this.pixelTolerance_){var R={};if(R[(0,I.sq)(_)]=!0,this.snapToPointer_||(this.delta_[0]=k[0]-o[0],this.delta_[1]=k[1]-o[1]),g.geometry.getType()===m.Z.CIRCLE&&1===g.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(k,[g.feature],[g.geometry]);else{var J=t.getPixelFromCoordinate(_[0]),Q=t.getPixelFromCoordinate(_[1]),$=(0,A.bI)(P,J),q=(0,A.bI)(P,Q);T=Math.sqrt(Math.min($,q)),this.snappedToVertex_=T<=this.pixelTolerance_,this.snappedToVertex_&&(k=$>q?_[1]:_[0]),this.createOrUpdateVertexFeature_(k,[g.feature],[g.geometry]);var L={};L[(0,I.sq)(g.geometry)]=!0;for(var S=1,U=c.length;S<U;++S){var F=c[S].segment;if(!((0,A.fS)(_[0],F[0])&&(0,A.fS)(_[1],F[1])||(0,A.fS)(_[0],F[1])&&(0,A.fS)(_[1],F[0])))break;var Ae=(0,I.sq)(c[S].geometry);Ae in L||(L[Ae]=!0,R[(0,I.sq)(F)]=!0)}}return void(this.vertexSegments_=R)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},n.prototype.insertVertex_=function(e,t){for(var c,i=e.segment,r=e.feature,o=e.geometry,a=e.depth,l=e.index;t.length<o.getStride();)t.push(0);switch(o.getType()){case m.Z.MULTI_LINE_STRING:case m.Z.POLYGON:(c=o.getCoordinates())[a[0]].splice(l+1,0,t);break;case m.Z.MULTI_POLYGON:(c=o.getCoordinates())[a[1]][a[0]].splice(l+1,0,t);break;case m.Z.LINE_STRING:(c=o.getCoordinates()).splice(l+1,0,t);break;default:return}this.setGeometryCoordinates_(o,c);var h=this.rBush_;h.remove(e),this.updateSegmentIndices_(o,l,a,1);var u={segment:[i[0],t],feature:r,geometry:o,depth:a,index:l};h.insert((0,w.hI)(u.segment),u),this.dragSegments_.push([u,1]);var d={segment:[t,i[1]],feature:r,geometry:o,depth:a,index:l+1};h.insert((0,w.hI)(d.segment),d),this.dragSegments_.push([d,0]),this.ignoreNextSingleClick_=!0},n.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=b.Z.POINTERDRAG){var e=this.lastPointerEvent_;this.willModifyFeatures_(e,this.dragSegments_);var t=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new _e("modifyend",this.featuresBeingModified_,e)),this.featuresBeingModified_=null,t}return!1},n.prototype.removeVertex_=function(){var r,o,a,l,c,h,u,d,f,v,g,e=this.dragSegments_,t={},i=!1;for(c=e.length-1;c>=0;--c)g=(0,I.sq)((v=(a=e[c])[0]).feature),v.depth&&(g+="-"+v.depth.join("-")),g in t||(t[g]={}),0===a[1]?(t[g].right=v,t[g].index=v.index):1==a[1]&&(t[g].left=v,t[g].index=v.index+1);for(g in t){switch(f=t[g].right,(d=(h=t[g].index)-1)<0&&(d=0),r=o=(l=(v=void 0!==(u=t[g].left)?u:f).geometry).getCoordinates(),i=!1,l.getType()){case m.Z.MULTI_LINE_STRING:o[v.depth[0]].length>2&&(o[v.depth[0]].splice(h,1),i=!0);break;case m.Z.LINE_STRING:o.length>2&&(o.splice(h,1),i=!0);break;case m.Z.MULTI_POLYGON:r=r[v.depth[1]];case m.Z.POLYGON:(r=r[v.depth[0]]).length>4&&(h==r.length-1&&(h=0),r.splice(h,1),i=!0,0===h&&(r.pop(),r.push(r[0]),d=r.length-1))}if(i){this.setGeometryCoordinates_(l,o);var _=[];if(void 0!==u&&(this.rBush_.remove(u),_.push(u.segment[0])),void 0!==f&&(this.rBush_.remove(f),_.push(f.segment[1])),void 0!==u&&void 0!==f){var k={depth:v.depth,feature:v.feature,geometry:v.geometry,index:d,segment:_};this.rBush_.insert((0,w.hI)(k.segment),k)}this.updateSegmentIndices_(l,h,v.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return i},n.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1},n.prototype.updateSegmentIndices_=function(e,t,i,r){this.rBush_.forEachInExtent(e.getExtent(),function(o){o.geometry===e&&(void 0===i||void 0===o.depth||(0,M.fS)(o.depth,i))&&o.index>t&&(o.index+=r)})},n}(fe.Z);function ut(s,n){return s.index-n.index}function Oe(s,n,e){var t=n.geometry;if(t.getType()===m.Z.CIRCLE){var i=t;if(1===n.index){var r=(0,y.Cs)();r&&(i=i.clone().transform(r,e));var o=(0,A.bI)(i.getCenter(),(0,y.Vs)(s,e)),a=Math.sqrt(o)-i.getRadius();return a*a}}var l=(0,y.Vs)(s,e);return H[0]=(0,y.Vs)(n.segment[0],e),H[1]=(0,y.Vs)(n.segment[1],e),(0,A.Bs)(l,H)}function De(s,n,e){var t=n.geometry;if(t.getType()===m.Z.CIRCLE&&1===n.index){var i=t,r=(0,y.Cs)();return r&&(i=i.clone().transform(r,e)),(0,y.lO)(i.getClosestPoint((0,y.Vs)(s,e)),e)}var o=(0,y.Vs)(s,e);return H[0]=(0,y.Vs)(n.segment[0],e),H[1]=(0,y.Vs)(n.segment[1],e),(0,y.lO)((0,A.oL)(o,H),e)}function dt(){var s=(0,Ce.Ly)();return function(n,e){return s[m.Z.POINT]}}const ft=pt;var ne=C(9235),oe=C(8999),Be=C(874),vt=function(){var s=function(n,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}s(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}(),Le=function(s){function n(e,t,i){var r=s.call(this)||this;return void 0!==i&&void 0===t?r.setFlatCoordinates(i,e):r.setCenterAndRadius(e,t||0,i),r}return vt(n,s),n.prototype.clone=function(){var e=new n(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e},n.prototype.closestPointXY=function(e,t,i,r){var o=this.flatCoordinates,a=e-o[0],l=t-o[1],c=a*a+l*l;if(c<r){if(0===c)for(var h=0;h<this.stride;++h)i[h]=o[h];else{var u=this.getRadius()/Math.sqrt(c);for(i[0]=o[0]+u*a,i[1]=o[1]+u*l,h=2;h<this.stride;++h)i[h]=o[h]}return i.length=this.stride,c}return r},n.prototype.containsXY=function(e,t){var i=this.flatCoordinates,r=e-i[0],o=t-i[1];return r*r+o*o<=this.getRadiusSquared_()},n.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},n.prototype.computeExtent=function(e){var t=this.flatCoordinates,i=t[this.stride]-t[0];return(0,w.T9)(t[0]-i,t[1]-i,t[0]+i,t[1]+i,e)},n.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},n.prototype.getRadiusSquared_=function(){var e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t},n.prototype.getType=function(){return m.Z.CIRCLE},n.prototype.intersectsExtent=function(e){var t=this.getExtent();if((0,w.kK)(e,t)){var i=this.getCenter();return e[0]<=i[0]&&e[2]>=i[0]||e[1]<=i[1]&&e[3]>=i[1]||(0,w.H6)(e,this.intersectsCoordinate.bind(this))}return!1},n.prototype.setCenter=function(e){var t=this.stride,i=this.flatCoordinates[t]-this.flatCoordinates[0],r=e.slice();r[t]=r[0]+i;for(var o=1;o<t;++o)r[t+o]=e[o];this.setFlatCoordinates(this.layout,r),this.changed()},n.prototype.setCenterAndRadius=function(e,t,i){this.setLayout(i,e,0),this.flatCoordinates||(this.flatCoordinates=[]);var r=this.flatCoordinates,o=(0,oe.IG)(r,0,e,this.stride);r[o++]=r[0]+t;for(var a=1,l=this.stride;a<l;++a)r[o++]=r[a];r.length=o,this.changed()},n.prototype.getCoordinates=function(){return null},n.prototype.setCoordinates=function(e,t){},n.prototype.setRadius=function(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()},n.prototype.rotate=function(e,t){var i=this.getCenter(),r=this.getStride();this.setCenter((0,Be.U1)(i,0,i.length,r,e,t,i)),this.changed()},n.prototype.translate=function(e,t){var i=this.getCenter(),r=this.getStride();this.setCenter((0,Be.Iu)(i,0,i.length,r,e,t,i)),this.changed()},n}(ne.ZP);const gt=Le;var Ct=C(7366),z=C(6527),mt=C(1994),j=C(4720),se=C(5066),Ne=C(9182),xe=C(392),Ze=C(410),Ge=C(9644),_t=function(){var s=function(n,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}s(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}(),xt=function(s){function n(e,t,i){var r=s.call(this)||this;if(r.ends_=[],r.maxDelta_=-1,r.maxDeltaRevision_=-1,Array.isArray(e[0]))r.setCoordinates(e,t);else if(void 0!==t&&i)r.setFlatCoordinates(t,e),r.ends_=i;else{for(var o=r.getLayout(),a=e,l=[],c=[],h=0,u=a.length;h<u;++h){var d=a[h];0===h&&(o=d.getLayout()),(0,M.l7)(l,d.getFlatCoordinates()),c.push(l.length)}r.setFlatCoordinates(o,l),r.ends_=c}return r}return _t(n,s),n.prototype.appendLineString=function(e){this.flatCoordinates?(0,M.l7)(this.flatCoordinates,e.getFlatCoordinates().slice()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},n.prototype.clone=function(){var e=new n(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e},n.prototype.closestPointXY=function(e,t,i,r){return r<(0,w.qf)(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,se.Af)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,se.Xl)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,i,r))},n.prototype.getCoordinateAtM=function(e,t,i){return this.layout!=j.Z.XYM&&this.layout!=j.Z.XYZM||0===this.flatCoordinates.length?null:(0,Ze.dG)(this.flatCoordinates,0,this.ends_,this.stride,e,void 0!==t&&t,void 0!==i&&i)},n.prototype.getCoordinates=function(){return(0,xe.o1)(this.flatCoordinates,0,this.ends_,this.stride)},n.prototype.getEnds=function(){return this.ends_},n.prototype.getLineString=function(e){return e<0||this.ends_.length<=e?null:new z.Z(this.flatCoordinates.slice(0===e?0:this.ends_[e-1],this.ends_[e]),this.layout)},n.prototype.getLineStrings=function(){for(var e=this.flatCoordinates,t=this.ends_,i=this.layout,r=[],o=0,a=0,l=t.length;a<l;++a){var c=t[a],h=new z.Z(e.slice(o,c),i);r.push(h),o=c}return r},n.prototype.getFlatMidpoints=function(){for(var e=[],t=this.flatCoordinates,i=0,r=this.ends_,o=this.stride,a=0,l=r.length;a<l;++a){var c=r[a],h=(0,Ze.WW)(t,i,c,o,.5);(0,M.l7)(e,h),i=c}return e},n.prototype.getSimplifiedGeometryInternal=function(e){var t=[],i=[];return t.length=(0,Ne.UJ)(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,i),new n(t,j.Z.XY,i)},n.prototype.getType=function(){return m.Z.MULTI_LINE_STRING},n.prototype.intersectsExtent=function(e){return(0,Ge.AW)(this.flatCoordinates,0,this.ends_,this.stride,e)},n.prototype.setCoordinates=function(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=(0,oe._5)(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},n}(ne.ZP);const yt=xt;var wt=C(2156),kt=function(){var s=function(n,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}s(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}(),At=function(s){function n(e,t){var i=s.call(this)||this;return t&&!Array.isArray(e[0])?i.setFlatCoordinates(t,e):i.setCoordinates(e,t),i}return kt(n,s),n.prototype.appendPoint=function(e){this.flatCoordinates?(0,M.l7)(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.changed()},n.prototype.clone=function(){var e=new n(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e},n.prototype.closestPointXY=function(e,t,i,r){if(r<(0,w.qf)(this.getExtent(),e,t))return r;for(var o=this.flatCoordinates,a=this.stride,l=0,c=o.length;l<c;l+=a){var h=(0,wt.bI)(e,t,o[l],o[l+1]);if(h<r){r=h;for(var u=0;u<a;++u)i[u]=o[l+u];i.length=a}}return r},n.prototype.getCoordinates=function(){return(0,xe.Ml)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},n.prototype.getPoint=function(e){return e<0||(this.flatCoordinates?this.flatCoordinates.length/this.stride:0)<=e?null:new Y.Z(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)},n.prototype.getPoints=function(){for(var e=this.flatCoordinates,t=this.layout,i=this.stride,r=[],o=0,a=e.length;o<a;o+=i){var l=new Y.Z(e.slice(o,o+i),t);r.push(l)}return r},n.prototype.getType=function(){return m.Z.MULTI_POINT},n.prototype.intersectsExtent=function(e){for(var t=this.flatCoordinates,i=this.stride,r=0,o=t.length;r<o;r+=i)if((0,w.jE)(e,t[r],t[r+1]))return!0;return!1},n.prototype.setCoordinates=function(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,oe.Sg)(this.flatCoordinates,0,e,this.stride),this.changed()},n}(ne.ZP);const Ye=At;var Pt=C(2474),ye=C(1265),Et=C(8818),bt=C(4325),St=function(){var s=function(n,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}s(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}(),It=function(s){function n(e,t,i){var r=s.call(this)||this;if(r.endss_=[],r.flatInteriorPointsRevision_=-1,r.flatInteriorPoints_=null,r.maxDelta_=-1,r.maxDeltaRevision_=-1,r.orientedRevision_=-1,r.orientedFlatCoordinates_=null,!i&&!Array.isArray(e[0])){for(var o=r.getLayout(),a=e,l=[],c=[],h=0,u=a.length;h<u;++h){var d=a[h];0===h&&(o=d.getLayout());for(var f=l.length,v=d.getEnds(),g=0,_=v.length;g<_;++g)v[g]+=f;(0,M.l7)(l,d.getFlatCoordinates()),c.push(v)}t=o,e=l,i=c}return void 0!==t&&i?(r.setFlatCoordinates(t,e),r.endss_=i):r.setCoordinates(e,t),r}return St(n,s),n.prototype.appendPolygon=function(e){var t;if(this.flatCoordinates){var i=this.flatCoordinates.length;(0,M.l7)(this.flatCoordinates,e.getFlatCoordinates());for(var r=0,o=(t=e.getEnds().slice()).length;r<o;++r)t[r]+=i}else this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();this.endss_.push(t),this.changed()},n.prototype.clone=function(){for(var e=this.endss_.length,t=new Array(e),i=0;i<e;++i)t[i]=this.endss_[i].slice();var r=new n(this.flatCoordinates.slice(),this.layout,t);return r.applyProperties(this),r},n.prototype.closestPointXY=function(e,t,i,r){return r<(0,w.qf)(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,se.sD)(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,se.gI)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,i,r))},n.prototype.containsXY=function(e,t){return(0,bt.Zl)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)},n.prototype.getArea=function(){return(0,Et.Eu)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},n.prototype.getCoordinates=function(e){var t;return void 0!==e?(t=this.getOrientedFlatCoordinates().slice(),(0,ye.dL)(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,(0,xe.ug)(t,0,this.endss_,this.stride)},n.prototype.getEndss=function(){return this.endss_},n.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var e=function Tt(s,n,e,t){for(var i=[],r=(0,w.lJ)(),o=0,a=e.length;o<a;++o){var l=e[o];r=(0,w.GN)(s,n,l[0],t),i.push((r[0]+r[2])/2,(r[1]+r[3])/2),n=l[l.length-1]}return i}(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=(0,Pt.U)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},n.prototype.getInteriorPoints=function(){return new Ye(this.getFlatInteriorPoints().slice(),j.Z.XYM)},n.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var e=this.flatCoordinates;(0,ye.Oj)(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=(0,ye.dL)(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},n.prototype.getSimplifiedGeometryInternal=function(e){var t=[],i=[];return t.length=(0,Ne.Pp)(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,i),new n(t,j.Z.XY,i)},n.prototype.getPolygon=function(e){if(e<0||this.endss_.length<=e)return null;var t;if(0===e)t=0;else{var i=this.endss_[e-1];t=i[i.length-1]}var r=this.endss_[e].slice(),o=r[r.length-1];if(0!==t)for(var a=0,l=r.length;a<l;++a)r[a]-=t;return new K.ZP(this.flatCoordinates.slice(t,o),this.layout,r)},n.prototype.getPolygons=function(){for(var e=this.layout,t=this.flatCoordinates,i=this.endss_,r=[],o=0,a=0,l=i.length;a<l;++a){var c=i[a].slice(),h=c[c.length-1];if(0!==o)for(var u=0,d=c.length;u<d;++u)c[u]-=o;var f=new K.ZP(t.slice(o,h),e,c);r.push(f),o=h}return r},n.prototype.getType=function(){return m.Z.MULTI_POLYGON},n.prototype.intersectsExtent=function(e){return(0,Ge.oW)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)},n.prototype.setCoordinates=function(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);var i=(0,oe.QT)(this.flatCoordinates,0,e,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{var r=i[i.length-1];this.flatCoordinates.length=0===r.length?0:r[r.length-1]}this.changed()},n}(ne.ZP);const Ft=It;var ae=C(1345),Ke=function(){var s=function(n,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}s(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}(),ce=function(s){function n(e,t){var i=s.call(this,e)||this;return i.feature=t,i}return Ke(n,s),n}(Ie.ZP),Vt=function(s){function n(e){var t=this,i=e;i.stopDown||(i.stopDown=ae.Dv),(t=s.call(this,i)||this).shouldHandle_=!1,t.downPx_=null,t.freehand_=!1,t.source_=e.source?e.source:null,t.features_=e.features?e.features:null,t.snapTolerance_=e.snapTolerance?e.snapTolerance:12,t.type_=e.type,t.mode_=function Rt(s){switch(s){case m.Z.POINT:case m.Z.MULTI_POINT:return"Point";case m.Z.LINE_STRING:case m.Z.MULTI_LINE_STRING:return"LineString";case m.Z.POLYGON:case m.Z.MULTI_POLYGON:return"Polygon";case m.Z.CIRCLE:return"Circle";default:throw new Error("Invalid type: "+s)}}(t.type_),t.stopClick_=!!e.stopClick,t.minPoints_=e.minPoints?e.minPoints:"Polygon"===t.mode_?3:2,t.maxPoints_="Circle"===t.mode_?2:e.maxPoints?e.maxPoints:1/0,t.finishCondition_=e.finishCondition?e.finishCondition:ae.uX;var r=e.geometryFunction;if(!r){var a,o=t.mode_;"Circle"===o?r=function(l,c,h){var u=c||new gt([NaN,NaN]),d=(0,y.Vs)(l[0],h),f=(0,A.bI)(d,(0,y.Vs)(l[l.length-1],h));u.setCenterAndRadius(d,Math.sqrt(f));var v=(0,y.Cs)();return v&&u.transform(h,v),u}:("Point"===o?a=Y.Z:"LineString"===o?a=z.Z:"Polygon"===o&&(a=K.ZP),r=function(l,c,h){return c?c.setCoordinates("Polygon"===o?l[0].length?[l[0].concat([l[0][0]])]:[]:l):c=new a(l),c})}return t.geometryFunction_=r,t.dragVertexDelay_=void 0!==e.dragVertexDelay?e.dragVertexDelay:500,t.finishCoordinate_=null,t.sketchFeature_=null,t.sketchPoint_=null,t.sketchCoords_=null,t.sketchLine_=null,t.sketchLineCoords_=null,t.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,t.overlay_=new ve.Z({source:new ge.Z({useSpatialIndex:!1,wrapX:!!e.wrapX&&e.wrapX}),style:e.style?e.style:Mt(),updateWhileInteracting:!0}),t.geometryName_=e.geometryName,t.condition_=e.condition?e.condition:D.rM,t.freehandCondition_=e.freehand?D.Bx:e.freehandCondition?e.freehandCondition:D.vY,t.addChangeListener(Ct.Z.ACTIVE,t.updateState_),t}return Ke(n,s),n.prototype.setMap=function(e){s.prototype.setMap.call(this,e),this.updateState_()},n.prototype.getOverlay=function(){return this.overlay_},n.prototype.handleEvent=function(e){e.originalEvent.type===ie.Z.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_="Point"!==this.mode_&&this.freehandCondition_(e);var t=e.type===b.Z.POINTERMOVE,i=!0;return!this.freehand_&&this.lastDragTime_&&e.type===b.Z.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,t=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===b.Z.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(e.coordinate),i=!1):this.freehand_&&e.type===b.Z.POINTERDOWN?i=!1:t&&this.getPointerCount()<2?(i=e.type===b.Z.POINTERMOVE)&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):("mouse"===e.originalEvent.pointerType||e.type===b.Z.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(e):e.type===b.Z.DBLCLICK&&(i=!1),s.prototype.handleEvent.call(this,e)&&i},n.prototype.handleDownEvent=function(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new mt.Z(b.Z.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)},n.prototype.handleUpEvent=function(e){var t=!0;if(0===this.getPointerCount())if(this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e),this.shouldHandle_){var i=!this.finishCoordinate_;i&&this.startDrawing_(e.coordinate),!i&&this.freehand_?this.finishDrawing():!this.freehand_&&(!i||"Point"===this.mode_)&&(this.atFinish_(e.pixel)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),t=!1}else this.freehand_&&this.abortDrawing();return!t&&this.stopClick_&&e.preventDefault(),t},n.prototype.handlePointerMove_=function(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var t=this.downPx_,i=e.pixel,r=t[0]-i[0],o=t[1]-i[1],a=r*r+o*o;if(this.shouldHandle_=this.freehand_?a>this.squaredClickTolerance_:a<=this.squaredClickTolerance_,!this.shouldHandle_)return}this.finishCoordinate_?this.modifyDrawing_(e.coordinate):this.createOrUpdateSketchPoint_(e.coordinate.slice())},n.prototype.atFinish_=function(e){var t=!1;if(this.sketchFeature_){var i=!1,r=[this.finishCoordinate_],o=this.mode_;if("Point"===o)t=!0;else if("Circle"===o)t=2===this.sketchCoords_.length;else if("LineString"===o)i=this.sketchCoords_.length>this.minPoints_;else if("Polygon"===o){var a=this.sketchCoords_;i=a[0].length>this.minPoints_,r=[a[0][0],a[0][a[0].length-2]]}if(i)for(var l=this.getMap(),c=0,h=r.length;c<h;c++){var u=r[c],d=l.getPixelFromCoordinate(u),f=e[0]-d[0],v=e[1]-d[1],g=this.freehand_?1:this.snapTolerance_;if(t=Math.sqrt(f*f+v*v)<=g){this.finishCoordinate_=u;break}}}return t},n.prototype.createOrUpdateSketchPoint_=function(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new G.Z(new Y.Z(e)),this.updateSketchFeatures_())},n.prototype.createOrUpdateCustomSketchLine_=function(e){this.sketchLine_||(this.sketchLine_=new G.Z);var t=e.getLinearRing(0),i=this.sketchLine_.getGeometry();i?(i.setFlatCoordinates(t.getLayout(),t.getFlatCoordinates()),i.changed()):(i=new z.Z(t.getFlatCoordinates(),t.getLayout()),this.sketchLine_.setGeometry(i))},n.prototype.startDrawing_=function(e){var t=this.getMap().getView().getProjection();this.finishCoordinate_=e,"Point"===this.mode_?this.sketchCoords_=e.slice():"Polygon"===this.mode_?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new G.Z(new z.Z(this.sketchLineCoords_)));var i=this.geometryFunction_(this.sketchCoords_,void 0,t);this.sketchFeature_=new G.Z,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new ce("drawstart",this.sketchFeature_))},n.prototype.modifyDrawing_=function(e){var o,a,t=this.getMap(),i=this.sketchFeature_.getGeometry(),r=t.getView().getProjection();"Point"===this.mode_?a=this.sketchCoords_:"Polygon"===this.mode_?(a=(o=this.sketchCoords_[0])[o.length-1],this.atFinish_(t.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):a=(o=this.sketchCoords_)[o.length-1],a[0]=e[0],a[1]=e[1],this.geometryFunction_(this.sketchCoords_,i,r),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),i.getType()===m.Z.POLYGON&&"Polygon"!==this.mode_?this.createOrUpdateCustomSketchLine_(i):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()},n.prototype.addToDrawing_=function(e){var r,o,t=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection(),a=this.mode_;"LineString"===a||"Circle"===a?(this.finishCoordinate_=e.slice(),(o=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?o.pop():r=!0),o.push(e.slice()),this.geometryFunction_(o,t,i)):"Polygon"===a&&((o=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?o.pop():r=!0),o.push(e.slice()),r&&(this.finishCoordinate_=o[0]),this.geometryFunction_(this.sketchCoords_,t,i)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),r&&this.finishDrawing()},n.prototype.removeLastPoint=function(){if(this.sketchFeature_){var i,e=this.sketchFeature_.getGeometry(),t=this.getMap().getView().getProjection(),r=this.mode_;if("LineString"===r||"Circle"===r){if((i=this.sketchCoords_).splice(-2,1),i.length>=2){this.finishCoordinate_=i[i.length-2].slice();var o=this.finishCoordinate_.slice();i[i.length-1]=o,this.createOrUpdateSketchPoint_(o)}this.geometryFunction_(i,e,t),e.getType()===m.Z.POLYGON&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(e)}else if("Polygon"===r){(i=this.sketchCoords_[0]).splice(-2,1);var a=this.sketchLine_.getGeometry();i.length>=2&&(o=i[i.length-2].slice(),i[i.length-1]=o,this.createOrUpdateSketchPoint_(o)),a.setCoordinates(i),this.geometryFunction_(this.sketchCoords_,e,t)}1===i.length&&this.abortDrawing(),this.updateSketchFeatures_()}},n.prototype.finishDrawing=function(){var e=this.abortDrawing_();if(e){var t=this.sketchCoords_,i=e.getGeometry(),r=this.getMap().getView().getProjection();"LineString"===this.mode_?(t.pop(),this.geometryFunction_(t,i,r)):"Polygon"===this.mode_&&(t[0].pop(),this.geometryFunction_(t,i,r),t=i.getCoordinates()),this.type_===m.Z.MULTI_POINT?e.setGeometry(new Ye([t])):this.type_===m.Z.MULTI_LINE_STRING?e.setGeometry(new yt([t])):this.type_===m.Z.MULTI_POLYGON&&e.setGeometry(new Ft([t])),this.dispatchEvent(new ce("drawend",e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e)}},n.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),e},n.prototype.abortDrawing=function(){var e=this.abortDrawing_();e&&this.dispatchEvent(new ce("drawabort",e))},n.prototype.appendCoordinates=function(e){var r,t=this.mode_,i=!this.sketchFeature_;if(i&&this.startDrawing_(e[0]),"LineString"===t||"Circle"===t)r=this.sketchCoords_;else{if("Polygon"!==t)return;r=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]}i&&r.shift(),r.pop();for(var o=0;o<e.length;o++)this.addToDrawing_(e[o]);var a=e[e.length-1];this.addToDrawing_(a),this.modifyDrawing_(a)},n.prototype.extend=function(e){var i=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=i.getCoordinates();var r=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=r.slice(),this.sketchCoords_.push(r.slice()),this.sketchPoint_=new G.Z(new Y.Z(r)),this.updateSketchFeatures_(),this.dispatchEvent(new ce("drawstart",this.sketchFeature_))},n.prototype.updateSketchFeatures_=function(){var e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);var t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)},n.prototype.updateState_=function(){var e=this.getMap(),t=this.getActive();(!e||!t)&&this.abortDrawing(),this.overlay_.setMap(t?e:null)},n}(fe.Z);function Mt(){var s=(0,Ce.Ly)();return function(n,e){return s[n.getGeometry().getType()]}}const Ot=Vt;var Dt=C(9466),B=C(1729),Bt=function(){var s=function(n,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}s(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}();function He(s){return s.feature?s.feature:s.element?s.element:void 0}var we=[],Lt=function(s){function n(e){var t=this,i=e||{},r=i;return r.handleDownEvent||(r.handleDownEvent=ae.uX),r.stopDown||(r.stopDown=ae.Dv),(t=s.call(this,r)||this).source_=i.source?i.source:null,t.vertex_=void 0===i.vertex||i.vertex,t.edge_=void 0===i.edge||i.edge,t.features_=i.features?i.features:null,t.featuresListenerKeys_=[],t.featureChangeListenerKeys_={},t.indexedFeaturesExtents_={},t.pendingFeatures_={},t.pixelTolerance_=void 0!==i.pixelTolerance?i.pixelTolerance:10,t.rBush_=new Fe.Z,t.GEOMETRY_SEGMENTERS_={Point:t.segmentPointGemetry_.bind(t),LineString:t.segmentLineStringGemetry_.bind(t),LinearRing:t.segmentLineStringGemetry_.bind(t),Polygon:t.segmentPolygonGemetry_.bind(t),MultiPoint:t.segmentMultiPointGemetry_.bind(t),MultiLineString:t.segmentMultiLineStringGemetry_.bind(t),MultiPolygon:t.segmentMultiPolygonGemetry_.bind(t),GeometryCollection:t.segmentGeometryCollectionGemetry_.bind(t),Circle:t.segmentCircleGemetry_.bind(t)},t}return Bt(n,s),n.prototype.addFeature=function(e,t){var i=void 0===t||t,r=(0,I.sq)(e),o=e.getGeometry();if(o){var a=this.GEOMETRY_SEGMENTERS_[o.getType()];if(a){this.indexedFeaturesExtents_[r]=o.getExtent((0,w.lJ)());var l=[];if(a(l,o),1===l.length)this.rBush_.insert((0,w.hI)(l[0]),{feature:e,segment:l[0]});else if(l.length>1){var c=l.map(function(u){return(0,w.hI)(u)}),h=l.map(function(u){return{feature:e,segment:u}});this.rBush_.load(c,h)}}}i&&(this.featureChangeListenerKeys_[r]=(0,B.oL)(e,ie.Z.CHANGE,this.handleFeatureChange_,this))},n.prototype.forEachFeatureAdd_=function(e){this.addFeature(e)},n.prototype.forEachFeatureRemove_=function(e){this.removeFeature(e)},n.prototype.getFeatures_=function(){var e;return this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures()),e},n.prototype.handleEvent=function(e){var t=this.snapTo(e.pixel,e.coordinate,e.map);return t&&(e.coordinate=t.vertex.slice(0,2),e.pixel=t.vertexPixel),s.prototype.handleEvent.call(this,e)},n.prototype.handleFeatureAdd_=function(e){var t=He(e);this.addFeature(t)},n.prototype.handleFeatureRemove_=function(e){var t=He(e);this.removeFeature(t)},n.prototype.handleFeatureChange_=function(e){var t=e.target;if(this.handlingDownUpSequence){var i=(0,I.sq)(t);i in this.pendingFeatures_||(this.pendingFeatures_[i]=t)}else this.updateFeature_(t)},n.prototype.handleUpEvent=function(e){var t=(0,Dt.KX)(this.pendingFeatures_);return t.length&&(t.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1},n.prototype.removeFeature=function(e,t){var i=void 0===t||t,r=(0,I.sq)(e),o=this.indexedFeaturesExtents_[r];if(o){var a=this.rBush_,l=[];a.forEachInExtent(o,function(h){e===h.feature&&l.push(h)});for(var c=l.length-1;c>=0;--c)a.remove(l[c])}i&&((0,B.bN)(this.featureChangeListenerKeys_[r]),delete this.featureChangeListenerKeys_[r])},n.prototype.setMap=function(e){var t=this.getMap(),i=this.featuresListenerKeys_,r=this.getFeatures_();t&&(i.forEach(B.bN),i.length=0,r.forEach(this.forEachFeatureRemove_.bind(this))),s.prototype.setMap.call(this,e),e&&(this.features_?i.push((0,B.oL)(this.features_,te.Z.ADD,this.handleFeatureAdd_,this),(0,B.oL)(this.features_,te.Z.REMOVE,this.handleFeatureRemove_,this)):this.source_&&i.push((0,B.oL)(this.source_,re.Z.ADDFEATURE,this.handleFeatureAdd_,this),(0,B.oL)(this.source_,re.Z.REMOVEFEATURE,this.handleFeatureRemove_,this)),r.forEach(this.forEachFeatureAdd_.bind(this)))},n.prototype.snapTo=function(e,t,i){var r=i.getCoordinateFromPixel([e[0]-this.pixelTolerance_,e[1]+this.pixelTolerance_]),o=i.getCoordinateFromPixel([e[0]+this.pixelTolerance_,e[1]-this.pixelTolerance_]),a=(0,w.hI)([r,o]),l=this.rBush_.getInExtent(a),c=l.length;if(0===c)return null;var d,h=i.getView().getProjection(),u=(0,y.Vs)(t,h),f=1/0,v=this.pixelTolerance_*this.pixelTolerance_,g=function(){if(d){var S=i.getPixelFromCoordinate(d);if((0,A.bI)(e,S)<=v)return{vertex:d,vertexPixel:[Math.round(S[0]),Math.round(S[1])]}}return null};if(this.vertex_){for(var _=0;_<c;++_)(k=l[_]).feature.getGeometry().getType()!==m.Z.CIRCLE&&k.segment.forEach(function(S){var U=(0,y.Vs)(S,h),F=(0,A.bI)(u,U);F<f&&(d=S,f=F)});if(P=g())return P}if(this.edge_){for(_=0;_<c;++_){var k,T=null;if((k=l[_]).feature.getGeometry().getType()===m.Z.CIRCLE){var R=k.feature.getGeometry(),J=(0,y.Cs)();J&&(R=R.clone().transform(J,h)),T=(0,y.lO)((0,A.Ed)(u,R),h)}else{var Q=k.segment,q=Q[1];q&&(we[0]=(0,y.Vs)(Q[0],h),we[1]=(0,y.Vs)(q,h),T=(0,A.oL)(u,we))}if(T){var L=(0,A.bI)(u,T);L<f&&(d=T,f=L)}}var P;if(P=g())return P}return null},n.prototype.updateFeature_=function(e){this.removeFeature(e,!1),this.addFeature(e,!1)},n.prototype.segmentCircleGemetry_=function(e,t){var i=this.getMap().getView().getProjection(),r=t,o=(0,y.Cs)();o&&(r=r.clone().transform(o,i));var a=(0,K.Bb)(r);o&&a.transform(i,o);for(var l=a.getCoordinates()[0],c=0,h=l.length-1;c<h;++c)e.push(l.slice(c,c+2))},n.prototype.segmentGeometryCollectionGemetry_=function(e,t){for(var i=t.getGeometriesArray(),r=0;r<i.length;++r){var o=this.GEOMETRY_SEGMENTERS_[i[r].getType()];o&&o(e,i[r])}},n.prototype.segmentLineStringGemetry_=function(e,t){for(var i=t.getCoordinates(),r=0,o=i.length-1;r<o;++r)e.push(i.slice(r,r+2))},n.prototype.segmentMultiLineStringGemetry_=function(e,t){for(var i=t.getCoordinates(),r=0,o=i.length;r<o;++r)for(var a=i[r],l=0,c=a.length-1;l<c;++l)e.push(a.slice(l,l+2))},n.prototype.segmentMultiPointGemetry_=function(e,t){t.getCoordinates().forEach(function(i){e.push([i])})},n.prototype.segmentMultiPolygonGemetry_=function(e,t){for(var i=t.getCoordinates(),r=0,o=i.length;r<o;++r)for(var a=i[r],l=0,c=a.length;l<c;++l)for(var h=a[l],u=0,d=h.length-1;u<d;++u)e.push(h.slice(u,u+2))},n.prototype.segmentPointGemetry_=function(e,t){e.push([t.getCoordinates()])},n.prototype.segmentPolygonGemetry_=function(e,t){for(var i=t.getCoordinates(),r=0,o=i.length;r<o;++r)for(var a=i[r],l=0,c=a.length-1;l<c;++l)e.push(a.slice(l,l+2))},n}(fe.Z);const Nt=Lt;var he,qe=C(5044),Ue=C(6785),Zt=C(949),Gt=new Uint8Array(16);function Yt(){if(!he&&!(he="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return he(Gt)}const Kt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,qt=function Ht(s){return"string"==typeof s&&Kt.test(s)};for(var E=[],ke=0;ke<256;++ke)E.push((ke+256).toString(16).substr(1));const zt=function Xt(s,n,e){var t=(s=s||{}).random||(s.rng||Yt)();if(t[6]=15&t[6]|64,t[8]=63&t[8]|128,n){e=e||0;for(var i=0;i<16;++i)n[e+i]=t[i];return n}return function Ut(s){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=(E[s[n+0]]+E[s[n+1]]+E[s[n+2]]+E[s[n+3]]+"-"+E[s[n+4]]+E[s[n+5]]+"-"+E[s[n+6]]+E[s[n+7]]+"-"+E[s[n+8]]+E[s[n+9]]+"-"+E[s[n+10]]+E[s[n+11]]+E[s[n+12]]+E[s[n+13]]+E[s[n+14]]+E[s[n+15]]).toLowerCase();if(!qt(e))throw TypeError("Stringified UUID is invalid");return e}(t)};var pe=C(801),jt=C(9947),Jt=C(3686),Qt=C(2313);function $t(s,n){if(1&s){const e=p.EpF();p.ynx(0),p._UZ(1,"input",10),p.TgZ(2,"label",11),p.NdJ("click",function(){const r=p.CHM(e).$implicit;return p.oxw().addInteractions(r.name)}),p.TgZ(3,"fa-icon",12),p._uU(4),p.qZA()(),p.BQk()}if(2&s){const e=n.$implicit,t=p.oxw();p.xp6(1),p.Q6J("id","btnradio-seletor-"+e.name)("checked",t.geomTypeSelected===e.name),p.xp6(1),p.Q6J("for","btnradio-seletor-"+e.name),p.xp6(1),p.Q6J("icon",e.icon),p.xp6(1),p.Oqu(e.name)}}function ei(s,n){if(1&s&&p._UZ(0,"fa-icon",12),2&s){const e=p.oxw(3);p.Q6J("icon",e.pointIcon)}}function ti(s,n){if(1&s&&p._UZ(0,"fa-icon",12),2&s){const e=p.oxw(3);p.Q6J("icon",e.lineStringIcon)}}function ii(s,n){if(1&s&&p._UZ(0,"fa-icon",12),2&s){const e=p.oxw(3);p.Q6J("icon",e.polygonIcon)}}function ri(s,n){if(1&s){const e=p.EpF();p.TgZ(0,"div",15)(1,"div",16),p.YNc(2,ei,1,1,"fa-icon",17),p.YNc(3,ti,1,1,"fa-icon",17),p.YNc(4,ii,1,1,"fa-icon",17),p._uU(5),p.TgZ(6,"span",18),p.NdJ("click",function(){const r=p.CHM(e).$implicit;return p.oxw(2).removeFeature(r.id)}),p._uU(7," XX"),p.qZA()()()}if(2&s){const e=n.$implicit;p.xp6(2),p.Q6J("ngIf","Point"===e.geom_type),p.xp6(1),p.Q6J("ngIf","LineString"===e.geom_type),p.xp6(1),p.Q6J("ngIf","Polygon"===e.geom_type),p.xp6(1),p.hij(" ",e.name," ")}}function ni(s,n){if(1&s&&(p.TgZ(0,"div",13),p.YNc(1,ri,8,4,"div",14),p.qZA()),2&s){const e=n.$implicit;p.xp6(1),p.Q6J("ngForOf",e)}}function oi(s,n){if(1&s&&(p.ynx(0),p._UZ(1,"input",10),p.TgZ(2,"label",19)(3,"fa-icon",20),p._uU(4),p.qZA()(),p.BQk()),2&s){const e=n.$implicit,t=p.oxw();p.xp6(1),p.Q6J("id","btnradio-export-"+e.name)("checked",t.geomTypeSelected===e.name),p.xp6(1),p.Q6J("for","btnradio-export-"+e.name),p.xp6(1),p.Q6J("icon",e.icon)("ngClass",t.geomTypeSelected===e.name?"text-white":"text-black"),p.xp6(1),p.Oqu(e.name)}}const si=[{path:"",component:(()=>{class s{constructor(e,t,i,r){this.mapService=e,this.controlerService=t,this.activatedRoute=i,this.titleService=r,this.layerName="edited_layer",this._allFeatures=[],this.allFeatures=[],this.allRawFeatures=[],this.editDisabledIcon=pe.g82,this.pointIcon=pe.diR,this.lineStringIcon=pe.fQK,this.polygonIcon=pe.ubJ,this.geomTypesSupported=[{name:"editDisabled",icon:this.editDisabledIcon},{name:"Point",icon:this.pointIcon},{name:"LineString",icon:this.lineStringIcon},{name:"Polygon",icon:this.polygonIcon}],this.geomTypeSelected="editDisabled",this.isLegendDisplayed=!0,this.mapSubscription=this.mapService.map.subscribe(o=>{this.map=o})}ngOnInit(){this.sendResumeSubMenus(),this.mapService.getMap(),this.initSourceFeatures(),this.initVectorLayer(),this.initModifier(),this.mapService.changeMapInteractionStatus(!0),this.addInteractions(this.geomTypesSupported[0].name)}ngOnDestroy(){this.mapSubscription.unsubscribe(),this.map.removeInteraction(this.modifier),this.mapService.resetMapView(),this.mapService.changeMapInteractionStatus(!1)}sendResumeSubMenus(){this.controlerService.pullSubMenus([]),this.controlerService.pullTitlePage(this.activatedRoute.snapshot.data.title),console.log(this.activatedRoute.snapshot.data.title),this.titleService.setTitle(this.activatedRoute.snapshot.data.title)}showHideLegend(){this.isLegendDisplayed=!this.isLegendDisplayed}initSourceFeatures(){this.sourceFeatures=new ge.Z}initModifier(){this.modifier=new ft({source:this.sourceFeatures}),this.map.addInteraction(this.modifier)}initVectorLayer(){this.layerFeatures=new ve.Z({source:this.sourceFeatures,style:new Ce.ZP({fill:new qe.Z({color:"#ffcc33"}),stroke:new Ue.Z({color:"black",width:2}),image:new Zt.Z({radius:7,fill:new qe.Z({color:"#ffcc33"}),stroke:new Ue.Z({color:"black",width:2})})})}),this.layerFeatures.getSource().on("addfeature",e=>{this.returnFeatures()}),this.layerFeatures.getSource().on("removefeature",e=>{this.returnFeatures()}),this.layerFeatures.set("name",this.layerName),this.map.addLayer(this.layerFeatures)}addInteractions(e){"editDisabled"!==e?(this.removeInteractions(),this.map.addInteraction(this.modifier),this.geomTypeSelected=e,console.log(this.geomTypeSelected),this.draw=new Ot({source:this.sourceFeatures,type:e}),this.draw.on("drawend",t=>{var i;const r=this.layerFeatures.getSource().getFeatures().length;t.feature.setProperties({id:zt(),name:"feature_"+r,geom_type:null===(i=t.feature.getGeometry())||void 0===i?void 0:i.getType(),created_at:(new Date).toISOString()})}),this.map.addInteraction(this.draw),this.snap=new Nt({source:this.sourceFeatures}),this.map.addInteraction(this.snap)):this.removeInteractions()}removeInteractions(){void 0!==this.draw&&void 0!==this.snap&&(this.map.removeInteraction(this.draw),this.map.removeInteraction(this.snap)),this.map.removeInteraction(this.modifier)}returnFeatures(){let e=[];this.sourceFeatures.getFeatures().forEach(t=>{e.push({id:t.get("id"),name:t.get("name"),geom_type:t.get("geom_type")})}),this.allFeatures=this.chunk(e,4)}chunk(e,t){let i=[];for(let r=0;r<e.length;r+=t){const o=e.slice(r,r+t);i.push(o)}return i}removeFeature(e){const t=this.layerFeatures.getSource().getFeatures().filter(i=>i.get("id")===e);this.sourceFeatures.removeFeature(t[0])}}return s.\u0275fac=function(e){return new(e||s)(p.Y36(jt.S),p.Y36(Jt.L),p.Y36(de.gz),p.Y36(Qt.Dx))},s.\u0275cmp=p.Xpm({type:s,selectors:[["app-map-view"]],decls:15,vars:3,consts:[[1,"d-flex","flex-row","justify-content-between","mx-4"],["id","geomSelector",1,"d-flex","flex-row"],["type","button",1,"button-title","btn","btn-warning","rounded-start","p-2"],[1,"fw-bold"],["role","group","aria-label","",1,"btn-group-vertical","my-2","align-self-center"],[4,"ngFor","ngForOf"],[1,"d-flex","flex-row","w-50","overflow-auto","overflow-overlay"],["class","d-flex flex-column m-2",4,"ngFor","ngForOf"],["id","geomExport",1,"d-flex","flex-row"],["type","button",1,"button-title","btn","btn-dark","rounded-start","p-2"],["type","radio","name","btnradio","autocomplete","off",1,"border","btn-check","m-0",3,"id","checked"],[1,"w-100","btn","border-warning","btn-outline-warning","p-0",3,"for","click"],[1,"dropdown-item",3,"icon"],[1,"d-flex","flex-column","m-2"],["class","",4,"ngFor","ngForOf"],[1,""],[1,"d-flex","flex-row","align-items-center"],["class","p-0","class","dropdown-item",3,"icon",4,"ngIf"],[3,"click"],[1,"w-100","btn","border-dark","btn-outline-dark","p-0",3,"for"],[1,"dropdown-item",3,"icon","ngClass"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0)(1,"div",1)(2,"button",2)(3,"span",3),p._uU(4,"EDITER"),p.qZA()(),p.TgZ(5,"div",4),p.YNc(6,$t,5,5,"ng-container",5),p.qZA()(),p.TgZ(7,"div",6),p.YNc(8,ni,2,1,"div",7),p.qZA(),p.TgZ(9,"div",8)(10,"button",9)(11,"span",3),p._uU(12,"EXPORT"),p.qZA()(),p.TgZ(13,"div",4),p.YNc(14,oi,5,6,"ng-container",5),p.qZA()()()),2&e&&(p.xp6(6),p.Q6J("ngForOf",t.geomTypesSupported),p.xp6(2),p.Q6J("ngForOf",t.allFeatures),p.xp6(6),p.Q6J("ngForOf",t.geomTypesSupported))},directives:[W.sg,be.BN,W.O5,W.mk],styles:[".button-title[_ngcontent-%COMP%]{border-radius:unset}.button-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{writing-mode:vertical-rl;text-orientation:upright}"]}),s})(),data:{title:"Bac \xe0 sable",page:"map-sandbox"},outlet:"map-sandbox"}];let ai=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=p.oAB({type:s}),s.\u0275inj=p.cJS({imports:[[de.Bz.forChild(si)],de.Bz]}),s})(),li=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=p.oAB({type:s}),s.\u0275inj=p.cJS({imports:[[W.ez,ai,be.uH,ht]]}),s})()}}]);
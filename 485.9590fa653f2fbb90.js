"use strict";(self.webpackChunkportfolio=self.webpackChunkportfolio||[]).push([[485],{5485:(Hn,qe,f)=>{f.r(qe),f.d(qe,{MapSandboxModule:()=>Vn});var M=f(9808),U=f(2382),q=f(9444),Pe=f(9560),v=f(801),r=f(5e3),Fe=f(9947),Ft=f(3686),Et=f(2313),B=f(7579);let ae=(()=>{class a{constructor(){this.layerIdSelected=new B.x,this.layerObjectSelected=new B.x,this.selectableLayerId=new B.x,this.selectableAllLayers=new B.x,this.editBarActivation=new B.x,this.removeLayers=new B.x,this.selectingLayerStatus=new B.x}activateEditBar(e){this.editBarActivation.next(e)}removeAllLayers(){this.removeLayers.next(!0)}setSelectingLayers(e){this.selectingLayerStatus.next(e)}setSelectableLayer(e){this.selectableLayerId.next(e)}setSelectableAllLayers(){this.selectableAllLayers.next(!0)}sendSelectedLayerId(e){this.layerIdSelected.next(e)}sendSelectedLayer(e){this.layerObjectSelected.next(e)}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275prov=r.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var a,St=f(6422),Ye=f(9851),m=f(1274),O=f(1729),It=(a=function(n,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])})(n,e)},function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}a(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}),Ee="projection",We="coordinateFormat",Mt=function(a){function n(e){var t=this,i=e||{},o=document.createElement("div");o.className=void 0!==i.className?i.className:"ol-mouse-position",(t=a.call(this,{element:o,render:i.render,target:i.target})||this).addChangeListener(Ee,t.handleProjectionChanged_),i.coordinateFormat&&t.setCoordinateFormat(i.coordinateFormat),i.projection&&t.setProjection(i.projection);var s=!0,l="&#160;";return"undefinedHTML"in i?(void 0!==i.undefinedHTML&&(l=i.undefinedHTML),s=!!l):"placeholder"in i&&(!1===i.placeholder?s=!1:l=String(i.placeholder)),t.placeholder_=l,t.renderOnMouseOut_=s,t.renderedHTML_=o.innerHTML,t.mapProjection_=null,t.transform_=null,t}return It(n,a),n.prototype.handleProjectionChanged_=function(){this.transform_=null},n.prototype.getCoordinateFormat=function(){return this.get(We)},n.prototype.getProjection=function(){return this.get(Ee)},n.prototype.handleMouseMove=function(e){var t=this.getMap();this.updateHTML_(t.getEventPixel(e))},n.prototype.handleMouseOut=function(e){this.updateHTML_(null)},n.prototype.setMap=function(e){if(a.prototype.setMap.call(this,e),e){var t=e.getViewport();this.listenerKeys.push((0,O.oL)(t,Ye.Z.POINTERMOVE,this.handleMouseMove,this)),this.renderOnMouseOut_&&this.listenerKeys.push((0,O.oL)(t,Ye.Z.POINTEROUT,this.handleMouseOut,this)),this.updateHTML_(null)}},n.prototype.setCoordinateFormat=function(e){this.set(We,e)},n.prototype.setProjection=function(e){this.set(Ee,(0,m.U2)(e))},n.prototype.updateHTML_=function(e){var t=this.placeholder_;if(e&&this.mapProjection_){if(!this.transform_){var i=this.getProjection();this.transform_=i?(0,m.WO)(this.mapProjection_,i):m.gD}var s=this.getMap().getCoordinateFromPixelInternal(e);if(s){var l=(0,m.Cs)();l&&(this.transform_=(0,m.WO)(this.mapProjection_,l)),this.transform_(s,s);var u=this.getCoordinateFormat();t=u?u(s):s.toString()}}(!this.renderedHTML_||t!==this.renderedHTML_)&&(this.element.innerHTML=t,this.renderedHTML_=t)},n.prototype.render=function(e){var t=e.frameState;t?this.mapProjection_!=t.viewState.projection&&(this.mapProjection_=t.viewState.projection,this.transform_=null):this.mapProjection_=null},n}(St.Z);const kt=Mt;var P=f(3481);function Ot(a,n){if(1&a){const e=r.EpF();r.ynx(0),r._UZ(1,"input",13),r.TgZ(2,"label",14),r.NdJ("click",function(){const o=r.CHM(e).$implicit;return r.oxw().setProjection(o)}),r.TgZ(3,"div",15)(4,"span"),r._uU(5),r.qZA()()(),r.BQk()}if(2&a){const e=n.$implicit,t=n.index,i=r.oxw();r.xp6(1),r.Q6J("id","btnradio-selector-"+t)("checked",i.currentEpsg===e),r.xp6(1),r.Q6J("for","btnradio-selector-"+t),r.xp6(1),r.Q6J("ngClass",i.currentEpsg===e?"bg-info text-white ":""),r.xp6(2),r.Oqu(e)}}let Zt=(()=>{class a{constructor(e){this.mapService=e}ngOnInit(){}ngAfterViewInit(){this.initMousePosition()}ngOnDestroy(){}initMousePosition(){let e;e=document.getElementById("mouseCoordinates"),this.mousePositionControl=new kt({coordinateFormat:this.setPrecisionFunc(4),placeholder:"x :<br>y : ",className:"mouse-position",target:e}),this.map.addControl(this.mousePositionControl)}updatePrecision(e){return this.mousePositionControl.setCoordinateFormat(this.setPrecisionFunc(e.target.value))}setPrecisionFunc(e){return function(i){return(0,P.WU)(i,"x : {x}<br>y : {y}",e)}}setMapEpsg(){this.currentEpsg=this.map.getView().getProjection().getCode()}setProjection(e){this.currentEpsg=e,this.mapService.setProjectionOnMap(e),this.setMapEpsg()}}return a.\u0275fac=function(e){return new(e||a)(r.Y36(Fe.S))},a.\u0275cmp=r.Xpm({type:a,selectors:[["app-geoinfo"]],inputs:{currentEpsg:"currentEpsg",map:"map",epsgAvailable:"epsgAvailable"},decls:17,vars:1,consts:[[1,"d-flex","flex-row","align-items-center","justify-content-center","bg-info","text-white","p-2","px-3"],[1,"fw-bold"],["id","infosContainer",1,"d-flex","flex-column","mx-3"],[1,"d-flex","flex-row","my-1","justify-content-evenly"],[1,"d-flex","flex-column"],["id","epsgList",1,"btn-group-vertical","my-2","align-self-center","bg-white","rounded-3","border"],[4,"ngFor","ngForOf"],[1,"d-flex","flex-column","align-items-center","justify-content-center","small","mx-2"],[1,"d-flex","flex-column","align-items-center","justify-content-center","small"],[1,"fw-bold","m-2"],["id","precision","type","number","min","0","max","12","value","4",1,"small",3,"change"],[1,"d-flex","flex-column","align-items-center","align-self-center","justify-content-center","small","mb-3"],["id","mouseCoordinates"],["type","radio","name","btnRadio","autocomplete","off",1,"border","btn-check","mx-1",3,"id","checked"],[1,"pointer",3,"for","click"],[1,"dropdown-item","small","d-flex","flex-row",3,"ngClass"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0)(1,"span",1),r._uU(2,"Informations"),r.qZA()(),r.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5),r.YNc(7,Ot,6,5,"ng-container",6),r.qZA()(),r.TgZ(8,"div",7)(9,"div",8)(10,"span",9),r._uU(11,"Pr\xe9cision"),r.qZA(),r.TgZ(12,"input",10),r.NdJ("change",function(o){return t.updatePrecision(o)}),r.qZA()()()(),r.TgZ(13,"div",11)(14,"span",1),r._uU(15,"Coordonn\xe9es"),r.qZA(),r._UZ(16,"span",12),r.qZA()()),2&e&&(r.xp6(7),r.Q6J("ngForOf",t.epsgAvailable))},directives:[M.sg,M.mk],styles:[".pointer[_ngcontent-%COMP%]{cursor:pointer}"]}),a})();var A=f(3171),$=f(9972),At=f(7660),T=f(760),Gt=function(){var a=function(n,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}a(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}(),Nt=function(a){function n(e){var t=a.call(this)||this;return t.geometries_=e||null,t.changeEventsKeys_=[],t.listenGeometriesChange_(),t}return Gt(n,a),n.prototype.unlistenGeometriesChange_=function(){this.changeEventsKeys_.forEach(O.bN),this.changeEventsKeys_.length=0},n.prototype.listenGeometriesChange_=function(){if(this.geometries_)for(var e=0,t=this.geometries_.length;e<t;++e)this.changeEventsKeys_.push((0,O.oL)(this.geometries_[e],$.Z.CHANGE,this.changed,this))},n.prototype.clone=function(){var e=new n(null);return e.setGeometries(this.geometries_),e.applyProperties(this),e},n.prototype.closestPointXY=function(e,t,i,o){if(o<(0,T.qf)(this.getExtent(),e,t))return o;for(var s=this.geometries_,l=0,u=s.length;l<u;++l)o=s[l].closestPointXY(e,t,i,o);return o},n.prototype.containsXY=function(e,t){for(var i=this.geometries_,o=0,s=i.length;o<s;++o)if(i[o].containsXY(e,t))return!0;return!1},n.prototype.computeExtent=function(e){(0,T.YN)(e);for(var t=this.geometries_,i=0,o=t.length;i<o;++i)(0,T.l7)(e,t[i].getExtent());return e},n.prototype.getGeometries=function(){return Xe(this.geometries_)},n.prototype.getGeometriesArray=function(){return this.geometries_},n.prototype.getGeometriesArrayRecursive=function(){for(var e=[],t=this.geometries_,i=0,o=t.length;i<o;++i)t[i].getType()===this.getType()?e=e.concat(t[i].getGeometriesArrayRecursive()):e.push(t[i]);return e},n.prototype.getSimplifiedGeometry=function(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var t=[],i=this.geometries_,o=!1,s=0,l=i.length;s<l;++s){var u=i[s],c=u.getSimplifiedGeometry(e);t.push(c),c!==u&&(o=!0)}if(o){var d=new n(null);return d.setGeometriesArray(t),d}return this.simplifiedGeometryMaxMinSquaredTolerance=e,this},n.prototype.getType=function(){return"GeometryCollection"},n.prototype.intersectsExtent=function(e){for(var t=this.geometries_,i=0,o=t.length;i<o;++i)if(t[i].intersectsExtent(e))return!0;return!1},n.prototype.isEmpty=function(){return 0===this.geometries_.length},n.prototype.rotate=function(e,t){for(var i=this.geometries_,o=0,s=i.length;o<s;++o)i[o].rotate(e,t);this.changed()},n.prototype.scale=function(e,t,i){var o=i;o||(o=(0,T.qg)(this.getExtent()));for(var s=this.geometries_,l=0,u=s.length;l<u;++l)s[l].scale(e,t,o);this.changed()},n.prototype.setGeometries=function(e){this.setGeometriesArray(Xe(e))},n.prototype.setGeometriesArray=function(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()},n.prototype.applyTransform=function(e){for(var t=this.geometries_,i=0,o=t.length;i<o;++i)t[i].applyTransform(e);this.changed()},n.prototype.translate=function(e,t){for(var i=this.geometries_,o=0,s=i.length;o<s;++o)i[o].translate(e,t);this.changed()},n.prototype.disposeInternal=function(){this.unlistenGeometriesChange_(),a.prototype.disposeInternal.call(this)},n}(At.Z);function Xe(a){for(var n=[],e=0,t=a.length;e<t;++e)n.push(a[e].clone());return n}const se=Nt;var Rt=f(9849),b=f(119),le=f(9466),Dt=function(){function a(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.supportedMediaTypes=null}return a.prototype.getReadOptions=function(n,e){var t;if(e){var i=e.dataProjection?(0,m.U2)(e.dataProjection):this.readProjection(n);e.extent&&i&&i.getUnits()===Rt.ZP.TILE_PIXELS&&(i=(0,m.U2)(i)).setWorldExtent(e.extent),t={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(t)},a.prototype.adaptOptions=function(n){return(0,le.f0)({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},n)},a.prototype.getType=function(){return(0,b.O3)()},a.prototype.readFeature=function(n,e){return(0,b.O3)()},a.prototype.readFeatures=function(n,e){return(0,b.O3)()},a.prototype.readGeometry=function(n,e){return(0,b.O3)()},a.prototype.readProjection=function(n){return(0,b.O3)()},a.prototype.writeFeature=function(n,e){return(0,b.O3)()},a.prototype.writeFeatures=function(n,e){return(0,b.O3)()},a.prototype.writeGeometry=function(n,e){return(0,b.O3)()},a}();const ze=Dt;function ue(a,n,e){var o,t=e?(0,m.U2)(e.featureProjection):null,i=e?(0,m.U2)(e.dataProjection):null;if(o=t&&i&&!(0,m.OP)(t,i)?(n?a.clone():a).transform(n?t:i,n?i:t):a,n&&e&&void 0!==e.decimals){var s=Math.pow(10,e.decimals);o===a&&(o=a.clone()),o.applyTransform(function(u){for(var c=0,d=u.length;c<d;++c)u[c]=Math.round(u[c]*s)/s;return u})}return o}var Jt=function(){var a=function(n,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}a(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}(),jt=function(a){function n(){return a.call(this)||this}return Jt(n,a),n.prototype.getType=function(){return"json"},n.prototype.readFeature=function(e,t){return this.readFeatureFromObject(ce(e),this.getReadOptions(e,t))},n.prototype.readFeatures=function(e,t){return this.readFeaturesFromObject(ce(e),this.getReadOptions(e,t))},n.prototype.readFeatureFromObject=function(e,t){return(0,b.O3)()},n.prototype.readFeaturesFromObject=function(e,t){return(0,b.O3)()},n.prototype.readGeometry=function(e,t){return this.readGeometryFromObject(ce(e),this.getReadOptions(e,t))},n.prototype.readGeometryFromObject=function(e,t){return(0,b.O3)()},n.prototype.readProjection=function(e){return this.readProjectionFromObject(ce(e))},n.prototype.readProjectionFromObject=function(e){return(0,b.O3)()},n.prototype.writeFeature=function(e,t){return JSON.stringify(this.writeFeatureObject(e,t))},n.prototype.writeFeatureObject=function(e,t){return(0,b.O3)()},n.prototype.writeFeatures=function(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))},n.prototype.writeFeaturesObject=function(e,t){return(0,b.O3)()},n.prototype.writeGeometry=function(e,t){return JSON.stringify(this.writeGeometryObject(e,t))},n.prototype.writeGeometryObject=function(e,t){return(0,b.O3)()},n}(ze);function ce(a){return"string"==typeof a?JSON.parse(a)||null:null!==a?a:null}const Ut=jt;var D=f(6527),S=f(4720),Y=f(2774),de=f(5066),he=f(8999),Ke=f(9182),G=f(2456),Se=f(392),$e=f(410),et=f(9644),Bt=function(){var a=function(n,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}a(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}(),Vt=function(a){function n(e,t,i){var o=a.call(this)||this;if(o.ends_=[],o.maxDelta_=-1,o.maxDeltaRevision_=-1,Array.isArray(e[0]))o.setCoordinates(e,t);else if(void 0!==t&&i)o.setFlatCoordinates(t,e),o.ends_=i;else{for(var s=o.getLayout(),l=e,u=[],c=[],d=0,h=l.length;d<h;++d){var _=l[d];0===d&&(s=_.getLayout()),(0,G.l7)(u,_.getFlatCoordinates()),c.push(u.length)}o.setFlatCoordinates(s,u),o.ends_=c}return o}return Bt(n,a),n.prototype.appendLineString=function(e){this.flatCoordinates?(0,G.l7)(this.flatCoordinates,e.getFlatCoordinates().slice()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},n.prototype.clone=function(){var e=new n(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e},n.prototype.closestPointXY=function(e,t,i,o){return o<(0,T.qf)(this.getExtent(),e,t)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,de.Af)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,de.Xl)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,i,o))},n.prototype.getCoordinateAtM=function(e,t,i){return this.layout!=S.Z.XYM&&this.layout!=S.Z.XYZM||0===this.flatCoordinates.length?null:(0,$e.dG)(this.flatCoordinates,0,this.ends_,this.stride,e,void 0!==t&&t,void 0!==i&&i)},n.prototype.getCoordinates=function(){return(0,Se.o1)(this.flatCoordinates,0,this.ends_,this.stride)},n.prototype.getEnds=function(){return this.ends_},n.prototype.getLineString=function(e){return e<0||this.ends_.length<=e?null:new D.Z(this.flatCoordinates.slice(0===e?0:this.ends_[e-1],this.ends_[e]),this.layout)},n.prototype.getLineStrings=function(){for(var e=this.flatCoordinates,t=this.ends_,i=this.layout,o=[],s=0,l=0,u=t.length;l<u;++l){var c=t[l],d=new D.Z(e.slice(s,c),i);o.push(d),s=c}return o},n.prototype.getFlatMidpoints=function(){for(var e=[],t=this.flatCoordinates,i=0,o=this.ends_,s=this.stride,l=0,u=o.length;l<u;++l){var c=o[l],d=(0,$e.WW)(t,i,c,s,.5);(0,G.l7)(e,d),i=c}return e},n.prototype.getSimplifiedGeometryInternal=function(e){var t=[],i=[];return t.length=(0,Ke.UJ)(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,i),new n(t,S.Z.XY,i)},n.prototype.getType=function(){return"MultiLineString"},n.prototype.intersectsExtent=function(e){return(0,et.AW)(this.flatCoordinates,0,this.ends_,this.stride,e)},n.prototype.setCoordinates=function(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=(0,he._5)(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},n}(Y.ZP);const Ie=Vt;var J=f(187),Ht=f(2156),Qt=function(){var a=function(n,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}a(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}(),qt=function(a){function n(e,t){var i=a.call(this)||this;return t&&!Array.isArray(e[0])?i.setFlatCoordinates(t,e):i.setCoordinates(e,t),i}return Qt(n,a),n.prototype.appendPoint=function(e){this.flatCoordinates?(0,G.l7)(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.changed()},n.prototype.clone=function(){var e=new n(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e},n.prototype.closestPointXY=function(e,t,i,o){if(o<(0,T.qf)(this.getExtent(),e,t))return o;for(var s=this.flatCoordinates,l=this.stride,u=0,c=s.length;u<c;u+=l){var d=(0,Ht.bI)(e,t,s[u],s[u+1]);if(d<o){o=d;for(var h=0;h<l;++h)i[h]=s[u+h];i.length=l}}return o},n.prototype.getCoordinates=function(){return(0,Se.Ml)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},n.prototype.getPoint=function(e){return e<0||(this.flatCoordinates?this.flatCoordinates.length/this.stride:0)<=e?null:new J.Z(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)},n.prototype.getPoints=function(){for(var e=this.flatCoordinates,t=this.layout,i=this.stride,o=[],s=0,l=e.length;s<l;s+=i){var u=new J.Z(e.slice(s,s+i),t);o.push(u)}return o},n.prototype.getType=function(){return"MultiPoint"},n.prototype.intersectsExtent=function(e){for(var t=this.flatCoordinates,i=this.stride,o=0,s=t.length;o<s;o+=i)if((0,T.jE)(e,t[o],t[o+1]))return!0;return!1},n.prototype.setCoordinates=function(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,he.Sg)(this.flatCoordinates,0,e,this.stride),this.changed()},n}(Y.ZP);const fe=qt;var N=f(2275),Yt=f(2474),Me=f(1265),Wt=f(8818),zt=f(4325),Kt=function(){var a=function(n,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}a(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}(),$t=function(a){function n(e,t,i){var o=a.call(this)||this;if(o.endss_=[],o.flatInteriorPointsRevision_=-1,o.flatInteriorPoints_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,!i&&!Array.isArray(e[0])){for(var s=o.getLayout(),l=e,u=[],c=[],d=0,h=l.length;d<h;++d){var _=l[d];0===d&&(s=_.getLayout());for(var p=u.length,y=_.getEnds(),g=0,x=y.length;g<x;++g)y[g]+=p;(0,G.l7)(u,_.getFlatCoordinates()),c.push(y)}t=s,e=u,i=c}return void 0!==t&&i?(o.setFlatCoordinates(t,e),o.endss_=i):o.setCoordinates(e,t),o}return Kt(n,a),n.prototype.appendPolygon=function(e){var t;if(this.flatCoordinates){var i=this.flatCoordinates.length;(0,G.l7)(this.flatCoordinates,e.getFlatCoordinates());for(var o=0,s=(t=e.getEnds().slice()).length;o<s;++o)t[o]+=i}else this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();this.endss_.push(t),this.changed()},n.prototype.clone=function(){for(var e=this.endss_.length,t=new Array(e),i=0;i<e;++i)t[i]=this.endss_[i].slice();var o=new n(this.flatCoordinates.slice(),this.layout,t);return o.applyProperties(this),o},n.prototype.closestPointXY=function(e,t,i,o){return o<(0,T.qf)(this.getExtent(),e,t)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,de.sD)(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,de.gI)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,i,o))},n.prototype.containsXY=function(e,t){return(0,zt.Zl)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)},n.prototype.getArea=function(){return(0,Wt.Eu)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},n.prototype.getCoordinates=function(e){var t;return void 0!==e?(t=this.getOrientedFlatCoordinates().slice(),(0,Me.dL)(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,(0,Se.ug)(t,0,this.endss_,this.stride)},n.prototype.getEndss=function(){return this.endss_},n.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var e=function Xt(a,n,e,t){for(var i=[],o=(0,T.lJ)(),s=0,l=e.length;s<l;++s){var u=e[s];o=(0,T.GN)(a,n,u[0],t),i.push((o[0]+o[2])/2,(o[1]+o[3])/2),n=u[u.length-1]}return i}(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=(0,Yt.U)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},n.prototype.getInteriorPoints=function(){return new fe(this.getFlatInteriorPoints().slice(),S.Z.XYM)},n.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var e=this.flatCoordinates;(0,Me.Oj)(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=(0,Me.dL)(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},n.prototype.getSimplifiedGeometryInternal=function(e){var t=[],i=[];return t.length=(0,Ke.Pp)(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,i),new n(t,S.Z.XY,i)},n.prototype.getPolygon=function(e){if(e<0||this.endss_.length<=e)return null;var t;if(0===e)t=0;else{var i=this.endss_[e-1];t=i[i.length-1]}var o=this.endss_[e].slice(),s=o[o.length-1];if(0!==t)for(var l=0,u=o.length;l<u;++l)o[l]-=t;return new N.ZP(this.flatCoordinates.slice(t,s),this.layout,o)},n.prototype.getPolygons=function(){for(var e=this.layout,t=this.flatCoordinates,i=this.endss_,o=[],s=0,l=0,u=i.length;l<u;++l){var c=i[l].slice(),d=c[c.length-1];if(0!==s)for(var h=0,_=c.length;h<_;++h)c[h]-=s;var p=new N.ZP(t.slice(s,d),e,c);o.push(p),s=d}return o},n.prototype.getType=function(){return"MultiPolygon"},n.prototype.intersectsExtent=function(e){return(0,et.oW)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)},n.prototype.setCoordinates=function(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);var i=(0,he.QT)(this.flatCoordinates,0,e,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{var o=i[i.length-1];this.flatCoordinates.length=0===o.length?0:o[o.length-1]}this.changed()},n}(Y.ZP);const ke=$t;var er=f(1911),tr=function(){var a=function(n,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}a(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}(),rr=function(a){function n(e){var t=this,i=e||{};return(t=a.call(this)||this).dataProjection=(0,m.U2)(i.dataProjection?i.dataProjection:"EPSG:4326"),i.featureProjection&&(t.defaultFeatureProjection=(0,m.U2)(i.featureProjection)),t.geometryName_=i.geometryName,t.extractGeometryName_=i.extractGeometryName,t.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"],t}return tr(n,a),n.prototype.readFeatureFromObject=function(e,t){var i,o=Oe((i="Feature"===e.type?e:{type:"Feature",geometry:e,properties:null}).geometry,t),s=new A.Z;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in i!==void 0&&s.setGeometryName(i.geometry_name),s.setGeometry(o),"id"in i&&s.setId(i.id),i.properties&&s.setProperties(i.properties,!0),s},n.prototype.readFeaturesFromObject=function(e,t){var o=null;if("FeatureCollection"===e.type){o=[];for(var l=e.features,u=0,c=l.length;u<c;++u)o.push(this.readFeatureFromObject(l[u],t))}else o=[this.readFeatureFromObject(e,t)];return o},n.prototype.readGeometryFromObject=function(e,t){return Oe(e,t)},n.prototype.readProjectionFromObject=function(e){var i,t=e.crs;return t?"name"==t.type?i=(0,m.U2)(t.properties.name):"EPSG"===t.type?i=(0,m.U2)("EPSG:"+t.properties.code):(0,er.h)(!1,36):i=this.dataProjection,i},n.prototype.writeFeatureObject=function(e,t){t=this.adaptOptions(t);var i={type:"Feature",geometry:null,properties:null},o=e.getId();if(void 0!==o&&(i.id=o),!e.hasProperties())return i;var s=e.getProperties(),l=e.getGeometry();return l&&(i.geometry=Ze(l,t),delete s[e.getGeometryName()]),(0,le.xb)(s)||(i.properties=s),i},n.prototype.writeFeaturesObject=function(e,t){t=this.adaptOptions(t);for(var i=[],o=0,s=e.length;o<s;++o)i.push(this.writeFeatureObject(e[o],t));return{type:"FeatureCollection",features:i}},n.prototype.writeGeometryObject=function(e,t){return Ze(e,this.adaptOptions(t))},n}(Ut);function Oe(a,n){if(!a)return null;var e;switch(a.type){case"Point":e=function ir(a){return new J.Z(a.coordinates)}(a);break;case"LineString":e=function or(a){return new D.Z(a.coordinates)}(a);break;case"Polygon":e=function ur(a){return new N.ZP(a.coordinates)}(a);break;case"MultiPoint":e=function sr(a){return new fe(a.coordinates)}(a);break;case"MultiLineString":e=function ar(a){return new Ie(a.coordinates)}(a);break;case"MultiPolygon":e=function lr(a){return new ke(a.coordinates)}(a);break;case"GeometryCollection":e=function nr(a,n){var e=a.geometries.map(function(t){return Oe(t,n)});return new se(e)}(a);break;default:throw new Error("Unsupported GeoJSON type: "+a.type)}return ue(e,!1,n)}function Ze(a,n){var t,e=(a=ue(a,!0,n)).getType();switch(e){case"Point":t=function gr(a,n){return{type:"Point",coordinates:a.getCoordinates()}}(a);break;case"LineString":t=function dr(a,n){return{type:"LineString",coordinates:a.getCoordinates()}}(a);break;case"Polygon":t=function yr(a,n){var e;return n&&(e=n.rightHanded),{type:"Polygon",coordinates:a.getCoordinates(e)}}(a,n);break;case"MultiPoint":t=function fr(a,n){return{type:"MultiPoint",coordinates:a.getCoordinates()}}(a);break;case"MultiLineString":t=function hr(a,n){return{type:"MultiLineString",coordinates:a.getCoordinates()}}(a);break;case"MultiPolygon":t=function pr(a,n){var e;return n&&(e=n.rightHanded),{type:"MultiPolygon",coordinates:a.getCoordinates(e)}}(a,n);break;case"GeometryCollection":t=function cr(a,n){var e=a.getGeometriesArray().map(function(t){var i=(0,le.f0)({},n);return delete i.featureProjection,Ze(t,i)});return{type:"GeometryCollection",geometries:e}}(a,n);break;case"Circle":t={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+e)}return t}const tt=rr;var pe,_r=new Uint8Array(16);function mr(){if(!pe&&!(pe="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return pe(_r)}const vr=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,xr=function Cr(a){return"string"==typeof a&&vr.test(a)};for(var F=[],Ae=0;Ae<256;++Ae)F.push((Ae+256).toString(16).substr(1));const rt=function wr(a,n,e){var t=(a=a||{}).random||(a.rng||mr)();if(t[6]=15&t[6]|64,t[8]=63&t[8]|128,n){e=e||0;for(var i=0;i<16;++i)n[e+i]=t[i];return n}return function Tr(a){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=(F[a[n+0]]+F[a[n+1]]+F[a[n+2]]+F[a[n+3]]+"-"+F[a[n+4]]+F[a[n+5]]+"-"+F[a[n+6]]+F[a[n+7]]+"-"+F[a[n+8]]+F[a[n+9]]+"-"+F[a[n+10]]+F[a[n+11]]+F[a[n+12]]+F[a[n+13]]+F[a[n+14]]+F[a[n+15]]).toLowerCase();if(!xr(e))throw TypeError("Stringified UUID is invalid");return e}(t)};var ge=f(9889),ye=f(5002),nt=f(2909),_e=f(4412),W=f(1345),Lr=function(){var a=function(n,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}a(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}();function it(a){return a.feature?a.feature:a.element?a.element:void 0}var Ge=[],Pr=function(a){function n(e){var t=this,i=e||{},o=i;return o.handleDownEvent||(o.handleDownEvent=W.uX),o.stopDown||(o.stopDown=W.Dv),(t=a.call(this,o)||this).source_=i.source?i.source:null,t.vertex_=void 0===i.vertex||i.vertex,t.edge_=void 0===i.edge||i.edge,t.features_=i.features?i.features:null,t.featuresListenerKeys_=[],t.featureChangeListenerKeys_={},t.indexedFeaturesExtents_={},t.pendingFeatures_={},t.pixelTolerance_=void 0!==i.pixelTolerance?i.pixelTolerance:10,t.rBush_=new nt.Z,t.GEOMETRY_SEGMENTERS_={Point:t.segmentPointGeometry_.bind(t),LineString:t.segmentLineStringGeometry_.bind(t),LinearRing:t.segmentLineStringGeometry_.bind(t),Polygon:t.segmentPolygonGeometry_.bind(t),MultiPoint:t.segmentMultiPointGeometry_.bind(t),MultiLineString:t.segmentMultiLineStringGeometry_.bind(t),MultiPolygon:t.segmentMultiPolygonGeometry_.bind(t),GeometryCollection:t.segmentGeometryCollectionGeometry_.bind(t),Circle:t.segmentCircleGeometry_.bind(t)},t}return Lr(n,a),n.prototype.addFeature=function(e,t){var i=void 0===t||t,o=(0,b.sq)(e),s=e.getGeometry();if(s){var l=this.GEOMETRY_SEGMENTERS_[s.getType()];if(l){this.indexedFeaturesExtents_[o]=s.getExtent((0,T.lJ)());var u=[];if(l(u,s),1===u.length)this.rBush_.insert((0,T.hI)(u[0]),{feature:e,segment:u[0]});else if(u.length>1){var c=u.map(function(h){return(0,T.hI)(h)}),d=u.map(function(h){return{feature:e,segment:h}});this.rBush_.load(c,d)}}}i&&(this.featureChangeListenerKeys_[o]=(0,O.oL)(e,$.Z.CHANGE,this.handleFeatureChange_,this))},n.prototype.forEachFeatureAdd_=function(e){this.addFeature(e)},n.prototype.forEachFeatureRemove_=function(e){this.removeFeature(e)},n.prototype.getFeatures_=function(){var e;return this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures()),e},n.prototype.handleEvent=function(e){var t=this.snapTo(e.pixel,e.coordinate,e.map);return t&&(e.coordinate=t.vertex.slice(0,2),e.pixel=t.vertexPixel),a.prototype.handleEvent.call(this,e)},n.prototype.handleFeatureAdd_=function(e){var t=it(e);this.addFeature(t)},n.prototype.handleFeatureRemove_=function(e){var t=it(e);this.removeFeature(t)},n.prototype.handleFeatureChange_=function(e){var t=e.target;if(this.handlingDownUpSequence){var i=(0,b.sq)(t);i in this.pendingFeatures_||(this.pendingFeatures_[i]=t)}else this.updateFeature_(t)},n.prototype.handleUpEvent=function(e){var t=(0,le.KX)(this.pendingFeatures_);return t.length&&(t.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1},n.prototype.removeFeature=function(e,t){var i=void 0===t||t,o=(0,b.sq)(e),s=this.indexedFeaturesExtents_[o];if(s){var l=this.rBush_,u=[];l.forEachInExtent(s,function(d){e===d.feature&&u.push(d)});for(var c=u.length-1;c>=0;--c)l.remove(u[c])}i&&((0,O.bN)(this.featureChangeListenerKeys_[o]),delete this.featureChangeListenerKeys_[o])},n.prototype.setMap=function(e){var t=this.getMap(),i=this.featuresListenerKeys_,o=this.getFeatures_();t&&(i.forEach(O.bN),i.length=0,o.forEach(this.forEachFeatureRemove_.bind(this))),a.prototype.setMap.call(this,e),e&&(this.features_?i.push((0,O.oL)(this.features_,ge.Z.ADD,this.handleFeatureAdd_,this),(0,O.oL)(this.features_,ge.Z.REMOVE,this.handleFeatureRemove_,this)):this.source_&&i.push((0,O.oL)(this.source_,_e.Z.ADDFEATURE,this.handleFeatureAdd_,this),(0,O.oL)(this.source_,_e.Z.REMOVEFEATURE,this.handleFeatureRemove_,this)),o.forEach(this.forEachFeatureAdd_.bind(this)))},n.prototype.snapTo=function(e,t,i){var o=i.getCoordinateFromPixel([e[0]-this.pixelTolerance_,e[1]+this.pixelTolerance_]),s=i.getCoordinateFromPixel([e[0]+this.pixelTolerance_,e[1]-this.pixelTolerance_]),l=(0,T.hI)([o,s]),u=this.rBush_.getInExtent(l),c=u.length;if(0===c)return null;var _,d=i.getView().getProjection(),h=(0,m.Vs)(t,d),p=1/0,y=this.pixelTolerance_*this.pixelTolerance_,g=function(){if(_){var Z=i.getPixelFromCoordinate(_);if((0,P.bI)(e,Z)<=y)return{vertex:_,vertexPixel:[Math.round(Z[0]),Math.round(Z[1])]}}return null};if(this.vertex_){for(var x=0;x<c;++x)"Circle"!==(L=u[x]).feature.getGeometry().getType()&&L.segment.forEach(function(Z){var oe=(0,m.Vs)(Z,d),j=(0,P.bI)(h,oe);j<p&&(_=Z,p=j)});if(E=g())return E}if(this.edge_){for(x=0;x<c;++x){var L,I=null;if("Circle"===(L=u[x]).feature.getGeometry().getType()){var H=L.feature.getGeometry(),be=(0,m.Cs)();be&&(H=H.clone().transform(be,d)),I=(0,m.lO)((0,P.Ed)(h,H),d)}else{var we=L.segment,ie=we[1];ie&&(Ge[0]=(0,m.Vs)(we[0],d),Ge[1]=(0,m.Vs)(ie,d),I=(0,P.oL)(h,Ge))}if(I){var z=(0,P.bI)(h,I);z<p&&(_=I,p=z)}}var E;if(E=g())return E}return null},n.prototype.updateFeature_=function(e){this.removeFeature(e,!1),this.addFeature(e,!1)},n.prototype.segmentCircleGeometry_=function(e,t){var i=this.getMap().getView().getProjection(),o=t,s=(0,m.Cs)();s&&(o=o.clone().transform(s,i));var l=(0,N.Bb)(o);s&&l.transform(i,s);for(var u=l.getCoordinates()[0],c=0,d=u.length-1;c<d;++c)e.push(u.slice(c,c+2))},n.prototype.segmentGeometryCollectionGeometry_=function(e,t){for(var i=t.getGeometriesArray(),o=0;o<i.length;++o){var s=this.GEOMETRY_SEGMENTERS_[i[o].getType()];s&&s(e,i[o])}},n.prototype.segmentLineStringGeometry_=function(e,t){for(var i=t.getCoordinates(),o=0,s=i.length-1;o<s;++o)e.push(i.slice(o,o+2))},n.prototype.segmentMultiLineStringGeometry_=function(e,t){for(var i=t.getCoordinates(),o=0,s=i.length;o<s;++o)for(var l=i[o],u=0,c=l.length-1;u<c;++u)e.push(l.slice(u,u+2))},n.prototype.segmentMultiPointGeometry_=function(e,t){t.getCoordinates().forEach(function(i){e.push([i])})},n.prototype.segmentMultiPolygonGeometry_=function(e,t){for(var i=t.getCoordinates(),o=0,s=i.length;o<s;++o)for(var l=i[o],u=0,c=l.length;u<c;++u)for(var d=l[u],h=0,_=d.length-1;h<_;++h)e.push(d.slice(h,h+2))},n.prototype.segmentPointGeometry_=function(e,t){e.push([t.getCoordinates()])},n.prototype.segmentPolygonGeometry_=function(e,t){for(var i=t.getCoordinates(),o=0,s=i.length;o<s;++o)for(var l=i[o],u=0,c=l.length-1;u<c;++u)e.push(l.slice(u,u+2))},n}(ye.Z);const Fr=Pr;var ee=f(2815),Ne=f(8214),ot=f(7366),R=f(8313),at=function(){var a=function(n,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}a(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}(),De=function(a){function n(e,t,i,o,s){var l=a.call(this,e)||this;return l.features=t,l.coordinate=i,l.startCoordinate=o,l.mapBrowserEvent=s,l}return at(n,a),n}(Ne.ZP),Er=function(a){function n(e){var o,t=this,i=e||{};if((t=a.call(this,i)||this).lastCoordinate_=null,t.startCoordinate_=null,t.features_=void 0!==i.features?i.features:null,i.layers&&!t.features_)if("function"==typeof i.layers)o=i.layers;else{var s=i.layers;o=function(l){return(0,G.q9)(s,l)}}else o=W.uX;return t.layerFilter_=o,t.filter_=i.filter&&!t.features_?i.filter:W.uX,t.hitTolerance_=i.hitTolerance?i.hitTolerance:0,t.condition_=i.condition?i.condition:R.Bx,t.lastFeature_=null,t.addChangeListener(ot.Z.ACTIVE,t.handleActiveChanged_),t}return at(n,a),n.prototype.handleDownEvent=function(e){if(!e.originalEvent||!this.condition_(e))return!1;if(this.lastFeature_=this.featuresAtPixel_(e.pixel,e.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=e.coordinate,this.lastCoordinate_=e.coordinate,this.handleMoveEvent(e);var t=this.features_||new ee.Z([this.lastFeature_]);return this.dispatchEvent(new De("translatestart",t,e.coordinate,this.startCoordinate_,e)),!0}return!1},n.prototype.handleUpEvent=function(e){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(e);var t=this.features_||new ee.Z([this.lastFeature_]);return this.dispatchEvent(new De("translateend",t,e.coordinate,this.startCoordinate_,e)),this.startCoordinate_=null,!0}return!1},n.prototype.handleDragEvent=function(e){if(this.lastCoordinate_){var t=e.coordinate,i=t[0]-this.lastCoordinate_[0],o=t[1]-this.lastCoordinate_[1],s=this.features_||new ee.Z([this.lastFeature_]);s.forEach(function(l){var u=l.getGeometry();u.translate(i,o),l.setGeometry(u)}),this.lastCoordinate_=t,this.dispatchEvent(new De("translating",s,t,this.startCoordinate_,e))}},n.prototype.handleMoveEvent=function(e){var t=e.map.getViewport();this.featuresAtPixel_(e.pixel,e.map)?(t.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),t.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):t.classList.remove("ol-grab","ol-grabbing")},n.prototype.featuresAtPixel_=function(e,t){return t.forEachFeatureAtPixel(e,function(i,o){if(this.filter_(i,o)&&(!this.features_||(0,G.q9)(this.features_.getArray(),i)))return i}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},n.prototype.getHitTolerance=function(){return this.hitTolerance_},n.prototype.setHitTolerance=function(e){this.hitTolerance_=e},n.prototype.setMap=function(e){var t=this.getMap();a.prototype.setMap.call(this,e),this.updateState_(t)},n.prototype.handleActiveChanged_=function(){this.updateState_(null)},n.prototype.updateState_=function(e){var t=this.getMap(),i=this.getActive();t&&i||!(t=t||e)||t.getViewport().classList.remove("ol-grab","ol-grabbing")},n}(ye.Z);const Sr=Er;var k=f(4624),Je=f(7053),te=f(5947),V=f(109),st=function(){var a=function(n,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}a(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}(),ut=[0,0,0,0],X=[],Ue=function(a){function n(e,t,i){var o=a.call(this,e)||this;return o.features=t,o.mapBrowserEvent=i,o}return st(n,a),n}(Ne.ZP),Ir=function(a){function n(e){var i,t=a.call(this,e)||this;if(t.boundHandleFeatureChange_=t.handleFeatureChange_.bind(t),t.condition_=e.condition?e.condition:R.Xp,t.defaultDeleteCondition_=function(o){return(0,R.Ko)(o)&&(0,R.Kf)(o)},t.deleteCondition_=e.deleteCondition?e.deleteCondition:t.defaultDeleteCondition_,t.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:R.Bx,t.vertexFeature_=null,t.vertexSegments_=null,t.lastPixel_=[0,0],t.ignoreNextSingleClick_=!1,t.featuresBeingModified_=null,t.rBush_=new nt.Z,t.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,t.snappedToVertex_=!1,t.changingFeature_=!1,t.dragSegments_=[],t.overlay_=new Je.Z({source:new te.Z({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:kr(),updateWhileAnimating:!0,updateWhileInteracting:!0}),t.SEGMENT_WRITERS_={Point:t.writePointGeometry_.bind(t),LineString:t.writeLineStringGeometry_.bind(t),LinearRing:t.writeLineStringGeometry_.bind(t),Polygon:t.writePolygonGeometry_.bind(t),MultiPoint:t.writeMultiPointGeometry_.bind(t),MultiLineString:t.writeMultiLineStringGeometry_.bind(t),MultiPolygon:t.writeMultiPolygonGeometry_.bind(t),Circle:t.writeCircleGeometry_.bind(t),GeometryCollection:t.writeGeometryCollectionGeometry_.bind(t)},t.source_=null,t.hitDetection_=null,e.features?i=e.features:e.source&&(t.source_=e.source,i=new ee.Z(t.source_.getFeatures()),t.source_.addEventListener(_e.Z.ADDFEATURE,t.handleSourceAdd_.bind(t)),t.source_.addEventListener(_e.Z.REMOVEFEATURE,t.handleSourceRemove_.bind(t))),!i)throw new Error("The modify interaction requires features, a source or a layer");return e.hitDetection&&(t.hitDetection_=e.hitDetection),t.features_=i,t.features_.forEach(t.addFeature_.bind(t)),t.features_.addEventListener(ge.Z.ADD,t.handleFeatureAdd_.bind(t)),t.features_.addEventListener(ge.Z.REMOVE,t.handleFeatureRemove_.bind(t)),t.lastPointerEvent_=null,t.delta_=[0,0],t.snapToPointer_=void 0===e.snapToPointer?!t.hitDetection_:e.snapToPointer,t}return st(n,a),n.prototype.addFeature_=function(e){var t=e.getGeometry();if(t){var i=this.SEGMENT_WRITERS_[t.getType()];i&&i(e,t)}var o=this.getMap();o&&o.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,o),e.addEventListener($.Z.CHANGE,this.boundHandleFeatureChange_)},n.prototype.willModifyFeatures_=function(e,t){if(!this.featuresBeingModified_){this.featuresBeingModified_=new ee.Z;for(var i=this.featuresBeingModified_.getArray(),o=0,s=t.length;o<s;++o)for(var l=t[o],u=0,c=l.length;u<c;++u){var d=l[u].feature;d&&-1===i.indexOf(d)&&this.featuresBeingModified_.push(d)}0===this.featuresBeingModified_.getLength()?this.featuresBeingModified_=null:this.dispatchEvent(new Ue("modifystart",this.featuresBeingModified_,e))}},n.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener($.Z.CHANGE,this.boundHandleFeatureChange_)},n.prototype.removeFeatureSegmentData_=function(e){var t=this.rBush_,i=[];t.forEach(function(u){e===u.feature&&i.push(u)});for(var o=i.length-1;o>=0;--o){for(var s=i[o],l=this.dragSegments_.length-1;l>=0;--l)this.dragSegments_[l][0]===s&&this.dragSegments_.splice(l,1);t.remove(s)}},n.prototype.setActive=function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),a.prototype.setActive.call(this,e)},n.prototype.setMap=function(e){this.overlay_.setMap(e),a.prototype.setMap.call(this,e)},n.prototype.getOverlay=function(){return this.overlay_},n.prototype.handleSourceAdd_=function(e){e.feature&&this.features_.push(e.feature)},n.prototype.handleSourceRemove_=function(e){e.feature&&this.features_.remove(e.feature)},n.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)},n.prototype.handleFeatureChange_=function(e){if(!this.changingFeature_){var t=e.target;this.removeFeature_(t),this.addFeature_(t)}},n.prototype.handleFeatureRemove_=function(e){this.removeFeature_(e.element)},n.prototype.writePointGeometry_=function(e,t){var i=t.getCoordinates(),o={feature:e,geometry:t,segment:[i,i]};this.rBush_.insert(t.getExtent(),o)},n.prototype.writeMultiPointGeometry_=function(e,t){for(var i=t.getCoordinates(),o=0,s=i.length;o<s;++o){var l=i[o],u={feature:e,geometry:t,depth:[o],index:o,segment:[l,l]};this.rBush_.insert(t.getExtent(),u)}},n.prototype.writeLineStringGeometry_=function(e,t){for(var i=t.getCoordinates(),o=0,s=i.length-1;o<s;++o){var l=i.slice(o,o+2),u={feature:e,geometry:t,index:o,segment:l};this.rBush_.insert((0,T.hI)(l),u)}},n.prototype.writeMultiLineStringGeometry_=function(e,t){for(var i=t.getCoordinates(),o=0,s=i.length;o<s;++o)for(var l=i[o],u=0,c=l.length-1;u<c;++u){var d=l.slice(u,u+2),h={feature:e,geometry:t,depth:[o],index:u,segment:d};this.rBush_.insert((0,T.hI)(d),h)}},n.prototype.writePolygonGeometry_=function(e,t){for(var i=t.getCoordinates(),o=0,s=i.length;o<s;++o)for(var l=i[o],u=0,c=l.length-1;u<c;++u){var d=l.slice(u,u+2),h={feature:e,geometry:t,depth:[o],index:u,segment:d};this.rBush_.insert((0,T.hI)(d),h)}},n.prototype.writeMultiPolygonGeometry_=function(e,t){for(var i=t.getCoordinates(),o=0,s=i.length;o<s;++o)for(var l=i[o],u=0,c=l.length;u<c;++u)for(var d=l[u],h=0,_=d.length-1;h<_;++h){var p=d.slice(h,h+2),y={feature:e,geometry:t,depth:[u,o],index:h,segment:p};this.rBush_.insert((0,T.hI)(p),y)}},n.prototype.writeCircleGeometry_=function(e,t){var i=t.getCenter(),o={feature:e,geometry:t,index:0,segment:[i,i]},s={feature:e,geometry:t,index:1,segment:[i,i]},l=[o,s];o.featureSegments=l,s.featureSegments=l,this.rBush_.insert((0,T.HK)(i),o);var u=t,c=(0,m.Cs)();if(c&&this.getMap()){var d=this.getMap().getView().getProjection();u=u.clone().transform(c,d),u=(0,N.Bb)(u).transform(d,c)}this.rBush_.insert(u.getExtent(),s)},n.prototype.writeGeometryCollectionGeometry_=function(e,t){for(var i=t.getGeometriesArray(),o=0;o<i.length;++o){var s=i[o];(0,this.SEGMENT_WRITERS_[s.getType()])(e,s)}},n.prototype.createOrUpdateVertexFeature_=function(e,t,i){var o=this.vertexFeature_;return o?o.getGeometry().setCoordinates(e):(o=new A.Z(new J.Z(e)),this.vertexFeature_=o,this.overlay_.getSource().addFeature(o)),o.set("features",t),o.set("geometries",i),o},n.prototype.handleEvent=function(e){return!e.originalEvent||(this.lastPointerEvent_=e,!e.map.getView().getInteracting()&&e.type==k.Z.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(t=!(e.type!=k.Z.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==k.Z.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),a.prototype.handleEvent.call(this,e)&&!t);var t},n.prototype.handleDragEvent=function(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_);for(var t=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],i=[],o=[],s=0,l=this.dragSegments_.length;s<l;++s){var u=this.dragSegments_[s],c=u[0],d=c.feature;-1===i.indexOf(d)&&i.push(d);var h=c.geometry;-1===o.indexOf(h)&&o.push(h);for(var _=c.depth,p=void 0,y=c.segment,g=u[1];t.length<h.getStride();)t.push(y[g][t.length]);switch(h.getType()){case"Point":p=t,y[0]=t,y[1]=t;break;case"MultiPoint":(p=h.getCoordinates())[c.index]=t,y[0]=t,y[1]=t;break;case"LineString":(p=h.getCoordinates())[c.index+g]=t,y[g]=t;break;case"MultiLineString":case"Polygon":(p=h.getCoordinates())[_[0]][c.index+g]=t,y[g]=t;break;case"MultiPolygon":(p=h.getCoordinates())[_[1]][_[0]][c.index+g]=t,y[g]=t;break;case"Circle":if(y[0]=t,y[1]=t,0===c.index)this.changingFeature_=!0,h.setCenter(t),this.changingFeature_=!1;else{this.changingFeature_=!0;var x=e.map.getView().getProjection(),L=(0,P.TE)((0,m.Vs)(h.getCenter(),x),(0,m.Vs)(t,x)),E=(0,m.Cs)();if(E){var I=h.clone().transform(E,x);I.setRadius(L),L=I.transform(x,E).getRadius()}h.setRadius(L),this.changingFeature_=!1}}p&&this.setGeometryCoordinates_(h,p)}this.createOrUpdateVertexFeature_(t,i,o)},n.prototype.handleDownEvent=function(e){if(!this.condition_(e))return!1;var t=e.coordinate;this.handlePointerAtPixel_(e.pixel,e.map,t),this.dragSegments_.length=0,this.featuresBeingModified_=null;var i=this.vertexFeature_;if(i){var o=e.map.getView().getProjection(),s=[],l=i.getGeometry().getCoordinates(),u=(0,T.hI)([l]),c=this.rBush_.getInExtent(u),d={};c.sort(Mr);for(var h=0,_=c.length;h<_;++h){var p=c[h],y=p.segment,g=(0,b.sq)(p.geometry),x=p.depth;if(x&&(g+="-"+x.join("-")),d[g]||(d[g]=new Array(2)),"Circle"!==p.geometry.getType()||1!==p.index)if(!(0,P.fS)(y[0],l)||d[g][0])if(!(0,P.fS)(y[1],l)||d[g][1])(0,b.sq)(y)in this.vertexSegments_&&!d[g][0]&&!d[g][1]&&this.insertVertexCondition_(e)&&s.push(p);else{if(d[g][0]&&0===d[g][0].index){var E=p.geometry.getCoordinates();switch(p.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":E=E[x[1]];case"Polygon":if(p.index!==E[x[0]].length-2)continue}}this.dragSegments_.push([p,1]),d[g][1]=p}else this.dragSegments_.push([p,0]),d[g][0]=p;else{var L=dt(t,p,o);(0,P.fS)(L,l)&&!d[g][0]&&(this.dragSegments_.push([p,0]),d[g][0]=p)}}s.length&&this.willModifyFeatures_(e,[s]);for(var I=s.length-1;I>=0;--I)this.insertVertex_(s[I],l)}return!!this.vertexFeature_},n.prototype.handleUpEvent=function(e){for(var t=this.dragSegments_.length-1;t>=0;--t){var i=this.dragSegments_[t][0],o=i.geometry;if("Circle"===o.getType()){var s=o.getCenter(),l=i.featureSegments[0],u=i.featureSegments[1];l.segment[0]=s,l.segment[1]=s,u.segment[0]=s,u.segment[1]=s,this.rBush_.update((0,T.HK)(s),l);var c=o,d=(0,m.Cs)();if(d){var h=e.map.getView().getProjection();c=c.clone().transform(d,h),c=(0,N.Bb)(c).transform(h,d)}this.rBush_.update(c.getExtent(),u)}else this.rBush_.update((0,T.hI)(i.segment),i)}return this.featuresBeingModified_&&(this.dispatchEvent(new Ue("modifyend",this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1},n.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map,e.coordinate)},n.prototype.handlePointerAtPixel_=function(e,t,i){var c,d,o=this,s=i||t.getCoordinateFromPixel(e),l=t.getView().getProjection();if(this.hitDetection_&&t.forEachFeatureAtPixel(e,function(Q,Lt,K){if("Point"===(K=K||Q.getGeometry()).getType()&&(0,G.q9)(o.features_.getArray(),Q)){d=K;var Pt=K.getFlatCoordinates().slice(0,2);c=[{feature:Q,geometry:K,segment:[Pt,Pt]}]}return!0},{layerFilter:"object"==typeof this.hitDetection_?function(Q){return Q===o.hitDetection_}:void 0}),!c){var _=(0,m.dY)((0,T.HK)(s,ut),l),p=t.getView().getResolution()*this.pixelTolerance_,y=(0,m.Fj)((0,T.f3)(_,p,ut),l);c=this.rBush_.getInExtent(y)}if(c&&c.length>0){var g=c.sort(function(Q,Lt){return ct(s,Q,l)-ct(s,Lt,l)})[0],x=g.segment,L=dt(s,g,l),E=t.getPixelFromCoordinate(L),I=(0,P.TE)(e,E);if(d||I<=this.pixelTolerance_){var H={};if(H[(0,b.sq)(x)]=!0,this.snapToPointer_||(this.delta_[0]=L[0]-s[0],this.delta_[1]=L[1]-s[1]),"Circle"===g.geometry.getType()&&1===g.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(L,[g.feature],[g.geometry]);else{var be=t.getPixelFromCoordinate(x[0]),we=t.getPixelFromCoordinate(x[1]),Le=(0,P.bI)(E,be),ie=(0,P.bI)(E,we);I=Math.sqrt(Math.min(Le,ie)),this.snappedToVertex_=I<=this.pixelTolerance_,this.snappedToVertex_&&(L=Le>ie?x[1]:x[0]),this.createOrUpdateVertexFeature_(L,[g.feature],[g.geometry]);var z={};z[(0,b.sq)(g.geometry)]=!0;for(var Z=1,oe=c.length;Z<oe;++Z){var j=c[Z].segment;if(!((0,P.fS)(x[0],j[0])&&(0,P.fS)(x[1],j[1])||(0,P.fS)(x[0],j[1])&&(0,P.fS)(x[1],j[0])))break;var wt=(0,b.sq)(c[Z].geometry);wt in z||(z[wt]=!0,H[(0,b.sq)(j)]=!0)}}return void(this.vertexSegments_=H)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},n.prototype.insertVertex_=function(e,t){for(var c,i=e.segment,o=e.feature,s=e.geometry,l=e.depth,u=e.index;t.length<s.getStride();)t.push(0);switch(s.getType()){case"MultiLineString":case"Polygon":(c=s.getCoordinates())[l[0]].splice(u+1,0,t);break;case"MultiPolygon":(c=s.getCoordinates())[l[1]][l[0]].splice(u+1,0,t);break;case"LineString":(c=s.getCoordinates()).splice(u+1,0,t);break;default:return}this.setGeometryCoordinates_(s,c);var d=this.rBush_;d.remove(e),this.updateSegmentIndices_(s,u,l,1);var h={segment:[i[0],t],feature:o,geometry:s,depth:l,index:u};d.insert((0,T.hI)(h.segment),h),this.dragSegments_.push([h,1]);var _={segment:[t,i[1]],feature:o,geometry:s,depth:l,index:u+1};d.insert((0,T.hI)(_.segment),_),this.dragSegments_.push([_,0]),this.ignoreNextSingleClick_=!0},n.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=k.Z.POINTERDRAG){var e=this.lastPointerEvent_;this.willModifyFeatures_(e,this.dragSegments_);var t=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new Ue("modifyend",this.featuresBeingModified_,e)),this.featuresBeingModified_=null,t}return!1},n.prototype.removeVertex_=function(){var o,s,l,u,c,d,h,_,p,y,g,e=this.dragSegments_,t={},i=!1;for(c=e.length-1;c>=0;--c)g=(0,b.sq)((y=(l=e[c])[0]).feature),y.depth&&(g+="-"+y.depth.join("-")),g in t||(t[g]={}),0===l[1]?(t[g].right=y,t[g].index=y.index):1==l[1]&&(t[g].left=y,t[g].index=y.index+1);for(g in t){switch(p=t[g].right,(_=(d=t[g].index)-1)<0&&(_=0),o=s=(u=(y=void 0!==(h=t[g].left)?h:p).geometry).getCoordinates(),i=!1,u.getType()){case"MultiLineString":s[y.depth[0]].length>2&&(s[y.depth[0]].splice(d,1),i=!0);break;case"LineString":s.length>2&&(s.splice(d,1),i=!0);break;case"MultiPolygon":o=o[y.depth[1]];case"Polygon":(o=o[y.depth[0]]).length>4&&(d==o.length-1&&(d=0),o.splice(d,1),i=!0,0===d&&(o.pop(),o.push(o[0]),_=o.length-1))}if(i){this.setGeometryCoordinates_(u,s);var x=[];if(void 0!==h&&(this.rBush_.remove(h),x.push(h.segment[0])),void 0!==p&&(this.rBush_.remove(p),x.push(p.segment[1])),void 0!==h&&void 0!==p){var L={depth:y.depth,feature:y.feature,geometry:y.geometry,index:_,segment:x};this.rBush_.insert((0,T.hI)(L.segment),L)}this.updateSegmentIndices_(u,d,y.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return i},n.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1},n.prototype.updateSegmentIndices_=function(e,t,i,o){this.rBush_.forEachInExtent(e.getExtent(),function(s){s.geometry===e&&(void 0===i||void 0===s.depth||(0,G.fS)(s.depth,i))&&s.index>t&&(s.index+=o)})},n}(ye.Z);function Mr(a,n){return a.index-n.index}function ct(a,n,e){var t=n.geometry;if("Circle"===t.getType()){var i=t;if(1===n.index){var o=(0,m.Cs)();o&&(i=i.clone().transform(o,e));var s=(0,P.bI)(i.getCenter(),(0,m.Vs)(a,e)),l=Math.sqrt(s)-i.getRadius();return l*l}}var u=(0,m.Vs)(a,e);return X[0]=(0,m.Vs)(n.segment[0],e),X[1]=(0,m.Vs)(n.segment[1],e),(0,P.Bs)(u,X)}function dt(a,n,e){var t=n.geometry;if("Circle"===t.getType()&&1===n.index){var i=t,o=(0,m.Cs)();return o&&(i=i.clone().transform(o,e)),(0,m.lO)(i.getClosestPoint((0,m.Vs)(a,e)),e)}var s=(0,m.Vs)(a,e);return X[0]=(0,m.Vs)(n.segment[0],e),X[1]=(0,m.Vs)(n.segment[1],e),(0,m.lO)((0,P.oL)(s,X),e)}function kr(){var a=(0,V.Ly)();return function(n,e){return a.Point}}const Or=Ir;var ht=f(874),Zr=function(){var a=function(n,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}a(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}(),ft=function(a){function n(e,t,i){var o=a.call(this)||this;return void 0!==i&&void 0===t?o.setFlatCoordinates(i,e):o.setCenterAndRadius(e,t||0,i),o}return Zr(n,a),n.prototype.clone=function(){var e=new n(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e},n.prototype.closestPointXY=function(e,t,i,o){var s=this.flatCoordinates,l=e-s[0],u=t-s[1],c=l*l+u*u;if(c<o){if(0===c)for(var d=0;d<this.stride;++d)i[d]=s[d];else{var h=this.getRadius()/Math.sqrt(c);for(i[0]=s[0]+h*l,i[1]=s[1]+h*u,d=2;d<this.stride;++d)i[d]=s[d]}return i.length=this.stride,c}return o},n.prototype.containsXY=function(e,t){var i=this.flatCoordinates,o=e-i[0],s=t-i[1];return o*o+s*s<=this.getRadiusSquared_()},n.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},n.prototype.computeExtent=function(e){var t=this.flatCoordinates,i=t[this.stride]-t[0];return(0,T.T9)(t[0]-i,t[1]-i,t[0]+i,t[1]+i,e)},n.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},n.prototype.getRadiusSquared_=function(){var e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t},n.prototype.getType=function(){return"Circle"},n.prototype.intersectsExtent=function(e){var t=this.getExtent();if((0,T.kK)(e,t)){var i=this.getCenter();return e[0]<=i[0]&&e[2]>=i[0]||e[1]<=i[1]&&e[3]>=i[1]||(0,T.H6)(e,this.intersectsCoordinate.bind(this))}return!1},n.prototype.setCenter=function(e){var t=this.stride,i=this.flatCoordinates[t]-this.flatCoordinates[0],o=e.slice();o[t]=o[0]+i;for(var s=1;s<t;++s)o[t+s]=e[s];this.setFlatCoordinates(this.layout,o),this.changed()},n.prototype.setCenterAndRadius=function(e,t,i){this.setLayout(i,e,0),this.flatCoordinates||(this.flatCoordinates=[]);var o=this.flatCoordinates,s=(0,he.IG)(o,0,e,this.stride);o[s++]=o[0]+t;for(var l=1,u=this.stride;l<u;++l)o[s++]=o[l];o.length=s,this.changed()},n.prototype.getCoordinates=function(){return null},n.prototype.setCoordinates=function(e,t){},n.prototype.setRadius=function(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()},n.prototype.rotate=function(e,t){var i=this.getCenter(),o=this.getStride();this.setCenter((0,ht.U1)(i,0,i.length,o,e,t,i)),this.changed()},n.prototype.translate=function(e,t){var i=this.getCenter(),o=this.getStride();this.setCenter((0,ht.Iu)(i,0,i.length,o,e,t,i)),this.changed()},n}(Y.ZP);const Ar=ft;var Gr=f(1994),pt=function(){var a=function(n,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}a(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}(),ve=function(a){function n(e,t){var i=a.call(this,e)||this;return i.feature=t,i}return pt(n,a),n}(Ne.ZP),Nr=function(a){function n(e){var t=this,i=e;i.stopDown||(i.stopDown=W.Dv),(t=a.call(this,i)||this).shouldHandle_=!1,t.downPx_=null,t.freehand_=!1,t.source_=e.source?e.source:null,t.features_=e.features?e.features:null,t.snapTolerance_=e.snapTolerance?e.snapTolerance:12,t.type_=e.type,t.mode_=function Dr(a){switch(a){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+a)}}(t.type_),t.stopClick_=!!e.stopClick,t.minPoints_=e.minPoints?e.minPoints:"Polygon"===t.mode_?3:2,t.maxPoints_="Circle"===t.mode_?2:e.maxPoints?e.maxPoints:1/0,t.finishCondition_=e.finishCondition?e.finishCondition:W.uX,t.geometryLayout_=e.geometryLayout?e.geometryLayout:S.Z.XY;var o=e.geometryFunction;if(!o){var l,s=t.mode_;"Circle"===s?o=function(u,c,d){var h=c||new Ar([NaN,NaN]),_=(0,m.Vs)(u[0],d),p=(0,P.bI)(_,(0,m.Vs)(u[u.length-1],d));h.setCenterAndRadius(_,Math.sqrt(p),this.geometryLayout_);var y=(0,m.Cs)();return y&&h.transform(d,y),h}:("Point"===s?l=J.Z:"LineString"===s?l=D.Z:"Polygon"===s&&(l=N.ZP),o=function(u,c,d){return c?c.setCoordinates("Polygon"===s?u[0].length?[u[0].concat([u[0][0]])]:[]:u,this.geometryLayout_):c=new l(u,this.geometryLayout_),c})}return t.geometryFunction_=o,t.dragVertexDelay_=void 0!==e.dragVertexDelay?e.dragVertexDelay:500,t.finishCoordinate_=null,t.sketchFeature_=null,t.sketchPoint_=null,t.sketchCoords_=null,t.sketchLine_=null,t.sketchLineCoords_=null,t.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,t.overlay_=new Je.Z({source:new te.Z({useSpatialIndex:!1,wrapX:!!e.wrapX&&e.wrapX}),style:e.style?e.style:Rr(),updateWhileInteracting:!0}),t.geometryName_=e.geometryName,t.condition_=e.condition?e.condition:R.rM,t.freehandCondition_=e.freehand?R.Bx:e.freehandCondition?e.freehandCondition:R.vY,t.addChangeListener(ot.Z.ACTIVE,t.updateState_),t}return pt(n,a),n.prototype.setMap=function(e){a.prototype.setMap.call(this,e),this.updateState_()},n.prototype.getOverlay=function(){return this.overlay_},n.prototype.handleEvent=function(e){e.originalEvent.type===$.Z.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_="Point"!==this.mode_&&this.freehandCondition_(e);var t=e.type===k.Z.POINTERMOVE,i=!0;return!this.freehand_&&this.lastDragTime_&&e.type===k.Z.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,t=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===k.Z.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(e.coordinate),i=!1):this.freehand_&&e.type===k.Z.POINTERDOWN?i=!1:t&&this.getPointerCount()<2?(i=e.type===k.Z.POINTERMOVE)&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):("mouse"===e.originalEvent.pointerType||e.type===k.Z.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(e):e.type===k.Z.DBLCLICK&&(i=!1),a.prototype.handleEvent.call(this,e)&&i},n.prototype.handleDownEvent=function(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new Gr.Z(k.Z.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)},n.prototype.handleUpEvent=function(e){var t=!0;if(0===this.getPointerCount())if(this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e),this.shouldHandle_){var i=!this.finishCoordinate_;i&&this.startDrawing_(e.coordinate),!i&&this.freehand_?this.finishDrawing():!this.freehand_&&(!i||"Point"===this.mode_)&&(this.atFinish_(e.pixel)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),t=!1}else this.freehand_&&this.abortDrawing();return!t&&this.stopClick_&&e.preventDefault(),t},n.prototype.handlePointerMove_=function(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var t=this.downPx_,i=e.pixel,o=t[0]-i[0],s=t[1]-i[1],l=o*o+s*s;if(this.shouldHandle_=this.freehand_?l>this.squaredClickTolerance_:l<=this.squaredClickTolerance_,!this.shouldHandle_)return}this.finishCoordinate_?this.modifyDrawing_(e.coordinate):this.createOrUpdateSketchPoint_(e.coordinate.slice())},n.prototype.atFinish_=function(e){var t=!1;if(this.sketchFeature_){var i=!1,o=[this.finishCoordinate_],s=this.mode_;if("Point"===s)t=!0;else if("Circle"===s)t=2===this.sketchCoords_.length;else if("LineString"===s)i=this.sketchCoords_.length>this.minPoints_;else if("Polygon"===s){var l=this.sketchCoords_;i=l[0].length>this.minPoints_,o=[l[0][0],l[0][l[0].length-2]]}if(i)for(var u=this.getMap(),c=0,d=o.length;c<d;c++){var h=o[c],_=u.getPixelFromCoordinate(h),p=e[0]-_[0],y=e[1]-_[1],g=this.freehand_?1:this.snapTolerance_;if(t=Math.sqrt(p*p+y*y)<=g){this.finishCoordinate_=h;break}}}return t},n.prototype.createOrUpdateSketchPoint_=function(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new A.Z(new J.Z(e)),this.updateSketchFeatures_())},n.prototype.createOrUpdateCustomSketchLine_=function(e){this.sketchLine_||(this.sketchLine_=new A.Z);var t=e.getLinearRing(0),i=this.sketchLine_.getGeometry();i?(i.setFlatCoordinates(t.getLayout(),t.getFlatCoordinates()),i.changed()):(i=new D.Z(t.getFlatCoordinates(),t.getLayout()),this.sketchLine_.setGeometry(i))},n.prototype.startDrawing_=function(e){for(var t=this.getMap().getView().getProjection(),i=(0,Y.tP)(this.geometryLayout_);e.length<i;)e.push(0);this.finishCoordinate_=e,"Point"===this.mode_?this.sketchCoords_=e.slice():"Polygon"===this.mode_?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new A.Z(new D.Z(this.sketchLineCoords_)));var o=this.geometryFunction_(this.sketchCoords_,void 0,t);this.sketchFeature_=new A.Z,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(o),this.updateSketchFeatures_(),this.dispatchEvent(new ve("drawstart",this.sketchFeature_))},n.prototype.modifyDrawing_=function(e){for(var l,u,t=this.getMap(),i=this.sketchFeature_.getGeometry(),o=t.getView().getProjection(),s=(0,Y.tP)(this.geometryLayout_);e.length<s;)e.push(0);"Point"===this.mode_?u=this.sketchCoords_:"Polygon"===this.mode_?(u=(l=this.sketchCoords_[0])[l.length-1],this.atFinish_(t.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):u=(l=this.sketchCoords_)[l.length-1],u[0]=e[0],u[1]=e[1],this.geometryFunction_(this.sketchCoords_,i,o),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),"Polygon"===i.getType()&&"Polygon"!==this.mode_?this.createOrUpdateCustomSketchLine_(i):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()},n.prototype.addToDrawing_=function(e){var o,s,t=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection(),l=this.mode_;"LineString"===l||"Circle"===l?(this.finishCoordinate_=e.slice(),(s=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?s.pop():o=!0),s.push(e.slice()),this.geometryFunction_(s,t,i)):"Polygon"===l&&((s=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?s.pop():o=!0),s.push(e.slice()),o&&(this.finishCoordinate_=s[0]),this.geometryFunction_(this.sketchCoords_,t,i)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),o&&this.finishDrawing()},n.prototype.removeLastPoint=function(){if(this.sketchFeature_){var i,e=this.sketchFeature_.getGeometry(),t=this.getMap().getView().getProjection(),o=this.mode_;if("LineString"===o||"Circle"===o){if((i=this.sketchCoords_).splice(-2,1),i.length>=2){this.finishCoordinate_=i[i.length-2].slice();var s=this.finishCoordinate_.slice();i[i.length-1]=s,this.createOrUpdateSketchPoint_(s)}this.geometryFunction_(i,e,t),"Polygon"===e.getType()&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(e)}else if("Polygon"===o){(i=this.sketchCoords_[0]).splice(-2,1);var l=this.sketchLine_.getGeometry();i.length>=2&&(s=i[i.length-2].slice(),i[i.length-1]=s,this.createOrUpdateSketchPoint_(s)),l.setCoordinates(i),this.geometryFunction_(this.sketchCoords_,e,t)}1===i.length&&this.abortDrawing(),this.updateSketchFeatures_()}},n.prototype.finishDrawing=function(){var e=this.abortDrawing_();if(e){var t=this.sketchCoords_,i=e.getGeometry(),o=this.getMap().getView().getProjection();"LineString"===this.mode_?(t.pop(),this.geometryFunction_(t,i,o)):"Polygon"===this.mode_&&(t[0].pop(),this.geometryFunction_(t,i,o),t=i.getCoordinates()),"MultiPoint"===this.type_?e.setGeometry(new fe([t])):"MultiLineString"===this.type_?e.setGeometry(new Ie([t])):"MultiPolygon"===this.type_&&e.setGeometry(new ke([t])),this.dispatchEvent(new ve("drawend",e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e)}},n.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),e},n.prototype.abortDrawing=function(){var e=this.abortDrawing_();e&&this.dispatchEvent(new ve("drawabort",e))},n.prototype.appendCoordinates=function(e){var o,t=this.mode_,i=!this.sketchFeature_;if(i&&this.startDrawing_(e[0]),"LineString"===t||"Circle"===t)o=this.sketchCoords_;else{if("Polygon"!==t)return;o=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]}i&&o.shift(),o.pop();for(var s=0;s<e.length;s++)this.addToDrawing_(e[s]);var l=e[e.length-1];this.addToDrawing_(l),this.modifyDrawing_(l)},n.prototype.extend=function(e){var i=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=i.getCoordinates();var o=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=o.slice(),this.sketchCoords_.push(o.slice()),this.sketchPoint_=new A.Z(new J.Z(o)),this.updateSketchFeatures_(),this.dispatchEvent(new ve("drawstart",this.sketchFeature_))},n.prototype.updateSketchFeatures_=function(){var e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);var t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)},n.prototype.updateState_=function(){var e=this.getMap(),t=this.getActive();(!e||!t)&&this.abortDrawing(),this.overlay_.setMap(t?e:null)},n}(ye.Z);function Rr(){var a=(0,V.Ly)();return function(n,e){return a[n.getGeometry().getType()]}}const Jr=Nr;var jr=f(154),Ur=function(){var a=function(n,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}a(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}(),Br=function(a){function n(){return a.call(this)||this}return Ur(n,a),n.prototype.getType=function(){return"text"},n.prototype.readFeature=function(e,t){return this.readFeatureFromText(Ce(e),this.adaptOptions(t))},n.prototype.readFeatureFromText=function(e,t){return(0,b.O3)()},n.prototype.readFeatures=function(e,t){return this.readFeaturesFromText(Ce(e),this.adaptOptions(t))},n.prototype.readFeaturesFromText=function(e,t){return(0,b.O3)()},n.prototype.readGeometry=function(e,t){return this.readGeometryFromText(Ce(e),this.adaptOptions(t))},n.prototype.readGeometryFromText=function(e,t){return(0,b.O3)()},n.prototype.readProjection=function(e){return this.readProjectionFromText(Ce(e))},n.prototype.readProjectionFromText=function(e){return this.dataProjection},n.prototype.writeFeature=function(e,t){return this.writeFeatureText(e,this.adaptOptions(t))},n.prototype.writeFeatureText=function(e,t){return(0,b.O3)()},n.prototype.writeFeatures=function(e,t){return this.writeFeaturesText(e,this.adaptOptions(t))},n.prototype.writeFeaturesText=function(e,t){return(0,b.O3)()},n.prototype.writeGeometry=function(e,t){return this.writeGeometryText(e,this.adaptOptions(t))},n.prototype.writeGeometryText=function(e,t){return(0,b.O3)()},n}(ze);function Ce(a){return"string"==typeof a?a:""}const Vr=Br;var Hr=function(){var a=function(n,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])})(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}a(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}(),Qr={POINT:J.Z,LINESTRING:D.Z,POLYGON:N.ZP,MULTIPOINT:fe,MULTILINESTRING:Ie,MULTIPOLYGON:ke},Yr={Point:"POINT",LineString:"LINESTRING",Polygon:"POLYGON",MultiPoint:"MULTIPOINT",MultiLineString:"MULTILINESTRING",MultiPolygon:"MULTIPOLYGON",GeometryCollection:"GEOMETRYCOLLECTION",Circle:"CIRCLE"},Wr=function(){function a(n){this.wkt=n,this.index_=-1}return a.prototype.isAlpha_=function(n){return n>="a"&&n<="z"||n>="A"&&n<="Z"},a.prototype.isNumeric_=function(n,e){return n>="0"&&n<="9"||"."==n&&!(void 0!==e&&e)},a.prototype.isWhiteSpace_=function(n){return" "==n||"\t"==n||"\r"==n||"\n"==n},a.prototype.nextChar_=function(){return this.wkt.charAt(++this.index_)},a.prototype.nextToken=function(){var i,n=this.nextChar_(),e=this.index_,t=n;if("("==n)i=2;else if(","==n)i=5;else if(")"==n)i=3;else if(this.isNumeric_(n)||"-"==n)i=4,t=this.readNumber_();else if(this.isAlpha_(n))i=1,t=this.readText_();else{if(this.isWhiteSpace_(n))return this.nextToken();if(""!==n)throw new Error("Unexpected character: "+n);i=6}return{position:e,value:t,type:i}},a.prototype.readNumber_=function(){var n,e=this.index_,t=!1,i=!1;do{"."==n?t=!0:("e"==n||"E"==n)&&(i=!0),n=this.nextChar_()}while(this.isNumeric_(n,t)||!i&&("e"==n||"E"==n)||i&&("-"==n||"+"==n));return parseFloat(this.wkt.substring(e,this.index_--))},a.prototype.readText_=function(){var n,e=this.index_;do{n=this.nextChar_()}while(this.isAlpha_(n));return this.wkt.substring(e,this.index_--).toUpperCase()},a}(),Xr=function(){function a(n){this.lexer_=n,this.token_={position:0,type:0},this.layout_=S.Z.XY}return a.prototype.consume_=function(){this.token_=this.lexer_.nextToken()},a.prototype.isTokenType=function(n){return this.token_.type==n},a.prototype.match=function(n){var e=this.isTokenType(n);return e&&this.consume_(),e},a.prototype.parse=function(){return this.consume_(),this.parseGeometry_()},a.prototype.parseGeometryLayout_=function(){var n=S.Z.XY,e=this.token_;if(this.isTokenType(1)){var t=e.value;"Z"===t?n=S.Z.XYZ:"M"===t?n=S.Z.XYM:"ZM"===t&&(n=S.Z.XYZM),n!==S.Z.XY&&this.consume_()}return n},a.prototype.parseGeometryCollectionText_=function(){if(this.match(2)){var n=[];do{n.push(this.parseGeometry_())}while(this.match(5));if(this.match(3))return n}throw new Error(this.formatErrorMessage_())},a.prototype.parsePointText_=function(){if(this.match(2)){var n=this.parsePoint_();if(this.match(3))return n}throw new Error(this.formatErrorMessage_())},a.prototype.parseLineStringText_=function(){if(this.match(2)){var n=this.parsePointList_();if(this.match(3))return n}throw new Error(this.formatErrorMessage_())},a.prototype.parsePolygonText_=function(){if(this.match(2)){var n=this.parseLineStringTextList_();if(this.match(3))return n}throw new Error(this.formatErrorMessage_())},a.prototype.parseMultiPointText_=function(){if(this.match(2)){var n;if(n=2==this.token_.type?this.parsePointTextList_():this.parsePointList_(),this.match(3))return n}throw new Error(this.formatErrorMessage_())},a.prototype.parseMultiLineStringText_=function(){if(this.match(2)){var n=this.parseLineStringTextList_();if(this.match(3))return n}throw new Error(this.formatErrorMessage_())},a.prototype.parseMultiPolygonText_=function(){if(this.match(2)){var n=this.parsePolygonTextList_();if(this.match(3))return n}throw new Error(this.formatErrorMessage_())},a.prototype.parsePoint_=function(){for(var n=[],e=this.layout_.length,t=0;t<e;++t){var i=this.token_;if(!this.match(4))break;n.push(i.value)}if(n.length==e)return n;throw new Error(this.formatErrorMessage_())},a.prototype.parsePointList_=function(){for(var n=[this.parsePoint_()];this.match(5);)n.push(this.parsePoint_());return n},a.prototype.parsePointTextList_=function(){for(var n=[this.parsePointText_()];this.match(5);)n.push(this.parsePointText_());return n},a.prototype.parseLineStringTextList_=function(){for(var n=[this.parseLineStringText_()];this.match(5);)n.push(this.parseLineStringText_());return n},a.prototype.parsePolygonTextList_=function(){for(var n=[this.parsePolygonText_()];this.match(5);)n.push(this.parsePolygonText_());return n},a.prototype.isEmptyGeometry_=function(){var n=this.isTokenType(1)&&"EMPTY"==this.token_.value;return n&&this.consume_(),n},a.prototype.formatErrorMessage_=function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"},a.prototype.parseGeometry_=function(){var n=this.token_;if(this.match(1)){var e=n.value;this.layout_=this.parseGeometryLayout_();var t=this.isEmptyGeometry_();if("GEOMETRYCOLLECTION"==e){if(t)return new se([]);var i=this.parseGeometryCollectionText_();return new se(i)}var o=Qr[e];if(!o)throw new Error("Invalid geometry type: "+e);var s=void 0;if(t)s="POINT"==e?[NaN,NaN]:[];else switch(e){case"POINT":s=this.parsePointText_();break;case"LINESTRING":s=this.parseLineStringText_();break;case"POLYGON":s=this.parsePolygonText_();break;case"MULTIPOINT":s=this.parseMultiPointText_();break;case"MULTILINESTRING":s=this.parseMultiLineStringText_();break;case"MULTIPOLYGON":s=this.parseMultiPolygonText_()}return new o(s,this.layout_)}throw new Error(this.formatErrorMessage_())},a}(),zr=function(a){function n(e){var t=a.call(this)||this,i=e||{};return t.splitCollection_=void 0!==i.splitCollection&&i.splitCollection,t}return Hr(n,a),n.prototype.parse_=function(e){var t=new Wr(e);return new Xr(t).parse()},n.prototype.readFeatureFromText=function(e,t){var i=this.readGeometryFromText(e,t),o=new A.Z;return o.setGeometry(i),o},n.prototype.readFeaturesFromText=function(e,t){for(var i,o=this.readGeometryFromText(e,t),s=[],l=0,u=(i=this.splitCollection_&&"GeometryCollection"==o.getType()?o.getGeometriesArray():[o]).length;l<u;++l){var c=new A.Z;c.setGeometry(i[l]),s.push(c)}return s},n.prototype.readGeometryFromText=function(e,t){return ue(this.parse_(e),!1,t)},n.prototype.writeFeatureText=function(e,t){var i=e.getGeometry();return i?this.writeGeometryText(i,t):""},n.prototype.writeFeaturesText=function(e,t){if(1==e.length)return this.writeFeatureText(e[0],t);for(var i=[],o=0,s=e.length;o<s;++o)i.push(e[o].getGeometry());var l=new se(i);return this.writeGeometryText(l,t)},n.prototype.writeGeometryText=function(e,t){return Ct(ue(e,!0,t))},n}(Vr);function mt(a){var n=a.getCoordinates();return 0===n.length?"":n.join(" ")}function Be(a){for(var n=a.getCoordinates(),e=[],t=0,i=n.length;t<i;++t)e.push(n[t].join(" "));return e.join(",")}function vt(a){for(var n=[],e=a.getLinearRings(),t=0,i=e.length;t<i;++t)n.push("("+Be(e[t])+")");return n.join(",")}var nn={Point:mt,LineString:Be,Polygon:vt,MultiPoint:function Kr(a){for(var n=[],e=a.getPoints(),t=0,i=e.length;t<i;++t)n.push("("+mt(e[t])+")");return n.join(",")},MultiLineString:function en(a){for(var n=[],e=a.getLineStrings(),t=0,i=e.length;t<i;++t)n.push("("+Be(e[t])+")");return n.join(",")},MultiPolygon:function tn(a){for(var n=[],e=a.getPolygons(),t=0,i=e.length;t<i;++t)n.push("("+vt(e[t])+")");return n.join(",")},GeometryCollection:function $r(a){for(var n=[],e=a.getGeometries(),t=0,i=e.length;t<i;++t)n.push(Ct(e[t]));return n.join(",")}};function Ct(a){var n=a.getType(),t=(0,nn[n])(a),i=Yr[n];if("function"==typeof a.getFlatCoordinates){var o=function rn(a){var n=a.getLayout(),e="";return(n===S.Z.XYZ||n===S.Z.XYZM)&&(e+="Z"),(n===S.Z.XYM||n===S.Z.XYZM)&&(e+="M"),e}(a);o.length>0&&(i+=" "+o)}return 0===t.length?i+" EMPTY":i+"("+t+")"}const xt=zr;var on=f(3324),xe=f(5044),an=f(949),Te=f(6785);class Ve{constructor(n,e,t,i,o=null){this.counter=0,this.holePolygonDrawingStatus=!1,this.allFeatures=[],this.fillColor="#ffcc33",this.strokeColor="black",this.strokeWidth=2,this.deleted=!1,this.locked=!1,this.featuresSelected=[],this.featuresDeselected=[],this.zoomPadding=[100,100,100,100],this.maxZoom=14,this.map=n,this.layerName=e,this.geomType=t,this.groupId=o,this.id=rt(),this.zIndexValue=i,this.setLayer(),this.initSelect(),this.initTranslate(),this.initSnap(),this.initModifier(),this.map.addLayer(this.vectorLayer)}setLayer(){this.sourceFeatures=new te.Z,this.vectorLayer=new Je.Z({source:this.sourceFeatures,style:(n,e)=>bt(n)}),this.vectorLayer.set("name",this.layerName,!0),this.vectorLayer.set("geomType",this.geomType,!0),this.vectorLayer.setZIndex(this.zIndexValue)}removeLayer(){this.map.removeLayer(this.vectorLayer),this.deleted=!0}initSelect(){this.select=new on.Z({condition:R.V4,multi:!1,layers:[this.vectorLayer]})}initSnap(){this.snap=new Fr({source:this.sourceFeatures})}initTranslate(){this.translate=new Sr({features:this.select.getFeatures()})}enableTranslating(){this.map.addInteraction(this.translate)}disableTranslating(){this.map.removeInteraction(this.translate)}enableSelecting(){this.map.addInteraction(this.select)}disableSelecting(){this.map.removeInteraction(this.select)}initModifier(){this.modifier=new Or({features:this.select.getFeatures()}),this.modifier.on("modifyend",n=>{n.mapBrowserEvent.originalEvent.ctrlKey&&this.removeHoles(n),n.features.getArray().length>0&&n.features.getArray().forEach(e=>{this.updateFeature(e)})})}enableDrawing(n=!1){this.holePolygonDrawingStatus=n,this.draw=new Jr({type:this.geomType,stopClick:!1,source:this.vectorLayer.getSource()}),this.map.addInteraction(this.draw),this.map.addInteraction(this.snap),this.draw.on("drawstart",this.onDrawStart.bind(this)),this.draw.on("drawend",this.onDrawEnd.bind(this)),this.draw.on("drawabort",this.onDrawAborting.bind(this))}disableDrawing(){this.map.removeInteraction(this.draw),this.map.removeInteraction(this.snap)}enableEditing(){this.disableEditing(),this.map.addInteraction(this.modifier),this.map.addInteraction(this.snap)}disableEditing(){this.map.removeInteraction(this.modifier),this.map.removeInteraction(this.snap)}cleanEvents(){this.disableDrawing(),this.disableEditing(),this.disableSelecting()}onDrawAborting(n){this.holePolygonDrawingStatus&&void 0!==this.polygonIntersected&&(this.polygonIntersected.setGeometry(this.previousPolygonGeometry),this.polygonIntersected=void 0)}onDrawStart(n){var e;if(this.holePolygonDrawingStatus&&"Polygon"===(null===(e=n.feature.getGeometry())||void 0===e?void 0:e.getType())){let t=this.checkIfCoordIntersectLayer(n.feature);if(this.polygonIntersected=t,void 0===this.polygonIntersected)return n.target.abortDrawing(),this.onDrawAborting(n),void alert("An hole is possible only on a polygon!");if(void 0!==this.polygonIntersected){this.previousPolygonGeometry=this.polygonIntersected.getGeometry();const i=this.polygonIntersected.getGeometry();this.coordsLength=i.getCoordinates().length,n.feature.getGeometry().on("change",this.onGeomChangeBuildHole.bind(this))}}}checkIfCoordIntersectLayer(n){let e;return this.vectorLayer.getSource().forEachFeatureIntersectingExtent(n.getGeometry().getExtent(),t=>{e=t}),e}onDrawEnd(n){if(this.holePolygonDrawingStatus)return setTimeout(()=>{this.sourceFeatures.removeFeature(n.feature)},5),void 0!==this.polygonIntersected&&(n.feature.setGeometry(this.polygonIntersected.getGeometry()),this.select.getFeatures().clear()),void(this.polygonIntersected=void 0);this.addProperties(n.feature)}addProperties(n){var e;++this.counter;const t=rt();let i;return n.setId(t),i=void 0!==n.get("name")?n.get("name")+" copy":"feature "+this.counter,n.setProperties({id:n.getId(),layer_id:this.id,no:this.counter,name:i,geom_type:null===(e=n.getGeometry())||void 0===e?void 0:e.getType(),status:"added",created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()},!0),void 0===n.get("fill_color")&&n.set("fill_color",this.fillColor,!0),void 0===n.get("stroke_width")&&n.set("stroke_width",this.strokeWidth,!0),void 0===n.get("stroke_color")&&n.set("stroke_color",this.strokeColor,!0),n}addFeaturesAndUpdateIds(n){n.length>0&&n.forEach(e=>{let t=e.clone(),i=this.addProperties(t);this.sourceFeatures.addFeature(i)})}onGeomChangeBuildHole(n){if(void 0!==this.polygonIntersected){let t=this.polygonIntersected.getGeometry().getCoordinates(),i=new N.ZP(t.slice(0,this.coordsLength)),o=new jr.Z(n.target.getCoordinates()[0]);i.appendLinearRing(o),this.polygonIntersected.setGeometry(i)}}removeFeature(n){const e=this.sourceFeatures.getFeatureById(n);null!==e&&this.sourceFeatures.removeFeature(e)}duplicateFeature(n){const e=this.sourceFeatures.getFeatureById(n);if(null!==e){const t=this.addProperties(e.clone());this.sourceFeatures.addFeature(t),console.log(t)}}getFeatureAttribute(n,e){const t=this.sourceFeatures.getFeatureById(n);if(null!==t)return t.get(e)}features(){return this.deleted?[]:this.sourceFeatures.getFeatures().sort((e,t)=>e.get("no")-t.get("no"))}removeHoles(n){const e=n.features.getArray()[0],t=n.mapBrowserEvent.coordinate;if("Polygon"==e.getGeometry().getType()){const i=e.getGeometry().getLinearRings();if(i.length>1){let o=new te.Z;i.forEach((u,c)=>{const d=new D.Z(u.getCoordinates());let h=new A.Z({geometry:d});h.setId(c),o.addFeature(h)});const s=o.getClosestFeatureToCoordinate(t);let l=[];i.forEach((u,c)=>{c!==s.getId()&&l.push(u.getCoordinates())}),e.getGeometry().setCoordinates(l)}}}updateFeature(n){n.setProperties({updated_at:(new Date).toISOString(),status:"modified"},!0)}getOpacity(){return this.vectorLayer.getOpacity()}setOpacity(n){this.vectorLayer.setOpacity(n.target.valueAsNumber)}setName(n){this.layerName=n.target.value,this.vectorLayer.set("name",this.layerName,!0)}setStyleForAllFeatures(n,e){let t;"stroke_width"===e?t=n.target.value:(t=n,"fill_color"===e?this.fillColor=n:"stroke_color"===e&&(this.strokeColor=n)),this.features().forEach(i=>{i.set(e,t,!1)})}exportToGeoJSON(){let n=new tt;return JSON.stringify(JSON.parse(n.writeFeatures(this.features())),null,2)}exportToWkt(){let n=[];return this.features().forEach(e=>{n.push(He(e.getGeometry()))}),n.join("\n")}exportToPytestFixture(){let e=[];return void 0!==this.features()&&this.features().forEach(t=>{e.push("\n@pytest.fixture\ndef "+t.get("name").replace(" ","_")+"():\n\treturn '"+He(t.getGeometry())+"'")}),"import pytest\n"+e.join("\n")}zoomToLayer(){this.sourceFeatures.getFeatures().length>0&&this.map.getView().fit(this.sourceFeatures.getExtent(),{size:this.map.getSize(),maxZoom:this.maxZoom,padding:this.zoomPadding})}zoomToFeature(n){this.features().filter(e=>{e.getId()===n&&this.map.getView().fit(e.getGeometry(),{size:this.map.getSize(),maxZoom:this.maxZoom})})}}function Tt(a,n,e){let t=[];const i=a.findIndex(l=>l.id===n),o=a[i].zIndexValue,s=o+e;return s>=0&&s<a.length?(a.splice(s,0,a.splice(o,1)[0]),a.forEach((l,u)=>{l.zIndexValue=u,l.vectorLayer.setZIndex(u),t.push(l)}),t):a}function He(a){return(new xt).writeGeometry(a)}function bt(a){let n,e=a.getGeometry();if(void 0!==e){const t=a.get("fill_color"),i=a.get("stroke_width"),o=a.get("stroke_color");return"Point"===e.getType()?n=function cn(a,n,e){return new V.ZP({image:new an.Z({radius:7,fill:new xe.Z({color:a}),stroke:new Te.Z({color:e,width:n})})})}(t,i,o):"LineString"===e.getType()?n=function dn(a,n,e){return[new V.ZP({fill:new xe.Z({color:a}),stroke:new Te.Z({color:e,width:2*n})}),new V.ZP({fill:new xe.Z({color:a}),stroke:new Te.Z({color:a,width:n})})]}(t,i,o):"Polygon"===e.getType()&&(n=function hn(a,n,e){return new V.ZP({fill:new xe.Z({color:a}),stroke:new Te.Z({color:e,width:n})})}(t,i,o)),n}return new V.ZP}var Qe=f(534),ne=f(420);function gn(a,n){if(1&a&&(r.O4$(),r.TgZ(0,"svg",13),r._UZ(1,"circle",14),r.qZA()),2&a){const e=r.oxw();r.xp6(1),r.uIk("stroke",e.feature.get("stroke_color"))("stroke-width",e.feature.get("stroke_width"))("fill",e.feature.get("fill_color"))}}function yn(a,n){if(1&a&&(r.O4$(),r.TgZ(0,"svg",13),r._UZ(1,"line",15)(2,"line",15),r.qZA()),2&a){const e=r.oxw();r.xp6(1),r.uIk("stroke",e.feature.get("stroke_color"))("stroke-width",2*e.feature.get("stroke_width")),r.xp6(1),r.uIk("stroke",e.feature.get("fill_color"))("stroke-width",1.5*e.feature.get("stroke_width"))}}function _n(a,n){if(1&a&&(r.O4$(),r.TgZ(0,"svg",16),r._UZ(1,"rect",17),r.qZA()),2&a){const e=r.oxw();r.xp6(1),r.uIk("stroke",e.feature.get("stroke_color"))("stroke-width",e.feature.get("stroke_width"))("fill",e.feature.get("fill_color"))}}function mn(a,n){if(1&a){const e=r.EpF();r.TgZ(0,"div",18)(1,"div",19)(2,"div",20)(3,"strong"),r._uU(4),r.qZA(),r.TgZ(5,"em",21),r._uU(6),r.qZA(),r.TgZ(7,"em",6),r._uU(8),r.qZA(),r.TgZ(9,"button",22),r.NdJ("click",function(){return r.CHM(e),r.oxw().showPopup()}),r.qZA()(),r.TgZ(10,"div",23)(11,"div",24)(12,"span",25),r._uU(13,"Actions :"),r.qZA(),r.TgZ(14,"span",26),r.NdJ("click",function(){r.CHM(e);const i=r.oxw();return i.copyToClipboard(i.getWktFromFeature(i.feature))}),r._uU(15," WKT "),r.qZA()(),r.TgZ(16,"div",27)(17,"span"),r._uU(18),r.ALo(19,"date"),r.qZA(),r.TgZ(20,"span"),r._uU(21),r.ALo(22,"date"),r.qZA()(),r.TgZ(23,"div",28)(24,"h6",5),r._uU(25,"Style"),r.qZA(),r.TgZ(26,"div",29)(27,"span",30),r._uU(28,"Couleur de fond :"),r.qZA(),r.TgZ(29,"input",31,32),r.NdJ("change",function(){r.CHM(e);const i=r.MAs(30);return r.oxw().updateFillColor(i.value)}),r.qZA(),r._UZ(31,"label"),r.qZA(),r.TgZ(32,"div",29)(33,"span",30),r._uU(34,"Couleur du contour :"),r.qZA(),r.TgZ(35,"input",33,34),r.NdJ("change",function(){r.CHM(e);const i=r.MAs(36);return r.oxw().updateStrokeColor(i.value)}),r.qZA(),r._UZ(37,"label"),r.qZA(),r.TgZ(38,"div",29)(39,"span",30),r._uU(40,"Epaisseur du contour :"),r.qZA(),r.TgZ(41,"input",35),r.NdJ("change",function(i){return r.CHM(e),r.oxw().updateStrokeWidth(i)}),r.qZA()()(),r.TgZ(42,"span",5),r._uU(43),r.qZA()()()()}if(2&a){const e=r.oxw();r.Q6J("id","featurePopup"+e.feature.getId()),r.xp6(4),r.Oqu(e.feature.get("name")),r.xp6(2),r.hij("(",e.feature.get("geom_type"),")"),r.xp6(2),r.hij("Couche: ",e.currentLayer.layerName,""),r.xp6(10),r.hij("Cr\xe9\xe9 \xe0 ",r.xi3(19,14,e.feature.get("created_at"),"HH:mm:ss"),""),r.xp6(3),r.hij("Modifi\xe9 \xe0 ",r.xi3(22,17,e.feature.get("updated_at"),"HH:mm:ss"),""),r.xp6(8),r.Q6J("id","fillColor-"+e.feature.getId())("value",e.feature.get("fill_color")),r.xp6(2),r.uIk("for","fillColor-"+e.feature.getId()),r.xp6(4),r.Q6J("id","strokeColor-"+e.feature.getId())("value",e.feature.get("stroke_color")),r.xp6(2),r.uIk("for","strokeColor-"+e.feature.getId()),r.xp6(4),r.Q6J("value",e.currentStrokeWidth),r.xp6(2),r.Oqu(e.getWktFromFeature(e.feature))}}let vn=(()=>{class a{constructor(e){this.elementRef=e,this.disabledIcon=v.g82,this.duplicateIcon=Qe.WM4,this.centerIcon=v.TL5,this.paramIcon=v.gr5,this.displayPopup=!1}ngOnInit(){this.currentFillColor=this.feature.get("fill_color"),this.currentStrokeColor=this.feature.get("stroke_color"),this.currentStrokeWidth=this.feature.get("stroke_width")}ngOnDestroy(){this.elementRef.nativeElement.remove()}ngOnChanges(e){e.currentFeatureIdSelected&&e.currentFeatureIdSelected.currentValue!==this.feature.getId()&&(this.displayPopup=!1)}removeFeature(){this.currentLayer.removeFeature(this.feature.getId())}duplicateFeature(){this.currentLayer.select.getFeatures().clear(),this.currentLayer.duplicateFeature(this.feature.getId())}showPopup(){this.displayPopup=!this.displayPopup}copyToClipboard(e){const t=document.createElement("textarea");t.style.position="fixed",t.style.left="0",t.style.top="0",t.style.opacity="0",t.value=e,document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy"),document.body.removeChild(t)}updateFillColor(e){this.feature.set("fill_color",e,!1)}updateStrokeWidth(e){this.feature.set("stroke_width",e.target.value,!0)}updateStrokeColor(e){this.feature.set("stroke_color",e,!0)}zoomToFeature(){this.currentLayer.zoomToFeature(this.feature.getId())}getWktFromFeature(e){return He(e.getGeometry())}}return a.\u0275fac=function(e){return new(e||a)(r.Y36(r.SBq))},a.\u0275cmp=r.Xpm({type:a,selectors:[["app-feature"]],inputs:{feature:"feature",currentFeatureIdSelected:"currentFeatureIdSelected",currentLayer:"currentLayer"},features:[r.TTD],decls:18,vars:9,consts:[[1,"feature","py-0","d-flex","justify-content-between","align-items-center","pointer"],[1,"d-flex","flex-row","pointer","justify-content-start","align-items-center","flex-fill"],[1,"m-1"],["height","25","width","25",4,"ngIf"],["height","15","width","25",4,"ngIf"],[1,""],[1,"ms-auto"],["ngbPopover","Center sur l'object","triggers","mouseenter:mouseleave",1,"ms-auto","btn","p-1","bg-transparent","border-0",3,"click"],["size","xs",1,"",3,"icon"],["ngbPopover","Dupliquer l'object","triggers","mouseenter:mouseleave",1,"ms-auto","btn","p-1","bg-transparent","border-0",3,"click"],["ngbPopover","Supprimer l'object","triggers","mouseenter:mouseleave",1,"btn","m-0","bg-transparent","border-0","text-danger",3,"click"],["ngbPopover","Options de l'objet","triggers","mouseenter:mouseleave",1,"p-1","bg-transparent","border-0","text-black",3,"click"],["class","featureToasts position-fixed bottom-0 end-0 p-3 d-flex flex-row overflow-auto fw-normal pointer-none","style","z-index: 11",3,"id",4,"ngIf"],["height","25","width","25"],["cx","12","cy","12","r","8"],["x1","0","y1","10","x2","25","y2","10"],["height","15","width","25"],["x","0","y","0","width","25","height","15"],[1,"featureToasts","position-fixed","bottom-0","end-0","p-3","d-flex","flex-row","overflow-auto","fw-normal","pointer-none",2,"z-index","11",3,"id"],["role","alert","aria-live","assertive","aria-atomic","true",1,"toast","toastFeature","faded"],[1,"toast-header","justify-content-between"],[1,"ms-2","me-auto","me-auto"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"toast-body","bg-white"],["id","toastActions",1,"d-flex","flex-row","justify-content-start","align-items-center"],[1,"fw-bold"],["data-bs-toggle","tooltip","data-bs-placement","bottom","title","Copier le WKT",1,"badge","bg-dark","rounded","m-1","small","pointer",3,"click"],[1,"d-flex","flex-row","justify-content-between"],[1,"d-flex","flex-column","my-3"],[1,"d-flex","flex-row","ms-2","my-1"],[1,"me-2"],["type","color",1,"fillColor","m-1","pointer",3,"id","value","change"],["fillColor",""],["type","color",1,"strokeColor","m-1","pointer",3,"id","value","change"],["strokeColor",""],["type","number","min","0","max","12",1,"small","strokeWidth",3,"value","change"]],template:function(e,t){1&e&&(r.TgZ(0,"li",0)(1,"div",1)(2,"div",2),r.YNc(3,gn,2,3,"svg",3),r.YNc(4,yn,3,4,"svg",3),r.YNc(5,_n,2,3,"svg",4),r.qZA(),r.TgZ(6,"div",5),r._uU(7),r.qZA(),r.TgZ(8,"div",6)(9,"button",7),r.NdJ("click",function(){return t.zoomToFeature()}),r._UZ(10,"fa-icon",8),r.qZA(),r.TgZ(11,"button",9),r.NdJ("click",function(){return t.duplicateFeature()}),r._UZ(12,"fa-icon",8),r.qZA(),r.TgZ(13,"button",10),r.NdJ("click",function(){return t.removeFeature()}),r._UZ(14,"fa-icon",8),r.qZA(),r.TgZ(15,"button",11),r.NdJ("click",function(){return t.showPopup()}),r._UZ(16,"fa-icon",8),r.qZA()()()(),r.YNc(17,mn,44,20,"div",12)),2&e&&(r.xp6(3),r.Q6J("ngIf","Point"===t.feature.get("geom_type")),r.xp6(1),r.Q6J("ngIf","LineString"===t.feature.get("geom_type")),r.xp6(1),r.Q6J("ngIf","Polygon"===t.feature.get("geom_type")),r.xp6(2),r.hij(" ",t.feature.get("name")," "),r.xp6(3),r.Q6J("icon",t.centerIcon),r.xp6(2),r.Q6J("icon",t.duplicateIcon),r.xp6(2),r.Q6J("icon",t.disabledIcon),r.xp6(2),r.Q6J("icon",t.paramIcon),r.xp6(1),r.Q6J("ngIf",(t.currentLayer.id===t.feature.get("layer_id")||t.currentFeatureIdSelected===t.feature.getId())&&t.displayPopup))},directives:[M.O5,ne.o8,q.BN],pipes:[M.uU],styles:[".pointer[_ngcontent-%COMP%]{cursor:pointer}.pointer-none[_ngcontent-%COMP%]{cursor:auto}.feature[_ngcontent-%COMP%]:hover{font-weight:700}.toast[_ngcontent-%COMP%]{opacity:0;display:unset!important;transition:opacity .5s}.faded[_ngcontent-%COMP%]{opacity:1!important;transition:opacity .5s!important}"]}),a})();function Cn(a,n){if(1&a&&r._UZ(0,"fa-icon",53),2&a){const e=r.oxw();r.Q6J("icon",e.pointIcon)}}function xn(a,n){if(1&a&&r._UZ(0,"fa-icon",53),2&a){const e=r.oxw();r.Q6J("icon",e.lineStringIcon)}}function Tn(a,n){if(1&a&&r._UZ(0,"fa-icon",53),2&a){const e=r.oxw();r.Q6J("icon",e.polygonIcon)}}function bn(a,n){if(1&a){const e=r.EpF();r.ynx(0),r.TgZ(1,"app-feature",60),r.NdJ("click",function(){const o=r.CHM(e).$implicit;return r.oxw(2).selectFeatureById(o.getId())}),r.qZA(),r.BQk()}if(2&a){const e=n.$implicit,t=r.oxw(2);r.xp6(1),r.Q6J("ngClass",t.featureIdSelected==e.getId()?"fw-bold bg-secondary bg-opacity-25":"")("currentFeatureIdSelected",t.featureIdSelected)("feature",e)("currentLayer",t.layer)}}function wn(a,n){if(1&a){const e=r.EpF();r.TgZ(0,"div",54)(1,"ul",55)(2,"li",56),r.NdJ("click",function(){return r.CHM(e),r.oxw().unSelectFeature()}),r.TgZ(3,"div",57)(4,"div",13),r._UZ(5,"fa-icon",58),r.qZA(),r.TgZ(6,"div",13),r._uU(7," D\xe9sel\xe9ctionner "),r.qZA()()(),r.YNc(8,bn,2,4,"ng-container",59),r.qZA()()}if(2&a){const e=r.oxw();r.xp6(1),r.Q6J("id","featuresLayer-"+e.layer.id),r.xp6(1),r.Q6J("ngClass","none"==e.featureIdSelected&&e.isSelected?"fw-bold bg-secondary bg-opacity-25":""),r.xp6(3),r.Q6J("icon",e.disabledIcon),r.xp6(3),r.Q6J("ngForOf",e.layer.features())}}let Ln=(()=>{class a{constructor(e,t){this.elementRef=e,this.interactionsService=t,this.layerIdCurrentlySelected=new r.vpe,this.layerMoveUp=new r.vpe,this.layerMoveDown=new r.vpe,this.layerCloned=new r.vpe,this.removeLayerId=new r.vpe,this.groupIcon=v.Krp,this.helpIcon=v.FDd,this.addIcon=v.EQ8,this.editIcon=v.TzT,this.paramIcon=v.gr5,this.disabledIcon=v.g82,this.EditIcon=v.diR,this.pointIcon=v.diR,this.lineStringIcon=v.fQK,this.polygonIcon=v.ubJ,this.visibleIcon=v.Mdf,this.invisibleIcon=v.Aq,this.upIcon=v.l1h,this.downIcon=v.eW2,this.duplicateIcon=Qe.WM4,this.centerIcon=v.TL5,this.lockIcon=v.byT,this.unLockIcon=v._1N,this.isVisible=!0,this.isDrawn=!1,this.isEdited=!1,this.isShown=!1,this.isHole=!1,this.isLocked=!1,this.displayLayerModal=!1,this.exportData="",this.exportDataMode="geojson",this.removeLayerSubscription=this.interactionsService.removeLayers.subscribe(i=>{this.removeLayer()}),this.selectableLayerStatusSubscription=this.interactionsService.selectableLayerId.subscribe(i=>{this.layer.id!==i?this.layer.disableSelecting():(this.layer.disableSelecting(),this.layer.enableSelecting())}),this.selectableAllLayersStatusSubscription=this.interactionsService.selectableAllLayers.subscribe(i=>{this.layer.disableSelecting(),this.layer.enableSelecting()})}ngOnInit(){this.layer.enableSelecting(),this.layer.select.on("select",e=>{let i=e.selected;e.deselected.length>0&&0===i.length&&this.unSelectFeature(),i.length>0&&i.forEach(o=>{this.selectFeatureById(o.getId())})}),this.layer.sourceFeatures.on("changefeature",e=>{bt(e.feature)})}ngOnDestroy(){let e=document.getElementById("modalLayer-"+this.layer.id);null!==e&&e.remove();let t=document.getElementById("modalWktLayer-"+this.layer.id);null!==t&&t.remove(),this.removeLayerSubscription.unsubscribe(),this.selectableLayerStatusSubscription.unsubscribe(),this.selectableAllLayersStatusSubscription.unsubscribe(),this.layer.disableSelecting(),this.elementRef.nativeElement.remove()}ngOnChanges(e){e.isSelected&&(e.isSelected.currentValue||this.unSelectFeature()),e.isLocked&&this.layer.locked!==e.isLocked.currentValue&&this.lockingLayer(e.isLocked.currentValue),e.isVisible&&this.visibleHandler(e.isVisible.currentValue)}visibleHandler(e){this.isVisible=e,this.layer.vectorLayer.setVisible(e)}lockingLayer(e){this.isLocked=e,this.layer.locked=this.isLocked,this.isSelected&&this.interactionsService.activateEditBar(!this.layer.locked)}removeLayer(){this.layer.removeLayer(),this.removeLayerId.emit(this.layer.id),this.ngOnDestroy()}layerGoUp(){this.layerMoveUp.emit(this.layer.id)}layerGoDown(){this.layerMoveDown.emit(this.layer.id)}selectLayer(){this.interactionsService.sendSelectedLayerId(this.layer.id),this.interactionsService.sendSelectedLayer(this.layer)}zoomToLayer(){this.layer.zoomToLayer()}duplicateLayer(){this.unSelectFeature();const e=Object.create(this.layer);this.layerCloned.emit(e)}hideModalLayer(){this.displayLayerModal=!1}moveModalToBody(){this.displayLayerModal=!0,this.exportBuilder(this.exportDataMode);let e=document.getElementById("modalLayer-"+this.layer.id);if(null!==e){let t=document.body;null!==t&&t.appendChild(e)}}exportBuilder(e){this.exportDataMode=e,"wkt"===e?this.exportData=this.layer.exportToWkt():"geojson"===e?this.exportData=this.layer.exportToGeoJSON():"pytestFixture"===e&&(this.exportData=this.layer.exportToPytestFixture())}unSelectFeature(){this.featureIdSelected="none",this.layer.select.getFeatures().clear()}selectFeatureById(e){this.featureIdSelected=e;let t=this.getFeature(this.featureIdSelected);this.layer.select.getFeatures().clear(),this.layer.select.getFeatures().push(t),this.selectLayer()}getFeature(e){let t=this.layer.features().filter(i=>i.getId()===e);return 1===t.length?t[0]:null}}return a.\u0275fac=function(e){return new(e||a)(r.Y36(r.SBq),r.Y36(ae))},a.\u0275cmp=r.Xpm({type:a,selectors:[["app-layer"]],inputs:{layer:"layer",isSelected:"isSelected",layersVisibleStatus:"layersVisibleStatus",isVisible:"isVisible",isLocked:"isLocked"},outputs:{layerIdCurrentlySelected:"layerIdCurrentlySelected",layerMoveUp:"layerMoveUp",layerMoveDown:"layerMoveDown",layerCloned:"layerCloned",removeLayerId:"removeLayerId"},features:[r.TTD],decls:102,vars:53,consts:[[1,"layer","pointer","d-flex","flex-column","small","mt-1","mx-1","px-1","align-items-around"],[1,"d-flex","flex-row","border","rounded",3,"ngClass"],[1,"d-flex","flex-row","justify-content-start","align-items-center","me-1"],["type","checkbox",1,"btn-check",3,"id","checked","click"],["btnVisible",""],["container","body","triggers","mouseenter:mouseleave",1,"p-1","bg-transparent","border-0","pointer",3,"for","ngClass","ngbPopover"],["size","xs",1,"",3,"icon"],["btnLocked",""],["container","body","triggers","mouseenter:mouseleave",1,"ms-auto","p-1","bg-transparent","border-0","pointer",3,"for","ngbPopover"],[1,"d-flex","flex-column",3,"ngClass"],["container","body","ngbPopover","Remonter","triggers","mouseenter:mouseleave",1,"p-0","bg-transparent","border-0","text-danger",3,"click"],["container","body","ngbPopover","Descendre","triggers","mouseenter:mouseleave",1,"p-0","bg-transparent","border-0","text-danger",3,"click"],[1,"d-flex","flex-row","pointer","justify-content-start","align-items-center","flex-fill","p-1",3,"ngClass","click"],[1,""],["class","me-2","size","xs",3,"icon",4,"ngIf"],[1,"layer-name"],[1,"ms-auto","d-flex","flex-row",3,"ngClass"],["ngbPopover","Dupliquer","triggers","mouseenter:mouseleave",1,"ms-auto","p-1","bg-transparent","border-0",3,"click"],["ngbPopover","Supprimer","triggers","mouseenter:mouseleave",1,"ms-auto","p-1","bg-transparent","border-0","text-danger",3,"ngClass","click"],[1,"ms-auto","d-flex","flex-row"],["ngbPopover","Centrer","triggers","mouseenter:mouseleave",1,"ms-auto","p-1","bg-transparent","border-0",3,"click"],["data-bs-toggle","modal","ngbPopover","Options de la couche","triggers","mouseenter:mouseleave",1,"p-1","bg-transparent","border-0","text-black",3,"click"],["class","d-flex flex-row small mb-1",4,"ngIf"],["data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","fade",3,"id"],[1,"modal-dialog","modal-lg","modal-dialog-scrollable"],[1,"modal-content"],[1,"modal-header"],["id","staticBackdropLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"d-flex","flex-column","my-3",3,"ngClass"],[1,"d-flex","flex-row","ms-2"],[1,"me-2"],["type","text","aria-label","layerName",1,"form-control",3,"placeholder","change"],[1,"d-flex","flex-row","ms-2","my-1"],["id","","type","range","min","0","max","1","step","0.1",1,"small","opacity-setter",3,"value","change"],["type","color",1,"fillColor","m-1","pointer",3,"id","value","change"],["layerFillColor",""],["layerStrokeColor",""],["type","number","min","0","max","12",1,"small","strokeWidth",3,"value","change"],[1,"d-flex","flex-column","my-3"],["role","tablist",1,"nav","nav-pills","align-items-center","justify-content-center"],["role","presentation",1,"nav-item","border","m-1"],["data-bs-toggle","tab","type","button","role","tab",1,"nav-link","fw-bold","active",3,"click"],["data-bs-toggle","tab","type","button","role","tab",1,"nav-link","fw-bold",3,"click"],["id","'tabContent' + layer.id",1,"d-flex","flex-row","mx-2","tab-content"],["role","tabpanel",1,"tab-pane","fade","w-100","show",3,"ngClass","id"],["aria-label","With textarea","readonly","",1,"form-control","vh-100",3,"click"],["exportGeoJsonStringGeomDiv",""],["exportWktStringGeomDiv",""],["exportPytestFixturesGeomDiv",""],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["size","xs",1,"me-2",3,"icon"],[1,"d-flex","flex-row","small","mb-1"],["id","featuresList",1,"w-100","list-group","list-group-flush","mx-3","border","rounded",3,"id"],[1,"feature","py-0","d-flex","justify-content-between","align-items-center","pointer",3,"ngClass","click"],[1,"d-flex","flex-row","pointer","justify-content-start","align-items-center","flex-fill","m-1"],[1,"me-1",3,"icon"],[4,"ngFor","ngForOf"],[3,"ngClass","currentFeatureIdSelected","feature","currentLayer","click"]],template:function(e,t){if(1&e){const i=r.EpF();r.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"input",3,4),r.NdJ("click",function(){r.CHM(i);const s=r.MAs(4);return t.visibleHandler(s.checked)}),r.qZA(),r.TgZ(5,"label",5),r._UZ(6,"fa-icon",6),r.qZA(),r.TgZ(7,"input",3,7),r.NdJ("click",function(){r.CHM(i);const s=r.MAs(8);return t.lockingLayer(s.checked)}),r.qZA(),r.TgZ(9,"label",8),r._UZ(10,"fa-icon",6),r.qZA(),r.TgZ(11,"div",9)(12,"button",10),r.NdJ("click",function(){return t.layerGoUp()}),r._UZ(13,"fa-icon",6),r.qZA(),r.TgZ(14,"button",11),r.NdJ("click",function(){return t.layerGoDown()}),r._UZ(15,"fa-icon",6),r.qZA()()(),r.TgZ(16,"div",12),r.NdJ("click",function(){return t.selectLayer()}),r.TgZ(17,"div",13),r.YNc(18,Cn,1,1,"fa-icon",14),r.YNc(19,xn,1,1,"fa-icon",14),r.YNc(20,Tn,1,1,"fa-icon",14),r.qZA(),r.TgZ(21,"div",15)(22,"span"),r._uU(23),r.qZA()()(),r.TgZ(24,"div",16)(25,"button",17),r.NdJ("click",function(){return t.duplicateLayer()}),r._UZ(26,"fa-icon",6),r.qZA(),r.TgZ(27,"button",18),r.NdJ("click",function(){return t.removeLayer()}),r._UZ(28,"fa-icon",6),r.qZA()(),r.TgZ(29,"div",19)(30,"button",20),r.NdJ("click",function(){return t.zoomToLayer()}),r._UZ(31,"fa-icon",6),r.qZA(),r.TgZ(32,"button",21),r.NdJ("click",function(){return t.moveModalToBody()}),r._UZ(33,"fa-icon",6),r.qZA()()(),r.YNc(34,wn,9,4,"div",22),r.qZA(),r.TgZ(35,"div",23)(36,"div",24)(37,"div",25)(38,"div",26)(39,"h5",27),r._uU(40),r.qZA(),r.TgZ(41,"button",28),r.NdJ("click",function(){return t.hideModalLayer()}),r.qZA()(),r.TgZ(42,"div",29)(43,"div",30)(44,"h4",13),r._uU(45,"G\xe9n\xe9ral"),r.qZA(),r.TgZ(46,"div",31)(47,"span",32),r._uU(48,"Nom de la couche :"),r.qZA(),r.TgZ(49,"input",33),r.NdJ("change",function(s){return t.layer.setName(s)}),r.qZA()()(),r.TgZ(50,"div",30)(51,"h4",13),r._uU(52,"Style"),r.qZA(),r.TgZ(53,"div",34)(54,"span",32),r._uU(55,"Opacit\xe9 :"),r.qZA(),r.TgZ(56,"input",35),r.NdJ("change",function(s){return t.layer.setOpacity(s)}),r.qZA()(),r.TgZ(57,"div",34)(58,"span",32),r._uU(59,"Couleur de fond :"),r.qZA(),r.TgZ(60,"input",36,37),r.NdJ("change",function(){r.CHM(i);const s=r.MAs(61);return t.layer.setStyleForAllFeatures(s.value,"fill_color")}),r.qZA(),r._UZ(62,"label"),r.qZA(),r.TgZ(63,"div",34)(64,"span",32),r._uU(65,"Couleur du contour :"),r.qZA(),r.TgZ(66,"input",36,38),r.NdJ("change",function(){r.CHM(i);const s=r.MAs(67);return t.layer.setStyleForAllFeatures(s.value,"stroke_color")}),r.qZA(),r._UZ(68,"label"),r.qZA(),r.TgZ(69,"div",34)(70,"span",32),r._uU(71,"Epaisseur du contour :"),r.qZA(),r.TgZ(72,"input",39),r.NdJ("change",function(s){return t.layer.setStyleForAllFeatures(s,"stroke_width")}),r.qZA()()(),r.TgZ(73,"div",40)(74,"h4",13),r._uU(75,"Export"),r.qZA(),r.TgZ(76,"ul",41)(77,"li",42)(78,"a",43),r.NdJ("click",function(){return t.exportBuilder("geojson")}),r._uU(79," GeoJSON "),r.qZA()(),r.TgZ(80,"li",42)(81,"a",44),r.NdJ("click",function(){return t.exportBuilder("wkt")}),r._uU(82," WKT "),r.qZA()(),r.TgZ(83,"li",42)(84,"a",44),r.NdJ("click",function(){return t.exportBuilder("pytestFixture")}),r._uU(85," Pytest Fixtures "),r.qZA()()(),r.TgZ(86,"div",45)(87,"div",46)(88,"textarea",47,48),r.NdJ("click",function(){return r.CHM(i),r.MAs(89).select()}),r._uU(90),r.qZA()(),r.TgZ(91,"div",46)(92,"textarea",47,49),r.NdJ("click",function(){return r.CHM(i),r.MAs(93).select()}),r._uU(94),r.qZA()(),r.TgZ(95,"div",46)(96,"textarea",47,50),r.NdJ("click",function(){return r.CHM(i),r.MAs(97).select()}),r._uU(98),r.qZA()()()()(),r.TgZ(99,"div",51)(100,"button",52),r._uU(101,"Fermer"),r.qZA()()()()()}if(2&e){const i=r.MAs(4),o=r.MAs(8),s=r.MAs(67);r.xp6(1),r.Q6J("ngClass",t.isSelected?"border-dark border-2":""),r.xp6(2),r.Q6J("id","btnVisible"+t.layer.id)("checked",t.isVisible),r.xp6(2),r.Q6J("for","btnVisible"+t.layer.id)("ngClass",i.checked?"text-success":"text-danger")("ngbPopover",i.checked?"Masquer":"Afficher"),r.xp6(1),r.Q6J("icon",i.checked?t.visibleIcon:t.invisibleIcon),r.xp6(1),r.Q6J("id","btnLocked"+t.layer.id)("checked",t.isLocked),r.xp6(2),r.Q6J("for","btnLocked"+t.layer.id)("ngbPopover",o.checked?"D\xe9verrouiler":"Verrouiller"),r.xp6(1),r.Q6J("icon",o.checked?t.lockIcon:t.unLockIcon),r.xp6(1),r.Q6J("ngClass",t.isSelected?"pe-auto":"pe-none"),r.xp6(2),r.Q6J("icon",t.upIcon),r.xp6(2),r.Q6J("icon",t.downIcon),r.xp6(1),r.Q6J("ngClass",t.isSelected?"fw-bold":"text-black"),r.xp6(2),r.Q6J("ngIf","Point"===t.layer.geomType),r.xp6(1),r.Q6J("ngIf","LineString"===t.layer.geomType),r.xp6(1),r.Q6J("ngIf","Polygon"===t.layer.geomType),r.xp6(3),r.Oqu(t.layer.layerName),r.xp6(1),r.Q6J("ngClass",t.isSelected?"d-block":"d-none"),r.xp6(2),r.Q6J("icon",t.duplicateIcon),r.xp6(1),r.Q6J("ngClass",t.layer.locked?"pe-none":"pe-auto"),r.xp6(1),r.Q6J("icon",t.disabledIcon),r.xp6(3),r.Q6J("icon",t.centerIcon),r.xp6(1),r.uIk("data-bs-target","#modalLayer-"+t.layer.id),r.xp6(1),r.Q6J("icon",t.paramIcon),r.xp6(1),r.Q6J("ngIf",t.layer.features().length>0),r.xp6(1),r.Q6J("id","modalLayer-"+t.layer.id),r.xp6(5),r.Oqu(t.layer.layerName),r.xp6(3),r.Q6J("ngClass",t.layer.locked?"pe-none":"pe-auto"),r.xp6(6),r.Q6J("placeholder",t.layer.layerName),r.xp6(1),r.Q6J("ngClass",t.layer.locked?"pe-none":"pe-auto"),r.xp6(6),r.Q6J("value",t.layer.getOpacity()),r.xp6(4),r.Q6J("id","fillColor-"+t.layer.id)("value",t.layer.fillColor),r.xp6(2),r.uIk("for","fillColor-"+t.layer.id),r.xp6(4),r.Q6J("id","strokeColor-"+t.layer.id)("value",s.value),r.xp6(2),r.uIk("for","strokeColor-"+t.layer.id),r.xp6(4),r.Q6J("value",t.layer.strokeWidth),r.xp6(6),r.uIk("data-bs-target","#GeoJsonTab"+t.layer.id),r.xp6(3),r.uIk("data-bs-target","#wktTab"+t.layer.id),r.xp6(3),r.uIk("data-bs-target","#pytestFixture"+t.layer.id),r.xp6(3),r.Q6J("ngClass","geojson"===t.exportDataMode?"active":"")("id","GeoJsonTab"+t.layer.id),r.xp6(3),r.Oqu(t.exportData),r.xp6(1),r.Q6J("ngClass","wkt"===t.exportDataMode?"active":"")("id","wktTab"+t.layer.id),r.xp6(3),r.Oqu(t.exportData),r.xp6(1),r.Q6J("ngClass","pytestFixture"===t.exportDataMode?"active":"")("id","pytestFixture"+t.layer.id),r.xp6(3),r.Oqu(t.exportData)}},directives:[M.mk,ne.o8,q.BN,M.O5,M.sg,vn],styles:[".layer[_ngcontent-%COMP%]:hover   .layer-name[_ngcontent-%COMP%], .feature[_ngcontent-%COMP%]:hover{font-weight:700}.toast[_ngcontent-%COMP%]{opacity:0;display:unset!important;transition:opacity .5s}.faded[_ngcontent-%COMP%]{opacity:1!important;transition:opacity .5s!important}.pointer[_ngcontent-%COMP%]{cursor:pointer}.colorPicker[_ngcontent-%COMP%]{width:10px;height:25px;cursor:pointer}"]}),a})();const Pn=["exportStringGeomDiv"],Fn=["layersListDiv"];function En(a,n){if(1&a){const e=r.EpF();r.ynx(0),r.TgZ(1,"button",34),r.NdJ("click",function(){const o=r.CHM(e).$implicit;return r.oxw().addLayer(o.mode)}),r._UZ(2,"fa-icon",35),r.qZA(),r.BQk()}if(2&a){const e=n.$implicit;r.xp6(1),r.Q6J("ngbPopover",e.label),r.xp6(1),r.Q6J("icon",e.icon)}}function Sn(a,n){if(1&a){const e=r.EpF();r.ynx(0),r.TgZ(1,"button",36),r.NdJ("click",function(){const o=r.CHM(e).$implicit;return r.oxw().setImportDataType(o.label_text)}),r._UZ(2,"fa-icon",37),r._uU(3),r.qZA(),r.BQk()}if(2&a){const e=n.$implicit;r.xp6(1),r.Q6J("ngbPopover",e.label),r.xp6(1),r.Q6J("icon",e.icon),r.xp6(1),r.hij("",e.label_text," ")}}function In(a,n){if(1&a){const e=r.EpF();r.ynx(0),r.TgZ(1,"app-layer",38),r.NdJ("layerMoveUp",function(i){return r.CHM(e),r.oxw().layerGoUp(i)})("layerMoveDown",function(i){return r.CHM(e),r.oxw().layerGoDown(i)})("layerCloned",function(i){return r.CHM(e),r.oxw().duplicateLayer(i)})("removeLayerId",function(i){return r.CHM(e),r.oxw().removeLayer(i)}),r.qZA(),r.BQk()}if(2&a){const e=n.$implicit,t=r.oxw();r.xp6(1),r.Q6J("layer",e)("isSelected",t.currentLayerIdSelected==e.id)("isVisible",t.forceVisibleStatus)("isLocked",t.layersLockStatus)}}function Mn(a,n){if(1&a&&(r.TgZ(0,"option",39),r._uU(1),r.qZA()),2&a){const e=n.$implicit;r.Q6J("value",e),r.xp6(1),r.Oqu(e)}}function kn(a,n){if(1&a&&(r.TgZ(0,"option",39),r._uU(1),r.qZA()),2&a){const e=n.$implicit;r.Q6J("value",e.id),r.xp6(1),r.hij("Importer dans la couche : ",e.layerName,"")}}let On=(()=>{class a{constructor(e,t){this.mapService=e,this.interactionsService=t,this.disabledIcon=v.g82,this.pointIcon=v.diR,this.lineStringIcon=v.fQK,this.polygonIcon=v.ubJ,this.loadIcon=v.cf$,this.visibleIcon=Qe.Mdf,this.invisibleIcon=v.Aq,this.centerIcon=v.TL5,this.lockIcon=v.byT,this.unLockIcon=v._1N,this.forceVisibleStatus=!0,this.layersLockStatus=!1,this.existingLayers=[],this.allLayers=[],this.layerNamedIncrement=-1,this.createModesSupported=[{mode:"Point",label:"Ajouter une couche de Points",icon:this.pointIcon},{mode:"LineString",label:"Ajouter une couche de LineString",icon:this.lineStringIcon},{mode:"Polygon",label:"Ajouter une couche de Polygones",icon:this.polygonIcon}],this.createFromModesSupported=[{mode:"GeoJSON",label:"Importer un GeoJSON",label_text:"GeoJSON",icon:this.loadIcon},{mode:"WKT",label:"Importer un/des WKT(s)",label_text:"WKT(s)",icon:this.loadIcon}],this.strInputDataValues=null,this.strInputEpsgInput=null,this.modeImportInput="new",this.zoomPadding=[100,100,100,100],this.epsgChangesSubscription=this.mapService.setMapProjectionFromEpsg.subscribe(i=>{this.existingLayers.forEach(o=>{o.features().forEach(s=>{s.setGeometry(s.getGeometry().transform(this.currentEpsg,i))})}),this.currentEpsg=i}),this.layerIdSelectedSubscription=this.interactionsService.layerIdSelected.subscribe(i=>{this.currentLayerIdSelected=i})}ngOnInit(){this.moveImportDataModalToBody()}ngOnDestroy(){this.existingLayers.forEach(e=>{this.map.removeLayer(e.vectorLayer),e.cleanEvents()}),this.epsgChangesSubscription.unsubscribe(),this.layerIdSelectedSubscription.unsubscribe()}ngOnChanges(e){e.layersListDiv&&this.refreshLayers()}addLayer(e,t=null){const i=++this.layerNamedIncrement;let o=new Ve(this.map,"layer "+i,e,i,t);this.existingLayers.push(o),this.refreshLayers()}duplicateLayer(e){let i=new Ve(this.map,e.layerName+" copy",e.geomType,this.existingLayers.length,null);i.addFeaturesAndUpdateIds(e.features()),this.existingLayers.push(i),this.refreshLayers()}addLayerFromFeatures(e,t){const i=++this.layerNamedIncrement;let o=new Ve(this.map,"layer "+i,e,i,null);o.addFeaturesAndUpdateIds(t),this.existingLayers.push(o),this.refreshLayers()}layerGoUp(e){this.existingLayers=Tt(this.existingLayers,e,1),this.refreshLayers()}layerGoDown(e){this.existingLayers=Tt(this.existingLayers,e,-1),this.refreshLayers()}removeLayer(e){this.existingLayers=this.existingLayers.filter(t=>t.id!==e),this.buildLayersIndexes()}getLayerFromId(e){return this.existingLayers.filter(i=>i.id===e)[0]}refreshLayers(){this.allLayers=this.existingLayers.filter(e=>!e.deleted).sort((e,t)=>e.zIndexValue>t.zIndexValue?-1:1)}unSelectLayer(){this.interactionsService.sendSelectedLayerId("none"),this.interactionsService.sendSelectedLayer(null)}buildLayersIndexes(){let e=this.existingLayers;this.existingLayers=[],e.forEach((t,i)=>{t.zIndexValue=i,t.vectorLayer.setZIndex(i),this.existingLayers.push(t)})}moveImportDataModalToBody(){let e=document.getElementById("modalDataImport");if(null!==e){let t=document.body;null!==t&&t.appendChild(e)}}setImportDataType(e){this.importDataType=e}importFromFormat(){let t,e={};if(this.strInputEpsgInput!==this.currentEpsg&&(e={dataProjection:this.strInputEpsgInput,featureProjection:this.currentEpsg}),null!==this.strInputDataValues)if("GeoJSON"===this.importDataType?t=function Zn(a,n){let e={};return e=function Gn(a){return a.reduce((n,e)=>{let t=e.getGeometry().getType();return n[t]||(n[t]=[]),n[t].push(e),n},{})}(new te.Z({features:(new tt).readFeatures(JSON.parse(a,n))}).getFeatures()),e}(this.strInputDataValues,e):"WKT(s)"===this.importDataType&&(t=function An(a,n){let e={};return a.forEach(t=>{let i;try{i=(new xt).readFeature(t,n)}catch(o){alert(o.message)}if(void 0!==i){const o=i.getGeometry(),s=o.getType();s in e||(e[s]=[]),void 0!==o&&e[s].push(i)}}),e}(this.strInputDataValues.split("\n"),e)),"new"===this.modeImportInput)Object.keys(t).forEach(i=>{let o=t[i];"Point"===i&&this.addLayerFromFeatures(i,o),"LineString"===i&&this.addLayerFromFeatures(i,o),"Polygon"===i&&this.addLayerFromFeatures(i,o)});else{let i=this.getLayerFromId(this.modeImportInput);Object.keys(t).forEach(o=>{o===i.geomType&&(i.addFeaturesAndUpdateIds(t[o]),this.refreshLayers())})}this.strInputDataValues=null,this.strInputEpsgInput=null,this.modeImportInput="new"}zoomLayers(){let e=(0,T.lJ)();this.existingLayers.forEach(t=>{(0,T.l7)(e,t.sourceFeatures.getExtent())}),e[0]!==1/0&&e[1]!==1/0&&e[2]!==1/0&&e[3]!==1/0&&this.map.getView().fit(e,{size:this.map.getSize(),padding:this.zoomPadding})}visibleLayers(e){this.forceVisibleStatus=e}lockLayers(e){this.layersLockStatus=e}removeLayers(){this.interactionsService.removeAllLayers()}}return a.\u0275fac=function(e){return new(e||a)(r.Y36(Fe.S),r.Y36(ae))},a.\u0275cmp=r.Xpm({type:a,selectors:[["app-layer-manager"]],viewQuery:function(e,t){if(1&e&&(r.Gf(Pn,5),r.Gf(Fn,5)),2&e){let i;r.iGM(i=r.CRH())&&(t.exportStringGeomDiv=i.first),r.iGM(i=r.CRH())&&(t.layersListDiv=i.first)}},inputs:{map:"map",currentEpsg:"currentEpsg",epsgAvailable:"epsgAvailable"},features:[r.TTD],decls:58,vars:21,consts:[[1,"d-flex","flex-row","align-items-center","justify-content-center","bg-dark","bg-gradient","text-white","py-2","px-3"],[1,"fw-bold"],["id","creationTools",1,"d-flex","flex-column"],[1,"d-flex","flex-row","justify-content-center","my-2","mx-3"],[4,"ngFor","ngForOf"],["id","layersTools",1,"d-flex","flex-row","justify-content-evenly","align-items-center","mx-2"],["type","checkbox","id","btnVisibleLayers",1,"btn-check",3,"checked","click"],["btnVisible",""],["for","btnVisibleLayers","container","body","triggers","mouseenter:mouseleave",1,"p-1","bg-transparent","border-0","pointer",3,"ngClass","ngbPopover"],["size","1x",1,"",3,"icon"],["ngbPopover","Centrer","triggers","mouseenter:mouseleave",1,"p-1","bg-transparent","border-0",3,"click"],["type","checkbox","id","btnLockLayers",1,"btn-check",3,"checked","change"],["btnLock",""],["for","btnLockLayers","container","body","triggers","mouseenter:mouseleave",1,"p-1","bg-transparent","border-0","pointer",3,"ngbPopover"],["ngbPopover","Supprimer toutes les couches","triggers","mouseenter:mouseleave",1,"p-1","bg-transparent","border-0","text-danger",3,"click"],["id","layersContainer",1,"d-flex","flex-column","mx-2","overflow-auto"],["id","layersList",1,"d-flex","flex-column","justify-content-start","mb-2"],["layersListDi",""],[1,"layer","pointer","d-flex","flex-column","small","mt-1","mx-1","px-1","align-items-around",3,"ngClass","click"],[1,"pointer","p-2","d-flex","flex-row","pointer","justify-content-start","align-items-center","border","rounded"],[1,"me-1",3,"icon"],["id","modalDataImport","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-lg","modal-dialog-scrollable"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[1,"modal-body"],[1,"form-control",3,"ngModel","ngModelChange"],[1,"form-select","form-select-sm",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["value","new"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"ngClass","click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["placement","bottom","triggers","mouseenter:mouseleave",1,"badge","bg-dark","border-0","me-1","text-warning",3,"ngbPopover","click"],[1,"",3,"icon"],["data-bs-toggle","modal","data-bs-target","#modalDataImport","type","button","role","tab","placement","bottom","triggers","mouseenter:mouseleave",1,"badge","bg-dark","border-0","me-1","text-warning",3,"ngbPopover","click"],[1,"mx-1",3,"icon"],[3,"layer","isSelected","isVisible","isLocked","layerMoveUp","layerMoveDown","layerCloned","removeLayerId"],[3,"value"]],template:function(e,t){if(1&e){const i=r.EpF();r.TgZ(0,"div",0)(1,"span",1),r._uU(2,"Cr\xe9er des couches"),r.qZA()(),r.TgZ(3,"div",2)(4,"div",3),r.YNc(5,En,3,2,"ng-container",4),r.qZA()(),r.TgZ(6,"div",0)(7,"span",1),r._uU(8,"Importer des donn\xe9es"),r.qZA()(),r.TgZ(9,"div",2)(10,"div",3),r.YNc(11,Sn,4,3,"ng-container",4),r.qZA()(),r.TgZ(12,"div",0)(13,"span",1),r._uU(14,"Couches"),r.qZA()(),r.TgZ(15,"div",5)(16,"input",6,7),r.NdJ("click",function(){r.CHM(i);const s=r.MAs(17);return t.visibleLayers(s.checked)}),r.qZA(),r.TgZ(18,"label",8),r._UZ(19,"fa-icon",9),r.qZA(),r.TgZ(20,"button",10),r.NdJ("click",function(){return t.zoomLayers()}),r._UZ(21,"fa-icon",9),r.qZA(),r.TgZ(22,"input",11,12),r.NdJ("change",function(){r.CHM(i);const s=r.MAs(23);return t.lockLayers(s.checked)}),r.qZA(),r.TgZ(24,"label",13),r._UZ(25,"fa-icon",9),r.qZA(),r.TgZ(26,"button",14),r.NdJ("click",function(){return t.removeLayers()}),r._UZ(27,"fa-icon",9),r.qZA()(),r.TgZ(28,"div",15)(29,"div",16,17)(31,"div",18),r.NdJ("click",function(){return t.unSelectLayer()}),r.TgZ(32,"div",19),r._UZ(33,"fa-icon",20),r.TgZ(34,"span"),r._uU(35,"D\xe9s\xe9lectionner"),r.qZA()()(),r.YNc(36,In,2,4,"ng-container",4),r.qZA()(),r.TgZ(37,"div",21)(38,"div",22)(39,"div",23)(40,"div",24)(41,"h5",25),r._uU(42),r.qZA()(),r.TgZ(43,"div",26)(44,"textarea",27),r.NdJ("ngModelChange",function(s){return t.strInputDataValues=s}),r.qZA(),r._uU(45," EPSG des donn\xe9es \xe0 importer "),r.TgZ(46,"select",28),r.NdJ("ngModelChange",function(s){return t.strInputEpsgInput=s}),r.YNc(47,Mn,2,2,"option",29),r.qZA(),r._uU(48," Type d'importation "),r.TgZ(49,"select",28),r.NdJ("ngModelChange",function(s){return t.modeImportInput=s}),r.TgZ(50,"option",30),r._uU(51,"Cr\xe9er de nouvelles couches"),r.qZA(),r.YNc(52,kn,2,2,"option",29),r.qZA()(),r.TgZ(53,"div",31)(54,"button",32),r.NdJ("click",function(){return t.importFromFormat()}),r._uU(55,"Ajouter"),r.qZA(),r.TgZ(56,"button",33),r._uU(57,"Fermer"),r.qZA()()()()()}if(2&e){const i=r.MAs(17),o=r.MAs(23);r.xp6(5),r.Q6J("ngForOf",t.createModesSupported),r.xp6(6),r.Q6J("ngForOf",t.createFromModesSupported),r.xp6(5),r.Q6J("checked",!0),r.xp6(2),r.Q6J("ngClass",i.checked?"text-success":"text-danger")("ngbPopover",i.checked?"Masquer":"Afficher"),r.xp6(1),r.Q6J("icon",i.checked?t.visibleIcon:t.invisibleIcon),r.xp6(2),r.Q6J("icon",t.centerIcon),r.xp6(1),r.Q6J("checked",!1),r.xp6(2),r.Q6J("ngbPopover",o.checked?"D\xe9v\xe9rouiller":"Verrouiller"),r.xp6(1),r.Q6J("icon",o.checked?t.lockIcon:t.unLockIcon),r.xp6(2),r.Q6J("icon",t.disabledIcon),r.xp6(4),r.Q6J("ngClass","none"===t.currentLayerIdSelected?"bg-secondary  bg-gradient bg-opacity-25 fw-bold text-black":"text-black"),r.xp6(2),r.Q6J("icon",t.disabledIcon),r.xp6(3),r.Q6J("ngForOf",t.allLayers),r.xp6(6),r.hij("Importer ",t.importDataType,""),r.xp6(2),r.Q6J("ngModel",t.strInputDataValues),r.xp6(2),r.Q6J("ngModel",t.strInputEpsgInput),r.xp6(1),r.Q6J("ngForOf",t.epsgAvailable),r.xp6(2),r.Q6J("ngModel",t.modeImportInput),r.xp6(3),r.Q6J("ngForOf",t.existingLayers),r.xp6(2),r.Q6J("ngClass",null!==t.strInputEpsgInput&&null!==t.strInputDataValues?"":"pe-none")}},directives:[M.sg,ne.o8,q.BN,M.mk,Ln,U.Fj,U.JJ,U.On,U.EJ,U.YN,U.Kr],styles:[".faded[_ngcontent-%COMP%]{opacity:1!important;transition:opacity .5s!important}[_ngcontent-%COMP%]::-webkit-scrollbar{width:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 5px gray;border-radius:25px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:black;border-radius:25px}.pointer[_ngcontent-%COMP%]{cursor:pointer}.modal-backdrop[_ngcontent-%COMP%]{z-index:1040!important}.modal-content[_ngcontent-%COMP%]{margin:2px auto;z-index:1100!important}"]}),a})();function Nn(a,n){if(1&a){const e=r.EpF();r.ynx(0),r.TgZ(1,"input",9,16),r.NdJ("click",function(){r.CHM(e);const i=r.MAs(2);return r.oxw(2).drawHoleHandler(i.checked,!0)}),r.qZA(),r.TgZ(3,"label",17),r._UZ(4,"fa-icon",12),r.qZA(),r.BQk()}if(2&a){const e=r.oxw(2);r.xp6(1),r.Q6J("id","btnHole"+e.layer.id)("checked",e.isHole),r.xp6(2),r.Q6J("for","btnHole"+e.layer.id)("ngClass",e.isHole?"text-danger":"text-success"),r.xp6(1),r.Q6J("icon",e.polygonIcon)}}function Rn(a,n){if(1&a){const e=r.EpF();r.ynx(0),r.TgZ(1,"input",9,18),r.NdJ("click",function(){r.CHM(e);const i=r.MAs(2);return r.oxw(2).translateHandler(i.checked)}),r.qZA(),r.TgZ(3,"label",19),r._UZ(4,"fa-icon",12),r.qZA(),r.BQk()}if(2&a){const e=r.oxw(2);r.xp6(1),r.Q6J("id","btnMove"+e.layer.id)("checked",e.isMoved),r.xp6(2),r.Q6J("for","btnMove"+e.layer.id)("ngClass",e.isMoved?"text-danger":"text-success"),r.xp6(1),r.Q6J("icon",e.moveIcon)}}function Dn(a,n){if(1&a){const e=r.EpF();r.TgZ(0,"div",5)(1,"div",6)(2,"span",7),r._uU(3,"Ajouter"),r.qZA(),r.TgZ(4,"div",8)(5,"input",9,10),r.NdJ("click",function(){r.CHM(e);const i=r.MAs(6);return r.oxw().drawHandler(i.checked)}),r.qZA(),r.TgZ(7,"label",11),r._UZ(8,"fa-icon",12),r.qZA()()(),r.TgZ(9,"div",6)(10,"span",7),r._uU(11,"Editer"),r.qZA(),r.TgZ(12,"div",8)(13,"input",9,13),r.NdJ("click",function(){r.CHM(e);const i=r.MAs(14);return r.oxw().editHandler(i.checked)}),r.qZA(),r.TgZ(15,"label",14),r._UZ(16,"fa-icon",12),r.qZA(),r.YNc(17,Nn,5,5,"ng-container",15),r.YNc(18,Rn,5,5,"ng-container",15),r.qZA()()()}if(2&a){const e=r.oxw();r.xp6(5),r.Q6J("id","btnDraw"+e.layer.id)("checked",e.isDrawn),r.xp6(2),r.Q6J("for","btnDraw"+e.layer.id)("ngClass",e.isDrawn?"text-danger":"text-success")("ngbPopover","Ajouter un objet de type '"+e.layer.geomType+"'"),r.xp6(1),r.Q6J("icon",e.addIcon),r.xp6(5),r.Q6J("id","btnEdit"+e.layer.id)("checked",e.isEdited),r.xp6(2),r.Q6J("for","btnEdit"+e.layer.id)("ngClass",e.isEdited?"text-danger":"text-success"),r.xp6(1),r.Q6J("icon",e.editIcon),r.xp6(1),r.Q6J("ngIf","Polygon"===e.layer.geomType),r.xp6(1),r.Q6J("ngIf","Point"!==e.layer.geomType)}}let Jn=(()=>{class a{constructor(e,t){this.interactionsService=e,this.cdRef=t,this.addIcon=v.EQ8,this.editIcon=v.TzT,this.paramIcon=v.gr5,this.lockIcon=v.byT,this.unLockIcon=v._1N,this.polygonIcon=v.ubJ,this.moveIcon=v.$pG,this.isDrawn=!1,this.isEdited=!1,this.isHole=!1,this.isMoved=!1,this.epsgAvailable=["EPSG:4326","EPSG:3857"],this.strInputDataValues=null,this.strInputEspgInput=null,this.layerLockStatusSubscription=this.interactionsService.editBarActivation.subscribe(i=>{i?this.isEditBarEnabled=!0:(this.isEditBarEnabled=!1,this.disableEditing()),this.cdRef.detectChanges()})}ngOnInit(){this.isEditBarEnabled=!this.layer.locked}ngOnDestroy(){this.disableEditing(),this.layerLockStatusSubscription.unsubscribe()}ngOnChanges(e){}enablingSelectOnlyOnTheCurrentLayer(){this.interactionsService.setSelectableLayer(this.layer.id)}enableSelectingOnAllLayers(){this.interactionsService.setSelectableAllLayers()}disableEditing(e=!0){this.drawHoleHandler(!1),this.drawHandler(!1),this.editHandler(!1),this.translateHandler(!1),e&&this.unSelectFeature()}unSelectFeature(){this.layer.select.getFeatures().clear()}removeFeature(){}translateHandler(e){e?(this.disableEditing(!1),this.translateFeatureEnable()):this.translateFeatureDisable()}editHandler(e){e?(this.disableEditing(!1),this.editFeatureEnable()):this.editFeatureDisable()}drawHandler(e,t=!1){e?(this.disableEditing(!1),this.enablingSelectOnlyOnTheCurrentLayer(),this.addFeatureEnable(t)):(this.addFeatureDisable(),this.enableSelectingOnAllLayers())}drawHoleHandler(e,t=!0){e?(this.disableEditing(!1),this.enablingSelectOnlyOnTheCurrentLayer(),this.addHoleFeatureEnable(t)):(this.addHoleFeatureDisable(),this.enableSelectingOnAllLayers())}translateFeatureEnable(){this.layer.enableTranslating(),this.isMoved=!0}translateFeatureDisable(){this.layer.disableTranslating(),this.isMoved=!1}addFeatureEnable(e=!1){this.layer.enableDrawing(e),this.isDrawn=!0}addFeatureDisable(){this.layer.disableDrawing(),this.isDrawn=!1}editFeatureEnable(){this.layer.enableEditing(),this.isEdited=!0}editFeatureDisable(){this.layer.disableEditing(),this.isEdited=!1}addHoleFeatureEnable(e=!0){this.layer.enableDrawing(e),this.isHole=!0}addHoleFeatureDisable(){this.layer.disableDrawing(),this.isHole=!1}}return a.\u0275fac=function(e){return new(e||a)(r.Y36(ae),r.Y36(r.sBO))},a.\u0275cmp=r.Xpm({type:a,selectors:[["app-edit-bar"]],inputs:{layer:"layer",currentEpsg:"currentEpsg"},features:[r.TTD],decls:7,vars:3,consts:[[1,"d-flex","flex-column","mx-4","editTools","bg-dark","bg-gradient","p-2","m-1","rounded-3","shadow"],[1,"d-flex","flex-row","justify-content-around","text-warning","m-2"],[1,"fw-bold","me-1"],[1,"fst-italic"],["class","d-flex flex-row",4,"ngIf"],[1,"d-flex","flex-row"],[1,"d-flex","flex-row","mx-2","align-items-center","shadow","border","rounded","bg-light"],[1,"text-dark","mx-2","fw-bold","small"],[1,"d-flex","flex-row","border-start","rounded-end","p-1"],["type","checkbox",1,"btn-check",3,"id","checked","click"],["btnDraw",""],["triggers","mouseenter:mouseleave",1,"edit-button","btn","px-1","py-0","border","m-1",3,"for","ngClass","ngbPopover"],["size","1x",1,"",3,"icon"],["btnEdit",""],["ngbPopover","Editer","triggers","mouseenter:mouseleave",1,"edit-button","btn","px-1","py-0","border","border","m-1",3,"for","ngClass"],[4,"ngIf"],["btnHole",""],["ngbPopover","Ajouter un trou","triggers","mouseenter:mouseleave",1,"edit-button","btn","px-1","py-0","border","m-1",3,"for","ngClass"],["btnMove",""],["ngbPopover","D\xe9placer","triggers","mouseenter:mouseleave",1,"edit-button","btn","px-1","py-0","border","m-1",3,"for","ngClass"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0)(1,"div",1)(2,"span",2),r._uU(3),r.qZA(),r.TgZ(4,"span",3),r._uU(5),r.qZA()(),r.YNc(6,Dn,19,13,"div",4),r.qZA()),2&e&&(r.xp6(3),r.Oqu(t.layer.layerName),r.xp6(2),r.hij("(",t.layer.geomType,")"),r.xp6(1),r.Q6J("ngIf",t.isEditBarEnabled))},directives:[M.O5,M.mk,ne.o8,q.BN],styles:[".edit-button[_ngcontent-%COMP%]{background-color:rgba(var(--bs-light-rgb))}"]}),a})();function jn(a,n){if(1&a&&r._UZ(0,"app-edit-bar",12),2&a){const e=r.oxw();r.Q6J("layer",e.currentLayerSelected)("currentEpsg",e.currentEpsg)}}const Un=[{path:"",component:(()=>{class a{constructor(e,t,i,o,s,l){this.mapService=e,this.controlerService=t,this.activatedRoute=i,this.titleService=o,this.interactionsService=s,this.cdRef=l,this.epsgAvailable=["EPSG:4326","EPSG:3857"],this.geoIcon=v.g4A,this.leftSideIcon=v._Wx,this.rightSideIcon=v.ccb,this.layersIcon=v.Krp,this.isLegendDisplayed=!0,this.currentMenuDisplayed="createTools",this.mapSubscription=this.mapService.map.subscribe(u=>{this.map=u,this.currentEpsg=this.map.getView().getProjection().getCode(),this.defaultMapView=this.map.getView()}),this.layerObjectSelectedSubscription=this.interactionsService.layerObjectSelected.subscribe(u=>{u!==this.currentLayerSelected?(this.editBarEnabled=!1,this.cdRef.detectChanges(),this.editBarEnabled=!0):null===u&&(this.editBarEnabled=!1),this.currentLayerSelected=u})}ngOnInit(){this.sendResumeSubMenus(),this.mapService.changeMapInteractionStatus(!0),this.mapService.getMap()}ngOnDestroy(){this.map.setView(this.defaultMapView),this.mapSubscription.unsubscribe(),this.layerObjectSelectedSubscription.unsubscribe(),this.mapService.changeMapInteractionStatus(!1),this.mapService.resetMapView()}sendResumeSubMenus(){this.controlerService.pullSubMenus([]),this.controlerService.pullTitlePage(this.activatedRoute.snapshot.data.title),this.titleService.setTitle(this.activatedRoute.snapshot.data.title)}showHideLegend(){this.isLegendDisplayed=!this.isLegendDisplayed}}return a.\u0275fac=function(e){return new(e||a)(r.Y36(Fe.S),r.Y36(Ft.L),r.Y36(Pe.gz),r.Y36(Et.Dx),r.Y36(ae),r.Y36(r.sBO))},a.\u0275cmp=r.Xpm({type:a,selectors:[["app-layout"]],decls:14,vars:16,consts:[[1,"container-fluid","g-0"],["id","sandbox",1,"d-flex","flex-row","position-fixed"],["id","mapTools",1,"d-flex","flex-column","bg-light","shadow-map-tools","position-relative",3,"ngClass"],["id","geoTools",1,"d-flex","flex-column","overflow-auto",3,"ngClass","map","currentEpsg","epsgAvailable"],["id","createTools",1,"d-flex","flex-column","overflow-auto",3,"ngClass","map","currentEpsg","epsgAvailable"],["id","legendLabels",1,"d-flex","flex-column"],[1,"tool","btn","btn-warning","text-black","my-3","shadow","rounded-end",3,"ngClass","click"],[1,"",3,"icon"],[1,"tool","btn","btn-info","text-white","mb-1","shadow","rounded-end",3,"ngClass","click"],["type","button",1,"tool","btn","btn-dark","text-white","mb-1","shadow","rounded-end",3,"ngClass","click"],[1,"d-flex","flex-row","justify-content-center"],["id","editBar","class","d-flex flex-row align-items-center justify-content-center m-2",3,"layer","currentEpsg",4,"ngIf"],["id","editBar",1,"d-flex","flex-row","align-items-center","justify-content-center","m-2",3,"layer","currentEpsg"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0)(1,"div",1)(2,"div",2),r._UZ(3,"app-geoinfo",3)(4,"app-layer-manager",4),r.qZA(),r.TgZ(5,"div",5)(6,"span",6),r.NdJ("click",function(){return t.showHideLegend()}),r._UZ(7,"fa-icon",7),r.qZA(),r.TgZ(8,"span",8),r.NdJ("click",function(){return t.currentMenuDisplayed="geoTools"}),r._UZ(9,"fa-icon",7),r.qZA(),r.TgZ(10,"span",9),r.NdJ("click",function(){return t.currentMenuDisplayed="createTools"}),r._UZ(11,"fa-icon",7),r.qZA()()()(),r.TgZ(12,"div",10),r.YNc(13,jn,1,2,"app-edit-bar",11),r.qZA()),2&e&&(r.xp6(2),r.Q6J("ngClass",t.isLegendDisplayed?"displayed":"hidden"),r.xp6(1),r.Q6J("ngClass","geoTools"==t.currentMenuDisplayed?"d-block":"d-none")("map",t.map)("currentEpsg",t.currentEpsg)("epsgAvailable",t.epsgAvailable),r.xp6(1),r.Q6J("ngClass","createTools"==t.currentMenuDisplayed?"d-block":"d-none")("map",t.map)("currentEpsg",t.currentEpsg)("epsgAvailable",t.epsgAvailable),r.xp6(2),r.Q6J("ngClass",t.isLegendDisplayed?"selected":""),r.xp6(1),r.Q6J("icon",t.isLegendDisplayed?t.leftSideIcon:t.rightSideIcon),r.xp6(1),r.Q6J("ngClass","geoTools"===t.currentMenuDisplayed?"selected":""),r.xp6(1),r.Q6J("icon",t.geoIcon),r.xp6(1),r.Q6J("ngClass","createTools"===t.currentMenuDisplayed?"selected":""),r.xp6(1),r.Q6J("icon",t.layersIcon),r.xp6(2),r.Q6J("ngIf",t.editBarEnabled&&null!==t.currentLayerSelected))},directives:[M.mk,Zt,On,q.BN,M.O5,Jn],styles:[".button-title[_ngcontent-%COMP%]{border-radius:unset;z-index:1}.button-title[_ngcontent-%COMP%]   .vertical-text[_ngcontent-%COMP%]{writing-mode:vertical-rl;text-orientation:upright;letter-spacing:-5px}.button-title[_ngcontent-%COMP%]   .horizontal-text[_ngcontent-%COMP%]{writing-mode:horizontal-tb;letter-spacing:0px}.hidden[_ngcontent-%COMP%]   .d-flex[_ngcontent-%COMP%]{visibility:hidden!important;opacity:0;transition:all .3s}#sandbox[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}#mapTools.displayed[_ngcontent-%COMP%]{opacity:1;width:18vw;transition:all .3s}#mapTools.hidden[_ngcontent-%COMP%]{width:1vw;transition:all .3s}.shadow-map-tools[_ngcontent-%COMP%]{box-shadow:1em 0 1rem #00000026!important}#mapTools[_ngcontent-%COMP%]{height:calc(100vh - 56px)}@media (max-width: 960px){#mapTools.hidden[_ngcontent-%COMP%]{width:3vw}#mapTools.displayed[_ngcontent-%COMP%]{width:75vw}}.tool.btn[_ngcontent-%COMP%]{width:45px;border-radius:unset;transition:width 1s ease-in-out}.tool.btn[_ngcontent-%COMP%]:hover, .tool.btn.selected[_ngcontent-%COMP%]{width:60px;transition:width 1s ease-in-out}#editBar[_ngcontent-%COMP%]{position:fixed;bottom:0;-webkit-user-select:none;user-select:none}"]}),a})(),data:{title:"Bac \xe0 sable",page:"map-sandbox"},outlet:"map-sandbox"}];let Bn=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=r.oAB({type:a}),a.\u0275inj=r.cJS({imports:[[Pe.Bz.forChild(Un)],Pe.Bz]}),a})(),Vn=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=r.oAB({type:a}),a.\u0275inj=r.cJS({imports:[[M.ez,Bn,q.uH,ne.IJ,U.u5]]}),a})()}}]);
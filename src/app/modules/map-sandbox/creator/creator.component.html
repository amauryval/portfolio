<div class="d-flex flex-row align-items-center justify-content-center bg-warning text-black py-2 px-3">
  <span class="fw-bold">Créer des couches</span>
</div>

<div id="creationTools" class="d-flex flex-column">

  <div class="d-flex flex-row justify-content-center my-2 mx-3">

    <ng-container *ngFor="let feature of createModesSupported">
      <button class="badge btn-dark border-0 me-1 text-warning" (click)="addLayer(feature.mode)" [ngbPopover]="feature.label" placement="bottom"triggers="mouseenter:mouseleave">
        <fa-icon class="" [icon]="feature.icon"></fa-icon>
      </button>
    </ng-container>
  </div>

</div>

<div class="d-flex flex-row align-items-center justify-content-center bg-warning text-black py-2 px-3">
  <span class="fw-bold">Couches</span>
</div>

<div id="layersContainer" class="d-flex flex-column mx-2 overflow-auto">

  <div #layersListDiv id="layersList" class="d-flex flex-column justify-content-start mb-2">

    <div
      class="layer pointer d-flex flex-row small mt-1 mx-1 px-1 border rounded align-items-center"
      (click)="unSelectLayer()"
      [ngClass]="layerIdSelected === 'none' ? 'bg-secondary  bg-gradient bg-opacity-25 fw-bold text-black' :  'text-black'"
      >

      <div class="pointer p-2 d-flex flex-row pointer justify-content-around align-items-center">
          <fa-icon class="me-1" [icon]="disabledIcon" ></fa-icon>
          <span>Désélectionner</span>
      </div>

    </div>

    <ng-container *ngFor="let layer of existingLayers.reverse()">

        <app-layer
          [layer]="layer"
          [currentLayerIdSelected]="layerIdSelected"
          (layerSelectedId)="getSelectedLayerId($event)"
          (layerMoveUp)="layerGoUp($event)"
          (layerMoveDown)="layerGoDown($event)"
        >
        </app-layer>

    </ng-container>
  </div>

</div>




<div *ngIf="layerForModal" id="modalLayer" class="modal fade" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">{{ layerForModal.layerName}}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

        <div class="d-flex flex-column my-3">
          <h4 class="">Général</h4>
          <div class="d-flex flex-row ms-2">
            <span class="me-2">Nom de la couche :</span>
            <input type="text" class="form-control" [placeholder]="layerForModal.layerName" aria-label="layerName" (change)="layerForModal.setName($event)">
          </div>
        </div>

        <div class="d-flex flex-column my-3">
          <h4 class="">Style</h4>
          <div class="d-flex flex-row ms-2 my-1">
            <span class="me-2">Opacité :</span>
            <input class="small opacity-setter" id="" type="range" min="0" max="1" step="0.1" [value]="layerForModal.getOpacity()" (change)="layerForModal.setOpacity($event)"/>
          </div>

          <div class="d-flex flex-row ms-2 my-1">
            <span class="me-2">Couleur de fond :</span>
            <input class="form-control fillColor colorPicker" [(colorPicker)]="layerForModal.fillColor" [style.background]="layerForModal.fillColor" (colorPickerClose)="layerForModal.setStyleForAllFeatures($event, 'fill_color')"/>
          </div>

          <div class="d-flex flex-row ms-2 my-1">
            <span class="me-2">Couleur du contour :</span>
            <input class="form-control strokeColor colorPicker" [(colorPicker)]="layerForModal.strokeColor" [style.background]="layerForModal.strokeColor" (colorPickerClose)="layerForModal.setStyleForAllFeatures($event, 'stroke_color')"/>
          </div>

          <div class="d-flex flex-row ms-2 my-1">
            <span class="me-2">Epaisseur du contour :</span>
            <input class="small strokeWidth" type="number" min="0" max="12" [value]="layerForModal.strokeWidth" (change)="layerForModal.setStyleForAllFeatures($event, 'stroke_width')"/>
          </div>

        </div>

        <div class="d-flex flex-column my-3">
          <h4 class="">Export</h4>
          <div class="d-flex flex-column my-1">
            <span class="ms-2">GeoJSON:</span>
            <textarea #exportStringGeomDiv class="form-control vh-100" aria-label="With textarea" (click)="exportStringGeomDiv.select()" readonly>{{layerForModal.exportToGeoJSON()}}</textarea>
          </div>

        </div>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
      </div>
    </div>
  </div>
</div>

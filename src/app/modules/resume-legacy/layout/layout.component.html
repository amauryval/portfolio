<div #content class="content">


  <div class="d-flex flex-row align-items-center justify-content-center my-3">
    <button type="button" class="btn btn-lg btn-warning fw-bold" type="button" (click)="printDiv('legacy_resume')">Imprimer/export en pdf</button>
  </div>


  <div #legacyResume id="legacy_resume" class="d-flex flex-column justify-content-center my-2">

    <section class="page bg-white px-3 pt-4 pb-5 my-2 mx-auto d-flex flex-column" size="A4" layout="" *ngIf="dataAvailable">

      <div id="header" class="d-flex flex-row align-items-center justify-content-between mx-3">

        <div class="">
          <h4 class="fw-bold">{{ profilData.first_name }} {{ profilData.last_name }}</h4>
          <h5 class="">{{ profilData.job }}</h5>
          <h6 class="">{{ profilData.experience_duration }}</h6>
        </div>

        <div class="my-auto">
          <ul class="list-unstyled">
            <ng-container *ngIf="contactData.mail">
              <ng-container *ngTemplateOutlet="contactListElement; context: {icon: emailIcon, data: contactData.mail}"></ng-container>
            </ng-container>

            <ng-container *ngIf="contactData.phone">
              <ng-container *ngTemplateOutlet="contactListElement; context: {icon: phoneIcon, data: contactData.phone}"></ng-container>
            </ng-container>

            <ng-container *ngIf="contactData.website">
              <ng-container *ngTemplateOutlet="contactListElement; context: {icon: websiteIcon, data: contactData.website}"></ng-container>
            </ng-container>

            <ng-container *ngIf="contactData.github">
              <ng-container *ngTemplateOutlet="contactListElement; context: {icon: githubIcon, data: contactData.github}"></ng-container>
            </ng-container>
          </ul>
        </div>

      </div>

      <div id="resume_summary" class="d-flex flex-row">
        <set-paragraph-content class="text-justify small">{{ summaryData }} </set-paragraph-content>
      </div>


      <div id="degrees" class="d-flex flex-column mx-4 pt-3">
        <h5 class="">Diplômes</h5>

        <div class="d-flex flex-column">
          <set-paragraph-content class="" *ngFor="let degree of degreesData">
            <div class="fw-bold">{{ degree.start_date | date: 'yyyy' }}-{{ degree.end_date | date: 'yyyy' }} - {{ degree.degree }}</div>
            <div class="fw-light ms-3 small">{{ degree.school }} à {{ degree.location }}</div>
          </set-paragraph-content>
        </div>

      </div>

      <div class="d-flex flex-row mx-4 pt-3">

        <div id="degrees" class="d-flex flex-column">
          <h6 class="">Formations</h6>
          <set-paragraph-content class="" *ngFor="let training of trainingsData">
            <div class="fw-bold">{{ training.year }} - {{ training.name }}</div>
            <div class="fw-light ms-3"> par {{ training.trainer }}</div>
          </set-paragraph-content>
        </div>

        <div id="languages" class="d-flex flex-column">
          <h6 class="">Langues</h6>

          <div class="d-flex flex-column mx-4">
            <set-paragraph-content *ngFor="let language of languagesData">
              <span class="fw-bold">{{language.language}} : </span> {{language.level}}
            </set-paragraph-content>
          </div>
        </div>

      </div>

      <div id="publication" class="d-flex flex-column mx-4 pt-3">
        <h6 class="">Recherches et publications</h6>

        <div class="d-flex flex-column">
          <set-paragraph-content class="small" *ngFor="let publication of publicationsData">
            <div class="fw-bold">{{ publication.year }} - {{ publication.editor }}</div>
            <div class="fw-light ms-3 text-justify">
              {{publication.publication}}
            </div>
          </set-paragraph-content>

        </div>
      </div>

      <div class="mt-auto d-flex flex-row justify-content-center">
        <span class="small">Page 1</span>
      </div>

    </section>

    <br clear="all" style="page-break-before:always" />

    <section class="page bg-white px-3 pt-4 pb-5 my-2 mx-auto d-flex flex-column" size="A4" layout="" *ngIf="dataAvailable">

      <div id="jobs" class="d-flex flex-column mx-4">

        <h5 class="">Expériences</h5>

        <div class="d-flex flex-column mb3" *ngFor="let job of jobsData ;let last = last;">

          <div class="d-flex flex-row justify-content-between" [ngClass]="job.status === 'InProgress' ? 'text-danger': 'text-dark'">
            <div class="fw-bold small w-75">{{job.title}} @ {{job.company}}</div>
            <div class="small">{{job.location}}</div>
          </div>

          <div *ngIf="job.status === 'InProgress'; then currentJob else pastJob"></div>
          <ng-template #pastJob>
            <div class="small">Du {{ job.start_date | date: 'MM-yyyy' }} au {{ job.end_date | date: 'MM-yyyy' }}  - {{job.contract}} ({{job.duration}})</div>
          </ng-template>
          <ng-template #currentJob>
            <div class="small"> Du {{ job.start_date | date: 'MM-yyyy' }} à aujourd'hui - {{job.contract}} ({{job.duration}})</div>
          </ng-template>

          <div class="d-flex flex-row align-items-center mx-1">

            <div class="col-2 text-center">
              <img class="img-fluid " [src]="apiImgUrl + job.img_company"/>
            </div>
            <div class="col-10">
              <set-paragraph-content class="small">{{ job.presentation }}</set-paragraph-content>
            </div>

          </div>

          <div *ngIf="!last" class="d-flex flex-row justify-content-center">
            <hr class="w-25 m-2 border-2 border-top border-dark">
          </div>


        </div>

      </div>

      <div class="mt-auto d-flex flex-row justify-content-center">
        <span class="small">Page 2</span>
      </div>

    </section>

    <br clear="all" style="page-break-before:always" />

    <section class="page bg-white px-3 pt-4 pb-5 my-2 mx-auto d-flex flex-column" size="A4" layout="" *ngIf="dataAvailable">

      <div id="projects" class="d-flex flex-column mx-4">

        <div class="">
          <h5 class="">Projets personnels</h5>
        </div>


        <div class="d-flex flex-column mt-2 mx-4"  *ngFor="let project of personalProjectsData">
          <div class="d-flex flex-row justify-content-between">

            <h6 class="fw-bold">{{project.title}}</h6>

              <div *ngIf="project.url_github; then projectsShorcutGithub"></div>
              <ng-template #projectsShorcutGithub>
                <span><fa-icon class="me-2" [icon]="githubIcon"></fa-icon><a class="small text-dark" href="{{ project.url_github }}" target="_blank" rel="noopener noreferrer">{{ project.url_github }}</a></span>
              </ng-template>

              <div *ngIf="project.url_website; then projectsShorcutWebsite"></div>
              <ng-template #projectsShorcutWebsite>
                <span><fa-icon class="me-2" [icon]="websiteIcon"></fa-icon><a class="small text-dark" href="{{ project.url_website }}" target="_blank" rel="noopener noreferrer">{{ project.url_website }}</a></span>
              </ng-template>
          </div>

          <div class="d-flex flex-row">
            <div class="mx-4 text-justify small">{{project.presentation}}</div>
          </div>

        </div>
      </div>

      <div id="skills" class="d-flex flex-column mx-4 pt-3">

        <div class="">
          <h5 class="">Compétences</h5>
        </div>

        <ng-container *ngIf="skillsData">

          <div class="d-flex flex-row ms-3 mt-2 mx-4">
            <ng-container *ngIf="skillsData.themes">
              <ng-container *ngTemplateOutlet="skillsFeature; context: {data: skillsData.themes, title: 'Thématiques'}"></ng-container>
            </ng-container>

            <ng-container *ngIf="skillsData.technics">
              <ng-container *ngTemplateOutlet="skillsFeature; context: {data: skillsData.technics, title: 'Techniques'}"></ng-container>
            </ng-container>
          </div>

          <div class="d-flex flex-column ms-3">

            <ng-container *ngIf="skillsData.tools">
              <ng-container *ngTemplateOutlet="skillsFeature; context: {data: skillsData.tools, title: 'Outils'}"></ng-container>
            </ng-container>
          </div>

        </ng-container>
      </div>

      <div class="mt-auto d-flex flex-row justify-content-center">
        <span class="small">Page 3</span>
      </div>

    </section>

  </div>

</div>
<!-- TEMPLATES -->

<ng-template #contactListElement let-icon=icon let-data=data>
  <li class="d-flex justify-content-end">
    <a class="small" [href]="data" target="_blank" rel="noopener noreferrer" [innerHTML]="reverse(data)"></a>
    <fa-icon class="ms-2" [icon]="icon"></fa-icon>
  </li>
</ng-template>


<ng-template #skillsFeature let-data=data let-title=title>
  <div class="d-flex flex-column skills mb-2">
    <div class="">
      <h6 class="">{{title}}</h6>
    </div>
    <div class="mx-3 small" *ngFor="let feature of data">
      <span class="fw-bold">{{feature.name}}:</span>
      <span class="fw-regular ms-1">{{ feature.details | join }}.</span>
    </div>
  </div>

</ng-template>
